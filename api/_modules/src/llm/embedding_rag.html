

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.llm.embedding_rag &mdash; MIESC 5.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=2880b4b0" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=1bd908e2"></script>
      <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            MIESC
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#quick-install">Quick Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#development-install">Development Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#optional-dependencies">Optional Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#docker-installation">Docker Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#external-tools">External Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#verifying-installation">Verifying Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quickstart Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#output-formats">Output Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#python-api">Python API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#using-adapters-directly">Using Adapters Directly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#llm-enhanced-analysis">LLM-Enhanced Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#docker-usage">Docker Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/adapters.html">Adapters Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#module-src.core.tool_protocol">Base Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory"><code class="docutils literal notranslate"><span class="pre">ToolCategory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.STATIC_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.STATIC_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.DYNAMIC_TESTING"><code class="docutils literal notranslate"><span class="pre">ToolCategory.DYNAMIC_TESTING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.SYMBOLIC_EXECUTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.SYMBOLIC_EXECUTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.FORMAL_VERIFICATION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.FORMAL_VERIFICATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.AI_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.AI_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.ML_DETECTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.ML_DETECTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.SPECIALIZED"><code class="docutils literal notranslate"><span class="pre">ToolCategory.SPECIALIZED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.CROSSCHAIN_ZK"><code class="docutils literal notranslate"><span class="pre">ToolCategory.CROSSCHAIN_ZK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.ADVANCED_AI_ENSEMBLE"><code class="docutils literal notranslate"><span class="pre">ToolCategory.ADVANCED_AI_ENSEMBLE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.COMPLIANCE"><code class="docutils literal notranslate"><span class="pre">ToolCategory.COMPLIANCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.AUDIT_READINESS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.AUDIT_READINESS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.GAS_OPTIMIZATION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.GAS_OPTIMIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.MEV_DETECTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.MEV_DETECTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.PRIVACY_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.PRIVACY_ANALYSIS</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus"><code class="docutils literal notranslate"><span class="pre">ToolStatus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus.AVAILABLE"><code class="docutils literal notranslate"><span class="pre">ToolStatus.AVAILABLE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus.NOT_INSTALLED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.NOT_INSTALLED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus.CONFIGURATION_ERROR"><code class="docutils literal notranslate"><span class="pre">ToolStatus.CONFIGURATION_ERROR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus.LICENSE_REQUIRED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.LICENSE_REQUIRED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus.DEPRECATED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.DEPRECATED</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability"><code class="docutils literal notranslate"><span class="pre">ToolCapability</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability.name"><code class="docutils literal notranslate"><span class="pre">ToolCapability.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability.description"><code class="docutils literal notranslate"><span class="pre">ToolCapability.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability.supported_languages"><code class="docutils literal notranslate"><span class="pre">ToolCapability.supported_languages</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability.detection_types"><code class="docutils literal notranslate"><span class="pre">ToolCapability.detection_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability.__init__"><code class="docutils literal notranslate"><span class="pre">ToolCapability.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata"><code class="docutils literal notranslate"><span class="pre">ToolMetadata</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.name"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.version"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.category"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.author"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.license"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.license</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.homepage"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.homepage</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.repository"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.repository</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.documentation"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.documentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.installation_cmd"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.installation_cmd</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.capabilities"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.capabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.cost"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.cost</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.requires_api_key"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.requires_api_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.is_optional"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.is_optional</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.__init__"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter"><code class="docutils literal notranslate"><span class="pre">ToolAdapter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.get_metadata"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.is_available"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.is_available()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.analyze"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.normalize_findings"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.normalize_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.get_installation_instructions"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_installation_instructions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.can_analyze"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.can_analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.get_default_config"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.validate_config"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.validate_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.check_binary_available"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.check_binary_available()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.run_subprocess"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.run_subprocess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.parse_json_safely"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.parse_json_safely()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.normalize_severity"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.normalize_severity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.create_finding"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.create_finding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.create_result"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.create_result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.find_binary"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.find_binary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry"><code class="docutils literal notranslate"><span class="pre">ToolRegistry</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.__init__"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.register"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.get_tool"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tool()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.get_all_tools"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_all_tools()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.get_tools_by_category"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tools_by_category()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.get_available_tools"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_available_tools()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.get_tool_status_report"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tool_status_report()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.get_tool_registry"><code class="docutils literal notranslate"><span class="pre">get_tool_registry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#static-analysis-adapters">Static Analysis Adapters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.slither_adapter">Slither Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.slither_adapter.SlitherAdapter"><code class="docutils literal notranslate"><span class="pre">SlitherAdapter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.aderyn_adapter">Aderyn Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#aderyn-static-analyzer-adapter-2025-security-enhancement">Aderyn Static Analyzer Adapter - 2025 Security Enhancement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.aderyn_adapter.AderynAdapter"><code class="docutils literal notranslate"><span class="pre">AderynAdapter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.solhint_adapter">Solhint Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#solhint-linter-adapter-layer-2-dynamic-testing-linting">Solhint Linter Adapter - Layer 2: Dynamic Testing (Linting)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.solhint_adapter.SolhintAdapter"><code class="docutils literal notranslate"><span class="pre">SolhintAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.solhint_adapter.register_adapter"><code class="docutils literal notranslate"><span class="pre">register_adapter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.semgrep_adapter">Semgrep Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#semgrep-adapter-layer-1-static-analysis">Semgrep Adapter - Layer 1: Static Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.semgrep_adapter.SemgrepAdapter"><code class="docutils literal notranslate"><span class="pre">SemgrepAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.semgrep_adapter.register_adapter"><code class="docutils literal notranslate"><span class="pre">register_adapter()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#symbolic-execution-adapters">Symbolic Execution Adapters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.mythril_adapter">Mythril Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#mythril-symbolic-execution-adapter-miesc-phase-3">Mythril Symbolic Execution Adapter - MIESC Phase 3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.mythril_adapter.MythrilAdapter"><code class="docutils literal notranslate"><span class="pre">MythrilAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.mythril_adapter.validate_findings_with_mythril"><code class="docutils literal notranslate"><span class="pre">validate_findings_with_mythril()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#dynamic-testing-adapters">Dynamic Testing Adapters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.hardhat_adapter">Hardhat Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#hardhat-adapter-layer-2-dynamic-testing">Hardhat Adapter - Layer 2: Dynamic Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.hardhat_adapter.HardhatAdapter"><code class="docutils literal notranslate"><span class="pre">HardhatAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.hardhat_adapter.register_adapter"><code class="docutils literal notranslate"><span class="pre">register_adapter()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#defi-adapters">DeFi Adapters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.defi_adapter">DeFi Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.defi_adapter.DeFiAdapter"><code class="docutils literal notranslate"><span class="pre">DeFiAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.defi_adapter.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.advanced_detector_adapter">Advanced Detector Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.advanced_detector_adapter.AdvancedDetectorAdapter"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.advanced_detector_adapter.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#llm-adapters">LLM Adapters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.smartllm_adapter">SmartLLM Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.smartllm_adapter.SmartLLMAdapter"><code class="docutils literal notranslate"><span class="pre">SmartLLMAdapter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.gptlens_adapter">GPTLens Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#gptlens-adapter-dual-role-llm-vulnerability-detection-icse-2024">GPTLens Adapter - Dual-Role LLM Vulnerability Detection (ICSE 2024)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.gptlens_adapter.GPTLensAdapter"><code class="docutils literal notranslate"><span class="pre">GPTLensAdapter</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/agents.html">Agents Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#module-src.agents.base_agent">Base Agent</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent"><code class="docutils literal notranslate"><span class="pre">BaseAgent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.__init__"><code class="docutils literal notranslate"><span class="pre">BaseAgent.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.analyze"><code class="docutils literal notranslate"><span class="pre">BaseAgent.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.get_context_types"><code class="docutils literal notranslate"><span class="pre">BaseAgent.get_context_types()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.publish_findings"><code class="docutils literal notranslate"><span class="pre">BaseAgent.publish_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.subscribe_to"><code class="docutils literal notranslate"><span class="pre">BaseAgent.subscribe_to()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.get_latest_context"><code class="docutils literal notranslate"><span class="pre">BaseAgent.get_latest_context()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.aggregate_contexts"><code class="docutils literal notranslate"><span class="pre">BaseAgent.aggregate_contexts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.set_status"><code class="docutils literal notranslate"><span class="pre">BaseAgent.set_status()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.handle_error"><code class="docutils literal notranslate"><span class="pre">BaseAgent.handle_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.run"><code class="docutils literal notranslate"><span class="pre">BaseAgent.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.get_stats"><code class="docutils literal notranslate"><span class="pre">BaseAgent.get_stats()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#llm-agents">LLM Agents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#smartllm-agent">SmartLLM Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.smartllm_agent.SmartLLMAgent"><code class="docutils literal notranslate"><span class="pre">SmartLLMAgent</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.gptscan_agent">GPTScan Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.gptscan_agent.GPTScanAgent"><code class="docutils literal notranslate"><span class="pre">GPTScanAgent</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.llm_smartaudit_agent">LLM SmartAudit Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.llm_smartaudit_agent.LLMSmartAuditAgent"><code class="docutils literal notranslate"><span class="pre">LLMSmartAuditAgent</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#ollama-agent">Ollama Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.ollama_agent.OllamaAgent"><code class="docutils literal notranslate"><span class="pre">OllamaAgent</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#static-analysis-agents">Static Analysis Agents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.aderyn_agent">Aderyn Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.aderyn_agent.AderynAgent"><code class="docutils literal notranslate"><span class="pre">AderynAgent</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#symbolic-execution-agents">Symbolic Execution Agents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.halmos_agent">Halmos Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.halmos_agent.HalmosAgent"><code class="docutils literal notranslate"><span class="pre">HalmosAgent</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.smtchecker_agent">SMTChecker Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.smtchecker_agent.SMTCheckerAgent"><code class="docutils literal notranslate"><span class="pre">SMTCheckerAgent</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#fuzzing-agents">Fuzzing Agents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.medusa_agent">Medusa Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.medusa_agent.MedusaAgent"><code class="docutils literal notranslate"><span class="pre">MedusaAgent</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.wake_agent">Wake Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.wake_agent.WakeAgent"><code class="docutils literal notranslate"><span class="pre">WakeAgent</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#coordination">Coordination</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#crewai-coordinator">CrewAI Coordinator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.crewai_coordinator.CrewAICoordinator"><code class="docutils literal notranslate"><span class="pre">CrewAICoordinator</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/core.html">Core Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#module-src.core.config_loader">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig"><code class="docutils literal notranslate"><span class="pre">AdapterConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.name"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.enabled"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.enabled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.layer"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.layer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.timeout"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.timeout</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.options"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.options</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.__init__"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig"><code class="docutils literal notranslate"><span class="pre">LayerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig.name"><code class="docutils literal notranslate"><span class="pre">LayerConfig.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig.enabled"><code class="docutils literal notranslate"><span class="pre">LayerConfig.enabled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig.priority"><code class="docutils literal notranslate"><span class="pre">LayerConfig.priority</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig.tools"><code class="docutils literal notranslate"><span class="pre">LayerConfig.tools</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig.__init__"><code class="docutils literal notranslate"><span class="pre">LayerConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig"><code class="docutils literal notranslate"><span class="pre">MIESCConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.reload"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.reload()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.version"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.global_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.global_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.max_workers"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.max_workers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.cache_enabled"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.cache_enabled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.log_level"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.log_level</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_adapter_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_adapter_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_layer_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_layer_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_enabled_adapters"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_enabled_adapters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_adapters_by_layer"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_adapters_by_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_all_layers"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_all_layers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_llm_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_llm_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_results_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_results_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_compliance_frameworks"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_compliance_frameworks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_chain_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_chain_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_enabled_chains"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_enabled_chains()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_license_plan_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_license_plan_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.to_dict"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.to_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.get_config"><code class="docutils literal notranslate"><span class="pre">get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#tool-protocol">Tool Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory"><code class="docutils literal notranslate"><span class="pre">ToolCategory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.STATIC_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.STATIC_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.DYNAMIC_TESTING"><code class="docutils literal notranslate"><span class="pre">ToolCategory.DYNAMIC_TESTING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.SYMBOLIC_EXECUTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.SYMBOLIC_EXECUTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.FORMAL_VERIFICATION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.FORMAL_VERIFICATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.AI_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.AI_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.ML_DETECTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.ML_DETECTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.SPECIALIZED"><code class="docutils literal notranslate"><span class="pre">ToolCategory.SPECIALIZED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.CROSSCHAIN_ZK"><code class="docutils literal notranslate"><span class="pre">ToolCategory.CROSSCHAIN_ZK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.ADVANCED_AI_ENSEMBLE"><code class="docutils literal notranslate"><span class="pre">ToolCategory.ADVANCED_AI_ENSEMBLE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.COMPLIANCE"><code class="docutils literal notranslate"><span class="pre">ToolCategory.COMPLIANCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.AUDIT_READINESS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.AUDIT_READINESS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.GAS_OPTIMIZATION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.GAS_OPTIMIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.MEV_DETECTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.MEV_DETECTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.PRIVACY_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.PRIVACY_ANALYSIS</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus"><code class="docutils literal notranslate"><span class="pre">ToolStatus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus.AVAILABLE"><code class="docutils literal notranslate"><span class="pre">ToolStatus.AVAILABLE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus.NOT_INSTALLED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.NOT_INSTALLED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus.CONFIGURATION_ERROR"><code class="docutils literal notranslate"><span class="pre">ToolStatus.CONFIGURATION_ERROR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus.LICENSE_REQUIRED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.LICENSE_REQUIRED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus.DEPRECATED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.DEPRECATED</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability"><code class="docutils literal notranslate"><span class="pre">ToolCapability</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability.name"><code class="docutils literal notranslate"><span class="pre">ToolCapability.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability.description"><code class="docutils literal notranslate"><span class="pre">ToolCapability.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability.supported_languages"><code class="docutils literal notranslate"><span class="pre">ToolCapability.supported_languages</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability.detection_types"><code class="docutils literal notranslate"><span class="pre">ToolCapability.detection_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability.__init__"><code class="docutils literal notranslate"><span class="pre">ToolCapability.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata"><code class="docutils literal notranslate"><span class="pre">ToolMetadata</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.name"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.version"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.category"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.author"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.license"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.license</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.homepage"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.homepage</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.repository"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.repository</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.documentation"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.documentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.installation_cmd"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.installation_cmd</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.capabilities"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.capabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.cost"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.cost</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.requires_api_key"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.requires_api_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.is_optional"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.is_optional</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.__init__"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter"><code class="docutils literal notranslate"><span class="pre">ToolAdapter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.get_metadata"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.is_available"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.is_available()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.analyze"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.normalize_findings"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.normalize_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.get_installation_instructions"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_installation_instructions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.can_analyze"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.can_analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.get_default_config"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.validate_config"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.validate_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.check_binary_available"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.check_binary_available()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.run_subprocess"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.run_subprocess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.parse_json_safely"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.parse_json_safely()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.normalize_severity"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.normalize_severity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.create_finding"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.create_finding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.create_result"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.create_result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.find_binary"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.find_binary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry"><code class="docutils literal notranslate"><span class="pre">ToolRegistry</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.__init__"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.register"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.get_tool"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tool()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.get_all_tools"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_all_tools()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.get_tools_by_category"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tools_by_category()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.get_available_tools"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_available_tools()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.get_tool_status_report"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tool_status_report()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.get_tool_registry"><code class="docutils literal notranslate"><span class="pre">get_tool_registry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#agent-protocol">Agent Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#miesc-agent-protocol">MIESC Agent Protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability"><code class="docutils literal notranslate"><span class="pre">AgentCapability</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.STATIC_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">AgentCapability.STATIC_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.SYMBOLIC_EXECUTION"><code class="docutils literal notranslate"><span class="pre">AgentCapability.SYMBOLIC_EXECUTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.AI_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">AgentCapability.AI_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.FUZZING"><code class="docutils literal notranslate"><span class="pre">AgentCapability.FUZZING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.FORMAL_VERIFICATION"><code class="docutils literal notranslate"><span class="pre">AgentCapability.FORMAL_VERIFICATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.GAS_OPTIMIZATION"><code class="docutils literal notranslate"><span class="pre">AgentCapability.GAS_OPTIMIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.PATTERN_MATCHING"><code class="docutils literal notranslate"><span class="pre">AgentCapability.PATTERN_MATCHING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.DEPENDENCY_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">AgentCapability.DEPENDENCY_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.CODE_QUALITY"><code class="docutils literal notranslate"><span class="pre">AgentCapability.CODE_QUALITY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.CUSTOM_RULES"><code class="docutils literal notranslate"><span class="pre">AgentCapability.CUSTOM_RULES</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentSpeed"><code class="docutils literal notranslate"><span class="pre">AgentSpeed</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentSpeed.FAST"><code class="docutils literal notranslate"><span class="pre">AgentSpeed.FAST</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentSpeed.MEDIUM"><code class="docutils literal notranslate"><span class="pre">AgentSpeed.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentSpeed.SLOW"><code class="docutils literal notranslate"><span class="pre">AgentSpeed.SLOW</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisStatus"><code class="docutils literal notranslate"><span class="pre">AnalysisStatus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisStatus.SUCCESS"><code class="docutils literal notranslate"><span class="pre">AnalysisStatus.SUCCESS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisStatus.ERROR"><code class="docutils literal notranslate"><span class="pre">AnalysisStatus.ERROR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisStatus.TIMEOUT"><code class="docutils literal notranslate"><span class="pre">AnalysisStatus.TIMEOUT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisStatus.SKIPPED"><code class="docutils literal notranslate"><span class="pre">AnalysisStatus.SKIPPED</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity"><code class="docutils literal notranslate"><span class="pre">FindingSeverity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity.CRITICAL"><code class="docutils literal notranslate"><span class="pre">FindingSeverity.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity.HIGH"><code class="docutils literal notranslate"><span class="pre">FindingSeverity.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity.MEDIUM"><code class="docutils literal notranslate"><span class="pre">FindingSeverity.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity.LOW"><code class="docutils literal notranslate"><span class="pre">FindingSeverity.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity.INFO"><code class="docutils literal notranslate"><span class="pre">FindingSeverity.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata"><code class="docutils literal notranslate"><span class="pre">AgentMetadata</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.name"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.version"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.description"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.author"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.license"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.license</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.capabilities"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.capabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.supported_languages"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.supported_languages</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.cost"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.cost</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.speed"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.speed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.homepage"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.homepage</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.repository"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.repository</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.documentation"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.documentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.installation"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.installation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.requires"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.requires</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.__init__"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding"><code class="docutils literal notranslate"><span class="pre">Finding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.type"><code class="docutils literal notranslate"><span class="pre">Finding.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.severity"><code class="docutils literal notranslate"><span class="pre">Finding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.location"><code class="docutils literal notranslate"><span class="pre">Finding.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.message"><code class="docutils literal notranslate"><span class="pre">Finding.message</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.description"><code class="docutils literal notranslate"><span class="pre">Finding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.recommendation"><code class="docutils literal notranslate"><span class="pre">Finding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.reference"><code class="docutils literal notranslate"><span class="pre">Finding.reference</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.confidence"><code class="docutils literal notranslate"><span class="pre">Finding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.impact"><code class="docutils literal notranslate"><span class="pre">Finding.impact</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.code_snippet"><code class="docutils literal notranslate"><span class="pre">Finding.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.__init__"><code class="docutils literal notranslate"><span class="pre">Finding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult"><code class="docutils literal notranslate"><span class="pre">AnalysisResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.agent"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.agent</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.version"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.status"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.status</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.timestamp"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.timestamp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.execution_time"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.execution_time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.findings"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.findings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.summary"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.summary</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.metadata"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.error"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.error</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.__init__"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent"><code class="docutils literal notranslate"><span class="pre">SecurityAgent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.name"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.version"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.description"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.author"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.license"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.license</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.capabilities"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.capabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.supported_languages"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.supported_languages</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.cost"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.cost</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.speed"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.speed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.is_available"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.is_available()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.can_analyze"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.can_analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.analyze"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.get_metadata"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.get_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.validate"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.validate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.get_config_schema"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.get_config_schema()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.configure"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.configure()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentPlugin"><code class="docutils literal notranslate"><span class="pre">AgentPlugin</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentPlugin.register"><code class="docutils literal notranslate"><span class="pre">AgentPlugin.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentPlugin.get_registered_agents"><code class="docutils literal notranslate"><span class="pre">AgentPlugin.get_registered_agents()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#agent-registry">Agent Registry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#miesc-agent-registry">MIESC Agent Registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry"><code class="docutils literal notranslate"><span class="pre">AgentRegistry</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.__init__"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.register"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.unregister"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.unregister()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.get"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.list_agents"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.list_agents()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.discover_all"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.discover_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.filter_agents"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.filter_agents()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.get_statistics"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.get_statistics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.validate_all"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.validate_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.__len__"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.__len__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.__contains__"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.__iter__"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.__iter__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#orchestration">Orchestration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#module-src.core.ml_orchestrator">ML Orchestrator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.ml_orchestrator.MLAnalysisResult"><code class="docutils literal notranslate"><span class="pre">MLAnalysisResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.ml_orchestrator.MLOrchestrator"><code class="docutils literal notranslate"><span class="pre">MLOrchestrator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.ml_orchestrator.get_ml_orchestrator"><code class="docutils literal notranslate"><span class="pre">get_ml_orchestrator()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#exporters">Exporters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding"><code class="docutils literal notranslate"><span class="pre">Finding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.id"><code class="docutils literal notranslate"><span class="pre">Finding.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.type"><code class="docutils literal notranslate"><span class="pre">Finding.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.severity"><code class="docutils literal notranslate"><span class="pre">Finding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.title"><code class="docutils literal notranslate"><span class="pre">Finding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.description"><code class="docutils literal notranslate"><span class="pre">Finding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.file_path"><code class="docutils literal notranslate"><span class="pre">Finding.file_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.line_start"><code class="docutils literal notranslate"><span class="pre">Finding.line_start</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.line_end"><code class="docutils literal notranslate"><span class="pre">Finding.line_end</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.column_start"><code class="docutils literal notranslate"><span class="pre">Finding.column_start</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.column_end"><code class="docutils literal notranslate"><span class="pre">Finding.column_end</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.tool"><code class="docutils literal notranslate"><span class="pre">Finding.tool</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.layer"><code class="docutils literal notranslate"><span class="pre">Finding.layer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.cwe"><code class="docutils literal notranslate"><span class="pre">Finding.cwe</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.swc"><code class="docutils literal notranslate"><span class="pre">Finding.swc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.confidence"><code class="docutils literal notranslate"><span class="pre">Finding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.remediation"><code class="docutils literal notranslate"><span class="pre">Finding.remediation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.__init__"><code class="docutils literal notranslate"><span class="pre">Finding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SARIFExporter"><code class="docutils literal notranslate"><span class="pre">SARIFExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SARIFExporter.SARIF_VERSION"><code class="docutils literal notranslate"><span class="pre">SARIFExporter.SARIF_VERSION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SARIFExporter.SARIF_SCHEMA"><code class="docutils literal notranslate"><span class="pre">SARIFExporter.SARIF_SCHEMA</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SARIFExporter.__init__"><code class="docutils literal notranslate"><span class="pre">SARIFExporter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SARIFExporter.export"><code class="docutils literal notranslate"><span class="pre">SARIFExporter.export()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SonarQubeExporter"><code class="docutils literal notranslate"><span class="pre">SonarQubeExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SonarQubeExporter.export"><code class="docutils literal notranslate"><span class="pre">SonarQubeExporter.export()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.CheckmarxExporter"><code class="docutils literal notranslate"><span class="pre">CheckmarxExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.CheckmarxExporter.export"><code class="docutils literal notranslate"><span class="pre">CheckmarxExporter.export()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.MarkdownExporter"><code class="docutils literal notranslate"><span class="pre">MarkdownExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.MarkdownExporter.export"><code class="docutils literal notranslate"><span class="pre">MarkdownExporter.export()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.JSONExporter"><code class="docutils literal notranslate"><span class="pre">JSONExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.JSONExporter.export"><code class="docutils literal notranslate"><span class="pre">JSONExporter.export()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.ReportExporter"><code class="docutils literal notranslate"><span class="pre">ReportExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.ReportExporter.__init__"><code class="docutils literal notranslate"><span class="pre">ReportExporter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.ReportExporter.export"><code class="docutils literal notranslate"><span class="pre">ReportExporter.export()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.ReportExporter.export_all"><code class="docutils literal notranslate"><span class="pre">ReportExporter.export_all()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#framework-detection">Framework Detection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#miesc-framework-auto-detection">MIESC Framework Auto-Detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework"><code class="docutils literal notranslate"><span class="pre">Framework</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework.FOUNDRY"><code class="docutils literal notranslate"><span class="pre">Framework.FOUNDRY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework.HARDHAT"><code class="docutils literal notranslate"><span class="pre">Framework.HARDHAT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework.TRUFFLE"><code class="docutils literal notranslate"><span class="pre">Framework.TRUFFLE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework.BROWNIE"><code class="docutils literal notranslate"><span class="pre">Framework.BROWNIE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework.UNKNOWN"><code class="docutils literal notranslate"><span class="pre">Framework.UNKNOWN</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.framework"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.framework</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.root_path"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.root_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.config_file"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.config_file</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.solc_version"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.solc_version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.evm_version"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.evm_version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.optimizer_enabled"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.optimizer_enabled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.optimizer_runs"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.optimizer_runs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.remappings"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.remappings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.lib_paths"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.lib_paths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.src_path"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.src_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.test_path"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.test_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.out_path"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.out_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.extra_config"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.extra_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.to_dict"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.__init__"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.DETECTION_FILES"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.DETECTION_FILES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.__init__"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.detect"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.detect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.get_solc_args"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.get_solc_args()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.get_slither_args"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.get_slither_args()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.clear_cache"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.clear_cache()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.detect_framework"><code class="docutils literal notranslate"><span class="pre">detect_framework()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.get_framework_name"><code class="docutils literal notranslate"><span class="pre">get_framework_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.is_foundry_project"><code class="docutils literal notranslate"><span class="pre">is_foundry_project()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.is_hardhat_project"><code class="docutils literal notranslate"><span class="pre">is_hardhat_project()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#rich-cli">Rich CLI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle"><code class="docutils literal notranslate"><span class="pre">SeverityStyle</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle.CRITICAL"><code class="docutils literal notranslate"><span class="pre">SeverityStyle.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle.HIGH"><code class="docutils literal notranslate"><span class="pre">SeverityStyle.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle.MEDIUM"><code class="docutils literal notranslate"><span class="pre">SeverityStyle.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle.LOW"><code class="docutils literal notranslate"><span class="pre">SeverityStyle.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle.INFO"><code class="docutils literal notranslate"><span class="pre">SeverityStyle.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.BANNER"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.BANNER</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.__init__"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_banner"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_banner()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_welcome"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_welcome()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_tools_status"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_tools_status()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_contract_info"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_contract_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.create_progress"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.create_progress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.run_with_progress"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.run_with_progress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.run_audit_with_progress"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.run_audit_with_progress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_findings_summary"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_findings_summary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_findings_detail"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_findings_detail()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_findings_tree"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_findings_tree()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.prompt_contract"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.prompt_contract()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.prompt_tools"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.prompt_tools()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.prompt_confirm"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.prompt_confirm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_export_options"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_export_options()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_completion"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_completion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.error"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.warning"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.warning()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.success"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.success()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.info"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.info()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.create_cli"><code class="docutils literal notranslate"><span class="pre">create_cli()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#correlation-api">Correlation API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.__init__"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.add_tool_results"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.add_tool_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.analyze"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.get_findings_by_severity"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.get_findings_by_severity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.get_findings_by_type"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.get_findings_by_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.get_cross_validated_only"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.get_cross_validated_only()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.clear"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.clear()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.analyze_contract_with_correlation"><code class="docutils literal notranslate"><span class="pre">analyze_contract_with_correlation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/detectors.html">Detectors Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/detectors.html#detector-api">Detector API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity"><code class="docutils literal notranslate"><span class="pre">Severity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.CRITICAL"><code class="docutils literal notranslate"><span class="pre">Severity.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.HIGH"><code class="docutils literal notranslate"><span class="pre">Severity.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.MEDIUM"><code class="docutils literal notranslate"><span class="pre">Severity.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.LOW"><code class="docutils literal notranslate"><span class="pre">Severity.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.INFO"><code class="docutils literal notranslate"><span class="pre">Severity.INFO</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.from_string"><code class="docutils literal notranslate"><span class="pre">Severity.from_string()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category"><code class="docutils literal notranslate"><span class="pre">Category</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.REENTRANCY"><code class="docutils literal notranslate"><span class="pre">Category.REENTRANCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.ACCESS_CONTROL"><code class="docutils literal notranslate"><span class="pre">Category.ACCESS_CONTROL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.ARITHMETIC"><code class="docutils literal notranslate"><span class="pre">Category.ARITHMETIC</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.FLASH_LOAN"><code class="docutils literal notranslate"><span class="pre">Category.FLASH_LOAN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.ORACLE_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">Category.ORACLE_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.GOVERNANCE"><code class="docutils literal notranslate"><span class="pre">Category.GOVERNANCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.RUG_PULL"><code class="docutils literal notranslate"><span class="pre">Category.RUG_PULL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.HONEYPOT"><code class="docutils literal notranslate"><span class="pre">Category.HONEYPOT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.PROXY_UPGRADE"><code class="docutils literal notranslate"><span class="pre">Category.PROXY_UPGRADE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.CENTRALIZATION"><code class="docutils literal notranslate"><span class="pre">Category.CENTRALIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.DOS"><code class="docutils literal notranslate"><span class="pre">Category.DOS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.FRONT_RUNNING"><code class="docutils literal notranslate"><span class="pre">Category.FRONT_RUNNING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.TIMESTAMP_DEPENDENCY"><code class="docutils literal notranslate"><span class="pre">Category.TIMESTAMP_DEPENDENCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.UNCHECKED_RETURN"><code class="docutils literal notranslate"><span class="pre">Category.UNCHECKED_RETURN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.GAS_OPTIMIZATION"><code class="docutils literal notranslate"><span class="pre">Category.GAS_OPTIMIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.CUSTOM"><code class="docutils literal notranslate"><span class="pre">Category.CUSTOM</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location"><code class="docutils literal notranslate"><span class="pre">Location</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.file_path"><code class="docutils literal notranslate"><span class="pre">Location.file_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.line_start"><code class="docutils literal notranslate"><span class="pre">Location.line_start</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.line_end"><code class="docutils literal notranslate"><span class="pre">Location.line_end</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.column_start"><code class="docutils literal notranslate"><span class="pre">Location.column_start</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.column_end"><code class="docutils literal notranslate"><span class="pre">Location.column_end</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.__init__"><code class="docutils literal notranslate"><span class="pre">Location.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding"><code class="docutils literal notranslate"><span class="pre">Finding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.detector"><code class="docutils literal notranslate"><span class="pre">Finding.detector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.title"><code class="docutils literal notranslate"><span class="pre">Finding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.description"><code class="docutils literal notranslate"><span class="pre">Finding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.severity"><code class="docutils literal notranslate"><span class="pre">Finding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.category"><code class="docutils literal notranslate"><span class="pre">Finding.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.confidence"><code class="docutils literal notranslate"><span class="pre">Finding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.location"><code class="docutils literal notranslate"><span class="pre">Finding.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.code_snippet"><code class="docutils literal notranslate"><span class="pre">Finding.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.recommendation"><code class="docutils literal notranslate"><span class="pre">Finding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.references"><code class="docutils literal notranslate"><span class="pre">Finding.references</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.cwe_id"><code class="docutils literal notranslate"><span class="pre">Finding.cwe_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.swc_id"><code class="docutils literal notranslate"><span class="pre">Finding.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.metadata"><code class="docutils literal notranslate"><span class="pre">Finding.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.to_dict"><code class="docutils literal notranslate"><span class="pre">Finding.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.__init__"><code class="docutils literal notranslate"><span class="pre">Finding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector"><code class="docutils literal notranslate"><span class="pre">BaseDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.name"><code class="docutils literal notranslate"><span class="pre">BaseDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.description"><code class="docutils literal notranslate"><span class="pre">BaseDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.version"><code class="docutils literal notranslate"><span class="pre">BaseDetector.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.author"><code class="docutils literal notranslate"><span class="pre">BaseDetector.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.category"><code class="docutils literal notranslate"><span class="pre">BaseDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.default_severity"><code class="docutils literal notranslate"><span class="pre">BaseDetector.default_severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.target_patterns"><code class="docutils literal notranslate"><span class="pre">BaseDetector.target_patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.__init__"><code class="docutils literal notranslate"><span class="pre">BaseDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.enabled"><code class="docutils literal notranslate"><span class="pre">BaseDetector.enabled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.configure"><code class="docutils literal notranslate"><span class="pre">BaseDetector.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.should_run"><code class="docutils literal notranslate"><span class="pre">BaseDetector.should_run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.analyze"><code class="docutils literal notranslate"><span class="pre">BaseDetector.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.analyze_file"><code class="docutils literal notranslate"><span class="pre">BaseDetector.analyze_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.create_finding"><code class="docutils literal notranslate"><span class="pre">BaseDetector.create_finding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.find_pattern"><code class="docutils literal notranslate"><span class="pre">BaseDetector.find_pattern()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.find_multiline_pattern"><code class="docutils literal notranslate"><span class="pre">BaseDetector.find_multiline_pattern()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.PatternDetector"><code class="docutils literal notranslate"><span class="pre">PatternDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.PatternDetector.PATTERNS"><code class="docutils literal notranslate"><span class="pre">PatternDetector.PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.PatternDetector.analyze"><code class="docutils literal notranslate"><span class="pre">PatternDetector.analyze()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.detectors"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.detectors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.register"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.register_class"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.register_class()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.unregister"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.unregister()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.get"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.list_detectors"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.list_detectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.run_all"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.run_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.get_summary"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.register_detector"><code class="docutils literal notranslate"><span class="pre">register_detector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.get_registry"><code class="docutils literal notranslate"><span class="pre">get_registry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/detectors.html#defi-detectors">DeFi Detectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity"><code class="docutils literal notranslate"><span class="pre">Severity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity.CRITICAL"><code class="docutils literal notranslate"><span class="pre">Severity.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity.HIGH"><code class="docutils literal notranslate"><span class="pre">Severity.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity.MEDIUM"><code class="docutils literal notranslate"><span class="pre">Severity.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity.LOW"><code class="docutils literal notranslate"><span class="pre">Severity.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity.INFO"><code class="docutils literal notranslate"><span class="pre">Severity.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory"><code class="docutils literal notranslate"><span class="pre">DeFiCategory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.FLASH_LOAN"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.FLASH_LOAN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.ORACLE_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.ORACLE_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.PRICE_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.PRICE_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.SANDWICH_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.SANDWICH_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.MEV_EXPOSURE"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.MEV_EXPOSURE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.SLIPPAGE"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.SLIPPAGE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.LIQUIDITY"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.LIQUIDITY</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding"><code class="docutils literal notranslate"><span class="pre">DeFiFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.title"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.description"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.severity"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.category"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.line"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.code_snippet"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.recommendation"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.references"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.references</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.confidence"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.__init__"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetector"><code class="docutils literal notranslate"><span class="pre">DeFiDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetector.name"><code class="docutils literal notranslate"><span class="pre">DeFiDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetector.description"><code class="docutils literal notranslate"><span class="pre">DeFiDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetector.category"><code class="docutils literal notranslate"><span class="pre">DeFiDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetector.detect"><code class="docutils literal notranslate"><span class="pre">DeFiDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.name"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.description"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.category"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.CALLBACK_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.CALLBACK_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.DANGER_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.DANGER_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.detect"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.name"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.description"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.category"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.ORACLE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.ORACLE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.STALENESS_CHECK"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.STALENESS_CHECK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.DEVIATION_CHECK"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.DEVIATION_CHECK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.detect"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.name"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.description"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.category"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.SWAP_PATTERNS"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.SWAP_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.SLIPPAGE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.SLIPPAGE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.detect"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.name"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.description"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.category"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.MEV_PATTERNS"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.MEV_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.PROTECTION_PATTERNS"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.PROTECTION_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.detect"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.name"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.description"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.category"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.PRICE_CALC_PATTERNS"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.PRICE_CALC_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.SANITY_CHECK_PATTERNS"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.SANITY_CHECK_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.detect"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine.__init__"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine.detectors"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine.detectors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine.analyze"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine.analyze_file"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine.analyze_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine.get_summary"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/detectors.html#advanced-detectors">Advanced Detectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity"><code class="docutils literal notranslate"><span class="pre">Severity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity.CRITICAL"><code class="docutils literal notranslate"><span class="pre">Severity.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity.HIGH"><code class="docutils literal notranslate"><span class="pre">Severity.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity.MEDIUM"><code class="docutils literal notranslate"><span class="pre">Severity.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity.LOW"><code class="docutils literal notranslate"><span class="pre">Severity.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity.INFO"><code class="docutils literal notranslate"><span class="pre">Severity.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory"><code class="docutils literal notranslate"><span class="pre">AttackCategory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.RUG_PULL"><code class="docutils literal notranslate"><span class="pre">AttackCategory.RUG_PULL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.GOVERNANCE"><code class="docutils literal notranslate"><span class="pre">AttackCategory.GOVERNANCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.HONEYPOT"><code class="docutils literal notranslate"><span class="pre">AttackCategory.HONEYPOT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.TOKEN_SECURITY"><code class="docutils literal notranslate"><span class="pre">AttackCategory.TOKEN_SECURITY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.PROXY_UPGRADE"><code class="docutils literal notranslate"><span class="pre">AttackCategory.PROXY_UPGRADE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.CENTRALIZATION"><code class="docutils literal notranslate"><span class="pre">AttackCategory.CENTRALIZATION</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.title"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.description"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.severity"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.category"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.line"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.code_snippet"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.recommendation"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.references"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.references</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.confidence"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.__init__"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector"><code class="docutils literal notranslate"><span class="pre">RugPullDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.name"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.description"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.category"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.OWNER_DRAIN_PATTERNS"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.OWNER_DRAIN_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.HIDDEN_MINT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.HIDDEN_MINT_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.BLACKLIST_PATTERNS"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.BLACKLIST_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.detect"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.name"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.description"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.category"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.FLASH_LOAN_VOTE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.FLASH_LOAN_VOTE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.TIMELOCK_PATTERNS"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.TIMELOCK_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.QUORUM_PATTERNS"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.QUORUM_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.detect"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.name"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.description"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.category"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.HONEYPOT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.HONEYPOT_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.HIDDEN_FEE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.HIDDEN_FEE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.MAX_TX_PATTERNS"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.MAX_TX_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.ANTIBOT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.ANTIBOT_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.detect"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.name"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.description"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.category"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.INIT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.INIT_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.STORAGE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.STORAGE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.UPGRADE_AUTH_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.UPGRADE_AUTH_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.DELEGATECALL_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.DELEGATECALL_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.detect"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector.name"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector.description"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector.category"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector.CENTRALIZATION_PATTERNS"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector.CENTRALIZATION_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector.detect"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedDetectorEngine"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorEngine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedDetectorEngine.__init__"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorEngine.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedDetectorEngine.analyze"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorEngine.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedDetectorEngine.analyze_file"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorEngine.analyze_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedDetectorEngine.get_summary"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorEngine.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/detectors.html#dependency-analyzer">Dependency Analyzer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk"><code class="docutils literal notranslate"><span class="pre">DependencyRisk</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk.CRITICAL"><code class="docutils literal notranslate"><span class="pre">DependencyRisk.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk.HIGH"><code class="docutils literal notranslate"><span class="pre">DependencyRisk.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk.MEDIUM"><code class="docutils literal notranslate"><span class="pre">DependencyRisk.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk.LOW"><code class="docutils literal notranslate"><span class="pre">DependencyRisk.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk.INFO"><code class="docutils literal notranslate"><span class="pre">DependencyRisk.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding"><code class="docutils literal notranslate"><span class="pre">DependencyFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.title"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.description"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.severity"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.package"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.package</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.version"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.line"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.recommendation"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.cve"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.cve</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.references"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.references</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.__init__"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.name"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.layer"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.layer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.description"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.__init__"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.analyze"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.analyze_file"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.analyze_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.get_summary"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/detectors.html#smartbugs-detectors">SmartBugs Detectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity"><code class="docutils literal notranslate"><span class="pre">Severity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity.CRITICAL"><code class="docutils literal notranslate"><span class="pre">Severity.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity.HIGH"><code class="docutils literal notranslate"><span class="pre">Severity.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity.MEDIUM"><code class="docutils literal notranslate"><span class="pre">Severity.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity.LOW"><code class="docutils literal notranslate"><span class="pre">Severity.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity.INFO"><code class="docutils literal notranslate"><span class="pre">Severity.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.title"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.description"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.severity"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.category"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.line"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.code_snippet"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.swc_id"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.confidence"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.__init__"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.name"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.category"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.ARITHMETIC_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.ARITHMETIC_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.SAFEMATH_LINE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.SAFEMATH_LINE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.detect"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.name"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.category"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.WEAK_RANDOMNESS_PATTERNS"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.WEAK_RANDOMNESS_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.RANDOMNESS_CONTEXT"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.RANDOMNESS_CONTEXT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.detect"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector.name"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector.category"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector.DOS_PATTERNS"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector.DOS_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector.detect"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector.name"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector.category"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector.FRONT_RUNNING_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector.FRONT_RUNNING_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector.detect"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector.name"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector.category"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector.VULNERABLE_FUNCTION_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector.VULNERABLE_FUNCTION_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector.detect"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.name"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.category"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.EXTERNAL_CALL_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.EXTERNAL_CALL_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.STATE_CHANGE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.STATE_CHANGE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.detect"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.name"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.category"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.CRITICAL_FUNCTIONS"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.CRITICAL_FUNCTIONS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.ACCESS_CONTROL_PATTERNS"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.ACCESS_CONTROL_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.detect"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector.name"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector.category"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector.LOW_LEVEL_CALLS"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector.LOW_LEVEL_CALLS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector.detect"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector.name"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector.category"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector.TIME_PATTERNS"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector.TIME_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector.detect"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsDetectorEngine"><code class="docutils literal notranslate"><span class="pre">SmartBugsDetectorEngine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsDetectorEngine.__init__"><code class="docutils literal notranslate"><span class="pre">SmartBugsDetectorEngine.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsDetectorEngine.analyze"><code class="docutils literal notranslate"><span class="pre">SmartBugsDetectorEngine.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsDetectorEngine.analyze_file"><code class="docutils literal notranslate"><span class="pre">SmartBugsDetectorEngine.analyze_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsDetectorEngine.get_summary"><code class="docutils literal notranslate"><span class="pre">SmartBugsDetectorEngine.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/llm.html">LLM Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/llm.html#llm-orchestrator">LLM Orchestrator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMProvider"><code class="docutils literal notranslate"><span class="pre">LLMProvider</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMProvider.OLLAMA"><code class="docutils literal notranslate"><span class="pre">LLMProvider.OLLAMA</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMProvider.OPENAI"><code class="docutils literal notranslate"><span class="pre">LLMProvider.OPENAI</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMProvider.ANTHROPIC"><code class="docutils literal notranslate"><span class="pre">LLMProvider.ANTHROPIC</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMProvider.LOCAL"><code class="docutils literal notranslate"><span class="pre">LLMProvider.LOCAL</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig"><code class="docutils literal notranslate"><span class="pre">LLMConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.provider"><code class="docutils literal notranslate"><span class="pre">LLMConfig.provider</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.model"><code class="docutils literal notranslate"><span class="pre">LLMConfig.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.api_key"><code class="docutils literal notranslate"><span class="pre">LLMConfig.api_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.base_url"><code class="docutils literal notranslate"><span class="pre">LLMConfig.base_url</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.temperature"><code class="docutils literal notranslate"><span class="pre">LLMConfig.temperature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.max_tokens"><code class="docutils literal notranslate"><span class="pre">LLMConfig.max_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.timeout"><code class="docutils literal notranslate"><span class="pre">LLMConfig.timeout</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.retry_attempts"><code class="docutils literal notranslate"><span class="pre">LLMConfig.retry_attempts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.retry_delay"><code class="docutils literal notranslate"><span class="pre">LLMConfig.retry_delay</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.__init__"><code class="docutils literal notranslate"><span class="pre">LLMConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse"><code class="docutils literal notranslate"><span class="pre">LLMResponse</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.content"><code class="docutils literal notranslate"><span class="pre">LLMResponse.content</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.provider"><code class="docutils literal notranslate"><span class="pre">LLMResponse.provider</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.model"><code class="docutils literal notranslate"><span class="pre">LLMResponse.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.tokens_used"><code class="docutils literal notranslate"><span class="pre">LLMResponse.tokens_used</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.latency_ms"><code class="docutils literal notranslate"><span class="pre">LLMResponse.latency_ms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.cached"><code class="docutils literal notranslate"><span class="pre">LLMResponse.cached</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.metadata"><code class="docutils literal notranslate"><span class="pre">LLMResponse.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.__init__"><code class="docutils literal notranslate"><span class="pre">LLMResponse.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.vulnerabilities"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.vulnerabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.severity_assessment"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.severity_assessment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.recommendations"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.recommendations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.confidence_score"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.confidence_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.analysis_summary"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.analysis_summary</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.raw_response"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.raw_response</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.__init__"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMBackend"><code class="docutils literal notranslate"><span class="pre">LLMBackend</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMBackend.__init__"><code class="docutils literal notranslate"><span class="pre">LLMBackend.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMBackend.analyze"><code class="docutils literal notranslate"><span class="pre">LLMBackend.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMBackend.health_check"><code class="docutils literal notranslate"><span class="pre">LLMBackend.health_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMBackend.get_system_prompt"><code class="docutils literal notranslate"><span class="pre">LLMBackend.get_system_prompt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OllamaBackend"><code class="docutils literal notranslate"><span class="pre">OllamaBackend</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OllamaBackend.__init__"><code class="docutils literal notranslate"><span class="pre">OllamaBackend.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OllamaBackend.health_check"><code class="docutils literal notranslate"><span class="pre">OllamaBackend.health_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OllamaBackend.analyze"><code class="docutils literal notranslate"><span class="pre">OllamaBackend.analyze()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OpenAIBackend"><code class="docutils literal notranslate"><span class="pre">OpenAIBackend</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OpenAIBackend.__init__"><code class="docutils literal notranslate"><span class="pre">OpenAIBackend.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OpenAIBackend.health_check"><code class="docutils literal notranslate"><span class="pre">OpenAIBackend.health_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OpenAIBackend.analyze"><code class="docutils literal notranslate"><span class="pre">OpenAIBackend.analyze()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.AnthropicBackend"><code class="docutils literal notranslate"><span class="pre">AnthropicBackend</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.AnthropicBackend.__init__"><code class="docutils literal notranslate"><span class="pre">AnthropicBackend.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.AnthropicBackend.health_check"><code class="docutils literal notranslate"><span class="pre">AnthropicBackend.health_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.AnthropicBackend.analyze"><code class="docutils literal notranslate"><span class="pre">AnthropicBackend.analyze()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.__init__"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.backends"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.backends</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.primary_provider"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.primary_provider</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.cache"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.cache</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.cache_ttl"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.cache_ttl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.initialize"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.initialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.analyze_contract"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.analyze_contract()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.query"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.select_model_for_task"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.select_model_for_task()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.get_available_providers"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.get_available_providers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.clear_cache"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.clear_cache()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.analyze_solidity"><code class="docutils literal notranslate"><span class="pre">analyze_solidity()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/llm.html#embedding-rag">Embedding RAG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#embedding-based-rag-for-vulnerability-analysis-miesc-v5-1-0">Embedding-based RAG for Vulnerability Analysis - MIESC v5.1.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.id"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.swc_id"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.cwe_id"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.cwe_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.title"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.description"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.vulnerable_code"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.vulnerable_code</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.fixed_code"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.fixed_code</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.attack_scenario"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.attack_scenario</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.severity"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.category"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.real_exploit"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.real_exploit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.tags"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.tags</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.references"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.references</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.to_text"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.to_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.to_metadata"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.to_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.__init__"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult"><code class="docutils literal notranslate"><span class="pre">RetrievalResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult.document"><code class="docutils literal notranslate"><span class="pre">RetrievalResult.document</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult.similarity_score"><code class="docutils literal notranslate"><span class="pre">RetrievalResult.similarity_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult.relevance_reason"><code class="docutils literal notranslate"><span class="pre">RetrievalResult.relevance_reason</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult.to_context"><code class="docutils literal notranslate"><span class="pre">RetrievalResult.to_context()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult.__init__"><code class="docutils literal notranslate"><span class="pre">RetrievalResult.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.DEFAULT_MODEL"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.DEFAULT_MODEL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.COLLECTION_NAME"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.COLLECTION_NAME</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.CACHE_MAX_SIZE"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.CACHE_MAX_SIZE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.CACHE_TTL_SECONDS"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.CACHE_TTL_SECONDS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.__init__"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.get_cache_stats"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.get_cache_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.clear_cache"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.clear_cache()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.search"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.search()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.batch_search"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.batch_search()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.search_by_finding"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.search_by_finding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.get_context_for_llm"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.get_context_for_llm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.add_custom_vulnerability"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.add_custom_vulnerability()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.get_stats"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.get_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.reindex"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.reindex()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.HybridRAG"><code class="docutils literal notranslate"><span class="pre">HybridRAG</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.HybridRAG.__init__"><code class="docutils literal notranslate"><span class="pre">HybridRAG.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.HybridRAG.search"><code class="docutils literal notranslate"><span class="pre">HybridRAG.search()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.get_rag"><code class="docutils literal notranslate"><span class="pre">get_rag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.search_vulnerabilities"><code class="docutils literal notranslate"><span class="pre">search_vulnerabilities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.get_context_for_finding"><code class="docutils literal notranslate"><span class="pre">get_context_for_finding()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.batch_get_context_for_findings"><code class="docutils literal notranslate"><span class="pre">batch_get_context_for_findings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/llm.html#architecture">Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#rag-components">RAG Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#supported-models">Supported Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#configuration">Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/ml.html">ML Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#classic-patterns">Classic Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#classic-vulnerability-pattern-detector">Classic Vulnerability Pattern Detector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.REENTRANCY"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.REENTRANCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.ACCESS_CONTROL"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.ACCESS_CONTROL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.ARITHMETIC"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.ARITHMETIC</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.UNCHECKED_CALLS"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.UNCHECKED_CALLS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.UNCHECKED_SEND"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.UNCHECKED_SEND</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.TIMESTAMP"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.TIMESTAMP</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.BAD_RANDOMNESS"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.BAD_RANDOMNESS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.FRONT_RUNNING"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.FRONT_RUNNING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.DOS"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.DOS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.SHORT_ADDRESS"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.SHORT_ADDRESS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.VYPER_REENTRANCY"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.VYPER_REENTRANCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.PERMIT_FRONTRUN"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.PERMIT_FRONTRUN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.INTEGER_OVERFLOW"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.INTEGER_OVERFLOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.INTEGER_UNDERFLOW"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.INTEGER_UNDERFLOW</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch"><code class="docutils literal notranslate"><span class="pre">PatternMatch</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.vuln_type"><code class="docutils literal notranslate"><span class="pre">PatternMatch.vuln_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.line"><code class="docutils literal notranslate"><span class="pre">PatternMatch.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.code_snippet"><code class="docutils literal notranslate"><span class="pre">PatternMatch.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.pattern_matched"><code class="docutils literal notranslate"><span class="pre">PatternMatch.pattern_matched</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.confidence"><code class="docutils literal notranslate"><span class="pre">PatternMatch.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.severity"><code class="docutils literal notranslate"><span class="pre">PatternMatch.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.swc_id"><code class="docutils literal notranslate"><span class="pre">PatternMatch.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.description"><code class="docutils literal notranslate"><span class="pre">PatternMatch.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.recommendation"><code class="docutils literal notranslate"><span class="pre">PatternMatch.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.__init__"><code class="docutils literal notranslate"><span class="pre">PatternMatch.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig"><code class="docutils literal notranslate"><span class="pre">PatternConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.vuln_type"><code class="docutils literal notranslate"><span class="pre">PatternConfig.vuln_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.patterns"><code class="docutils literal notranslate"><span class="pre">PatternConfig.patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.anti_patterns"><code class="docutils literal notranslate"><span class="pre">PatternConfig.anti_patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.severity"><code class="docutils literal notranslate"><span class="pre">PatternConfig.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.swc_id"><code class="docutils literal notranslate"><span class="pre">PatternConfig.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.description"><code class="docutils literal notranslate"><span class="pre">PatternConfig.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.recommendation"><code class="docutils literal notranslate"><span class="pre">PatternConfig.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.context_validator"><code class="docutils literal notranslate"><span class="pre">PatternConfig.context_validator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.__init__"><code class="docutils literal notranslate"><span class="pre">PatternConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicPatternDetector"><code class="docutils literal notranslate"><span class="pre">ClassicPatternDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicPatternDetector.__init__"><code class="docutils literal notranslate"><span class="pre">ClassicPatternDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicPatternDetector.detect"><code class="docutils literal notranslate"><span class="pre">ClassicPatternDetector.detect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicPatternDetector.detect_with_context"><code class="docutils literal notranslate"><span class="pre">ClassicPatternDetector.detect_with_context()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.detect_classic_vulnerabilities"><code class="docutils literal notranslate"><span class="pre">detect_classic_vulnerabilities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.vuln_type"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.vuln_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.severity"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.line"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.function"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.description"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.recommendation"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.confidence"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.__init__"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.PRIVILEGED_OPERATIONS"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.PRIVILEGED_OPERATIONS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.ACCESS_CONTROL_MODIFIERS"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.ACCESS_CONTROL_MODIFIERS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.REQUIRE_ACCESS_PATTERNS"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.REQUIRE_ACCESS_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.__init__"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.analyze"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.to_findings"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.to_findings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding"><code class="docutils literal notranslate"><span class="pre">DoSFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.vuln_type"><code class="docutils literal notranslate"><span class="pre">DoSFinding.vuln_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.severity"><code class="docutils literal notranslate"><span class="pre">DoSFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.line"><code class="docutils literal notranslate"><span class="pre">DoSFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.function"><code class="docutils literal notranslate"><span class="pre">DoSFinding.function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.description"><code class="docutils literal notranslate"><span class="pre">DoSFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.recommendation"><code class="docutils literal notranslate"><span class="pre">DoSFinding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.confidence"><code class="docutils literal notranslate"><span class="pre">DoSFinding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.__init__"><code class="docutils literal notranslate"><span class="pre">DoSFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.UNBOUNDED_LOOP_PATTERNS"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.UNBOUNDED_LOOP_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.USER_GROWING_ARRAY_PATTERNS"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.USER_GROWING_ARRAY_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.PUSH_PAYMENT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.PUSH_PAYMENT_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.GAS_HEAVY_OPERATIONS"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.GAS_HEAVY_OPERATIONS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.__init__"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.analyze"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.to_findings"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.to_findings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.detect_semantic_vulnerabilities"><code class="docutils literal notranslate"><span class="pre">detect_semantic_vulnerabilities()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#defi-patterns">DeFi Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#defi-vulnerability-pattern-detector">DeFi Vulnerability Pattern Detector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.FLASH_LOAN_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.FLASH_LOAN_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.SANDWICH_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.SANDWICH_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.GOVERNANCE_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.GOVERNANCE_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.BRIDGE_VULNERABILITY"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.BRIDGE_VULNERABILITY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.ORACLE_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.ORACLE_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.LIQUIDITY_DRAIN"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.LIQUIDITY_DRAIN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.PRICE_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.PRICE_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.REWARD_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.REWARD_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.FRONT_RUNNING"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.FRONT_RUNNING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.MEV_EXTRACTION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.MEV_EXTRACTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.DONATION_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.DONATION_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.INFLATION_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.INFLATION_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.READ_ONLY_REENTRANCY"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.READ_ONLY_REENTRANCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.ERC4626_INFLATION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.ERC4626_INFLATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.ARBITRARY_EXTERNAL_CALL"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.ARBITRARY_EXTERNAL_CALL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.PRECISION_LOSS"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.PRECISION_LOSS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.CROSS_FUNCTION_REENTRANCY"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.CROSS_FUNCTION_REENTRANCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.SIGNATURE_REPLAY"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.SIGNATURE_REPLAY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.FIRST_DEPOSITOR"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.FIRST_DEPOSITOR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.STORAGE_COLLISION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.STORAGE_COLLISION</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.vuln_type"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.vuln_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.name"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.severity"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.indicators"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.indicators</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.anti_patterns"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.anti_patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.description"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.attack_example"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.attack_example</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.real_exploits"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.real_exploits</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.remediation"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.remediation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.swc_id"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.estimated_loss_usd"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.estimated_loss_usd</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.__init__"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.pattern"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.pattern</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.matched_indicators"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.matched_indicators</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.matched_anti_patterns"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.matched_anti_patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.confidence"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.location"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.code_snippet"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.is_vulnerable"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.is_vulnerable</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.recommendation"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.__init__"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternDetector"><code class="docutils literal notranslate"><span class="pre">DeFiPatternDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternDetector.__init__"><code class="docutils literal notranslate"><span class="pre">DeFiPatternDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternDetector.analyze_code"><code class="docutils literal notranslate"><span class="pre">DeFiPatternDetector.analyze_code()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternDetector.get_pattern_info"><code class="docutils literal notranslate"><span class="pre">DeFiPatternDetector.get_pattern_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternDetector.get_all_patterns"><code class="docutils literal notranslate"><span class="pre">DeFiPatternDetector.get_all_patterns()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.detect_defi_vulnerabilities"><code class="docutils literal notranslate"><span class="pre">detect_defi_vulnerabilities()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#false-positive-classifier">False Positive Classifier</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#false-positive-classifier-for-miesc-v4-7-0">False Positive Classifier for MIESC v4.7.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory"><code class="docutils literal notranslate"><span class="pre">FeatureCategory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory.FINDING_METADATA"><code class="docutils literal notranslate"><span class="pre">FeatureCategory.FINDING_METADATA</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory.CODE_CONTEXT"><code class="docutils literal notranslate"><span class="pre">FeatureCategory.CODE_CONTEXT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory.SEMANTIC_GUARDS"><code class="docutils literal notranslate"><span class="pre">FeatureCategory.SEMANTIC_GUARDS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory.SOLIDITY_VERSION"><code class="docutils literal notranslate"><span class="pre">FeatureCategory.SOLIDITY_VERSION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory.CONTRACT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FeatureCategory.CONTRACT_PATTERNS</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures"><code class="docutils literal notranslate"><span class="pre">FindingFeatures</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.confidence"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.severity_score"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.severity_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.tool_count"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.tool_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_swc_id"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.line_count"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.line_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.function_complexity"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.function_complexity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_external_call"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_external_call</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_state_change"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_state_change</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_ether_transfer"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_ether_transfer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_require_check"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_require_check</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_modifier"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_modifier</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_reentrancy_guard"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_reentrancy_guard</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_access_control"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_access_control</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.follows_cei_pattern"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.follows_cei_pattern</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.is_solidity_08_plus"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.is_solidity_08_plus</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.uses_safemath"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.uses_safemath</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.is_proxy_contract"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.is_proxy_contract</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.is_upgradeable"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.is_upgradeable</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_initializer"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_initializer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.to_vector"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.to_vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.feature_names"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.feature_names()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.__init__"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction"><code class="docutils literal notranslate"><span class="pre">FPPrediction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.is_false_positive"><code class="docutils literal notranslate"><span class="pre">FPPrediction.is_false_positive</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.fp_probability"><code class="docutils literal notranslate"><span class="pre">FPPrediction.fp_probability</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.confidence"><code class="docutils literal notranslate"><span class="pre">FPPrediction.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.contributing_factors"><code class="docutils literal notranslate"><span class="pre">FPPrediction.contributing_factors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.adjusted_confidence"><code class="docutils literal notranslate"><span class="pre">FPPrediction.adjusted_confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.__init__"><code class="docutils literal notranslate"><span class="pre">FPPrediction.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.REENTRANCY_GUARD_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.REENTRANCY_GUARD_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.ACCESS_CONTROL_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.ACCESS_CONTROL_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.CEI_VIOLATION_PATTERN"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.CEI_VIOLATION_PATTERN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.EXTERNAL_CALL_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.EXTERNAL_CALL_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.STATE_CHANGE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.STATE_CHANGE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.extract_features"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.extract_features()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier"><code class="docutils literal notranslate"><span class="pre">FPClassifier</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier.FEATURE_WEIGHTS"><code class="docutils literal notranslate"><span class="pre">FPClassifier.FEATURE_WEIGHTS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier.VULN_TYPE_ADJUSTMENTS"><code class="docutils literal notranslate"><span class="pre">FPClassifier.VULN_TYPE_ADJUSTMENTS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier.__init__"><code class="docutils literal notranslate"><span class="pre">FPClassifier.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier.predict"><code class="docutils literal notranslate"><span class="pre">FPClassifier.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier.filter_findings"><code class="docutils literal notranslate"><span class="pre">FPClassifier.filter_findings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.classify_false_positives"><code class="docutils literal notranslate"><span class="pre">classify_false_positives()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.filter_likely_fps"><code class="docutils literal notranslate"><span class="pre">filter_likely_fps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#correlation-engine">Correlation Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelationMethod"><code class="docutils literal notranslate"><span class="pre">CorrelationMethod</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelationMethod.EXACT"><code class="docutils literal notranslate"><span class="pre">CorrelationMethod.EXACT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelationMethod.SEMANTIC"><code class="docutils literal notranslate"><span class="pre">CorrelationMethod.SEMANTIC</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelationMethod.CONTEXTUAL"><code class="docutils literal notranslate"><span class="pre">CorrelationMethod.CONTEXTUAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelationMethod.EMBEDDING"><code class="docutils literal notranslate"><span class="pre">CorrelationMethod.EMBEDDING</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain"><code class="docutils literal notranslate"><span class="pre">ExploitChain</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.id"><code class="docutils literal notranslate"><span class="pre">ExploitChain.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.name"><code class="docutils literal notranslate"><span class="pre">ExploitChain.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.description"><code class="docutils literal notranslate"><span class="pre">ExploitChain.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.severity"><code class="docutils literal notranslate"><span class="pre">ExploitChain.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.base_cvss"><code class="docutils literal notranslate"><span class="pre">ExploitChain.base_cvss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.vulnerabilities"><code class="docutils literal notranslate"><span class="pre">ExploitChain.vulnerabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.vuln_types"><code class="docutils literal notranslate"><span class="pre">ExploitChain.vuln_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.attack_vector"><code class="docutils literal notranslate"><span class="pre">ExploitChain.attack_vector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.exploitability_score"><code class="docutils literal notranslate"><span class="pre">ExploitChain.exploitability_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.impact_score"><code class="docutils literal notranslate"><span class="pre">ExploitChain.impact_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.complexity"><code class="docutils literal notranslate"><span class="pre">ExploitChain.complexity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.source_files"><code class="docutils literal notranslate"><span class="pre">ExploitChain.source_files</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.affected_functions"><code class="docutils literal notranslate"><span class="pre">ExploitChain.affected_functions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.to_dict"><code class="docutils literal notranslate"><span class="pre">ExploitChain.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.__init__"><code class="docutils literal notranslate"><span class="pre">ExploitChain.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile"><code class="docutils literal notranslate"><span class="pre">ToolProfile</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.name"><code class="docutils literal notranslate"><span class="pre">ToolProfile.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.precision_history"><code class="docutils literal notranslate"><span class="pre">ToolProfile.precision_history</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.recall_history"><code class="docutils literal notranslate"><span class="pre">ToolProfile.recall_history</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.false_positive_rate"><code class="docutils literal notranslate"><span class="pre">ToolProfile.false_positive_rate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.specialty_categories"><code class="docutils literal notranslate"><span class="pre">ToolProfile.specialty_categories</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.weakness_categories"><code class="docutils literal notranslate"><span class="pre">ToolProfile.weakness_categories</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.total_findings"><code class="docutils literal notranslate"><span class="pre">ToolProfile.total_findings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.confirmed_findings"><code class="docutils literal notranslate"><span class="pre">ToolProfile.confirmed_findings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.reliability_score"><code class="docutils literal notranslate"><span class="pre">ToolProfile.reliability_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.__init__"><code class="docutils literal notranslate"><span class="pre">ToolProfile.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.id"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.canonical_type"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.canonical_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.severity"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.message"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.message</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.location"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.swc_id"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.cwe_id"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.cwe_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.source_findings"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.source_findings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.confirming_tools"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.confirming_tools</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.correlation_method"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.correlation_method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.base_confidence"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.base_confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.tool_agreement_score"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.tool_agreement_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.context_score"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.context_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.ml_confidence"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.ml_confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.final_confidence"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.final_confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.is_cross_validated"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.is_cross_validated</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.false_positive_probability"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.false_positive_probability</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.remediation_priority"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.remediation_priority</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.to_dict"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.__init__"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.TOOL_WEIGHTS"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.TOOL_WEIGHTS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.DEFAULT_TOOL_PROFILES"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.DEFAULT_TOOL_PROFILES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.TYPE_NORMALIZATION"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.TYPE_NORMALIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.SEVERITY_WEIGHTS"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.SEVERITY_WEIGHTS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.CROSS_VALIDATION_REQUIRED"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.CROSS_VALIDATION_REQUIRED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.SINGLE_TOOL_MAX_CONFIDENCE"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.SINGLE_TOOL_MAX_CONFIDENCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.__init__"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.tool_profiles"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.tool_profiles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.add_findings"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.add_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.correlate"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.correlate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.calculate_weighted_confidence"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.calculate_weighted_confidence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_tool_weight"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_tool_weight()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.requires_cross_validation"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.requires_cross_validation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.apply_cross_validation_penalty"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.apply_cross_validation_penalty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_high_confidence_findings"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_high_confidence_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_cross_validated_findings"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_cross_validated_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_likely_true_positives"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_likely_true_positives()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_statistics"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_statistics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.to_report"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.to_report()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.update_tool_profile"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.update_tool_profile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.clear"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.clear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.deduplicate_findings"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.deduplicate_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_deduplication_stats"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_deduplication_stats()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.KNOWN_CHAINS"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.KNOWN_CHAINS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.__init__"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.analyze"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.get_critical_chains"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.get_critical_chains()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.get_high_impact_chains"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.get_high_impact_chains()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.get_summary"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.correlate_findings"><code class="docutils literal notranslate"><span class="pre">correlate_findings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#ml-pipeline">ML Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#fine-tuning">Fine-Tuning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#dataset-generator">Dataset Generator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.dataset_generator.VulnerabilityExample"><code class="docutils literal notranslate"><span class="pre">VulnerabilityExample</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.dataset_generator.TrainingExample"><code class="docutils literal notranslate"><span class="pre">TrainingExample</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.dataset_generator.SoliditySecurityDatasetGenerator"><code class="docutils literal notranslate"><span class="pre">SoliditySecurityDatasetGenerator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.dataset_generator.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#trainer">Trainer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.fine_tuning_trainer.TrainingConfig"><code class="docutils literal notranslate"><span class="pre">TrainingConfig</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.fine_tuning_trainer.SoliditySecurityTrainer"><code class="docutils literal notranslate"><span class="pre">SoliditySecurityTrainer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.fine_tuning_trainer.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Architecture</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/overview.html">Architecture Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/overview.html#system-architecture">System Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/overview.html#core-components">Core Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../architecture/overview.html#tool-adapters">Tool Adapters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../architecture/overview.html#agents">Agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../architecture/overview.html#orchestrator">Orchestrator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/overview.html#data-flow">Data Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/overview.html#finding-schema">Finding Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/overview.html#configuration">Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/layers.html">Security Layers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-overview">Layer Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-1-2-static-analysis">Layer 1-2: Static Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-3-symbolic-execution">Layer 3: Symbolic Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-4-fuzzing">Layer 4: Fuzzing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-5-formal-verification">Layer 5: Formal Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-6-ml-detection">Layer 6: ML Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-7-llm-analysis">Layer 7: LLM Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-8-defi-security">Layer 8: DeFi Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-9-advanced-detection">Layer 9: Advanced Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-selection">Layer Selection</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#development-workflow">Development Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#commit-convention">Commit Convention</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#code-style">Code Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#adding-a-new-adapter">Adding a New Adapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#testing">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#questions">Questions?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id1">[5.1.0] - 2026-02-10</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#added">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#changed">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id2">[5.1.0] - 2026-02-04</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id3">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#fixed">Fixed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id4">[5.0.0] - 2026-01-26</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id5">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id6">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id7">[4.2.0] - 2025-12-18</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id8">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id9">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id10">[4.0.0] - 2025-11-01</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id11">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id12">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id13">[3.0.0] - 2025-09-01</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id14">Added</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#initial-release">Initial Release</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MIESC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">src.llm.embedding_rag</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for src.llm.embedding_rag</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Embedding-based RAG for Vulnerability Analysis - MIESC v5.1.0</span>
<span class="sd">==============================================================</span>

<span class="sd">ChromaDB-powered semantic search for vulnerability knowledge base.</span>
<span class="sd">Uses sentence-transformers for embeddings and ChromaDB for vector storage.</span>

<span class="sd">Features:</span>
<span class="sd">- Semantic similarity search (not just keyword matching)</span>
<span class="sd">- Persistent vector database</span>
<span class="sd">- Hybrid retrieval (embeddings + BM25)</span>
<span class="sd">- Automatic knowledge base indexing</span>
<span class="sd">- Real-time context retrieval for LLM prompts</span>

<span class="sd">Author: Fernando Boiero &lt;fboiero@frvm.utn.edu.ar&gt;</span>
<span class="sd">Institution: UNDEF - IUA</span>
<span class="sd">Date: February 2026</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Lazy imports for optional dependencies</span>
<span class="n">_chromadb</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">_sentence_transformers</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_chromadb</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lazy import for chromadb.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_chromadb</span>
    <span class="k">if</span> <span class="n">_chromadb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">chromadb</span>

            <span class="n">_chromadb</span> <span class="o">=</span> <span class="n">chromadb</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                <span class="s2">&quot;ChromaDB is required for embedding RAG. &quot;</span> <span class="s2">&quot;Install with: pip install chromadb&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>
    <span class="k">return</span> <span class="n">_chromadb</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_sentence_transformer</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lazy import for sentence-transformers.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_sentence_transformers</span>
    <span class="k">if</span> <span class="n">_sentence_transformers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">sentence_transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SentenceTransformer</span>

            <span class="n">_sentence_transformers</span> <span class="o">=</span> <span class="n">SentenceTransformer</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                <span class="s2">&quot;sentence-transformers is required for embedding RAG. &quot;</span>
                <span class="s2">&quot;Install with: pip install sentence-transformers&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>
    <span class="k">return</span> <span class="n">_sentence_transformers</span>


<span class="c1"># =============================================================================</span>
<span class="c1"># DATA STRUCTURES</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="VulnerabilityDocument">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">VulnerabilityDocument</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A vulnerability document for the knowledge base.&quot;&quot;&quot;</span>

    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">swc_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">cwe_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">vulnerable_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">fixed_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">attack_scenario</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;medium&quot;</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;general&quot;</span>
    <span class="n">real_exploit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">tags</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">references</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

<div class="viewcode-block" id="VulnerabilityDocument.to_text">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.to_text">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to searchable text representation.&quot;&quot;&quot;</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;Title: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Category: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Severity: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Description: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">swc_id</span><span class="p">:</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SWC: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">swc_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwe_id</span><span class="p">:</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CWE: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cwe_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vulnerable_code</span><span class="p">:</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vulnerable Code Pattern:</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vulnerable_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_scenario</span><span class="p">:</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attack Scenario: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_scenario</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tags: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span></div>


<div class="viewcode-block" id="VulnerabilityDocument.to_metadata">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.to_metadata">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to ChromaDB metadata format.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;swc_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">swc_id</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cwe_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwe_id</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
            <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">severity</span><span class="p">,</span>
            <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
            <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">),</span>
            <span class="s2">&quot;has_exploit&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_exploit</span><span class="p">),</span>
            <span class="s2">&quot;has_fix&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_code</span><span class="p">),</span>
        <span class="p">}</span></div>
</div>



<div class="viewcode-block" id="RetrievalResult">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RetrievalResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Result from semantic search.&quot;&quot;&quot;</span>

    <span class="n">document</span><span class="p">:</span> <span class="n">VulnerabilityDocument</span>
    <span class="n">similarity_score</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">relevance_reason</span><span class="p">:</span> <span class="nb">str</span>

<div class="viewcode-block" id="RetrievalResult.to_context">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult.to_context">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to LLM context string.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;**</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">** (Score: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">similarity_score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;- Category: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">category</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;- Severity: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;- Description: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">description</span><span class="p">[:</span><span class="mi">300</span><span class="p">]</span><span class="si">}</span><span class="s2">...</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;- Relevance: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">relevance_reason</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;- Real Exploit: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">real_exploit</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span></div>
</div>



<span class="c1"># =============================================================================</span>
<span class="c1"># KNOWLEDGE BASE - SWC Registry + DeFi + Advanced Patterns</span>
<span class="c1"># =============================================================================</span>

<span class="n">VULNERABILITY_KNOWLEDGE_BASE</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">VulnerabilityDocument</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># SWC-107: Reentrancy</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-107&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-107&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-841&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Reentrancy&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;One of the major dangers of calling external contracts is that they can &quot;</span>
            <span class="s2">&quot;take over the control flow. In the reentrancy attack, a malicious contract &quot;</span>
            <span class="s2">&quot;calls back into the calling contract before the first invocation of the &quot;</span>
            <span class="s2">&quot;function is finished. This can lead to unexpected state changes and fund drainage.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function withdraw(uint256 _amount) public {</span>
<span class="s2">    require(balances[msg.sender] &gt;= _amount);</span>
<span class="s2">    (bool success,) = msg.sender.call{value: _amount}(&quot;&quot;);</span>
<span class="s2">    require(success);</span>
<span class="s2">    balances[msg.sender] -= _amount;  // State update AFTER external call - VULNERABLE</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function withdraw(uint256 _amount) public nonReentrant {</span>
<span class="s2">    require(balances[msg.sender] &gt;= _amount);</span>
<span class="s2">    balances[msg.sender] -= _amount;  // State update BEFORE external call</span>
<span class="s2">    (bool success,) = msg.sender.call{value: _amount}(&quot;&quot;);</span>
<span class="s2">    require(success);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker deploys malicious contract with receive() that calls withdraw() again. &quot;</span>
            <span class="s2">&quot;2. Attacker calls withdraw() with legitimate balance. &quot;</span>
            <span class="s2">&quot;3. ETH is sent, triggering attacker&#39;s receive(). &quot;</span>
            <span class="s2">&quot;4. receive() calls withdraw() again - balance not yet updated. &quot;</span>
            <span class="s2">&quot;5. Repeat until contract is drained.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;The DAO Hack - $60M stolen (2016)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span>
            <span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span>
            <span class="s2">&quot;external-call&quot;</span><span class="p">,</span>
            <span class="s2">&quot;state-update&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cef-pattern&quot;</span><span class="p">,</span>
            <span class="s2">&quot;checks-effects-interactions&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-107 Variant: Cross-function Reentrancy</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;CROSS-FUNC-REENTRANCY&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-107&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-841&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Cross-function Reentrancy&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;A more subtle form of reentrancy where the attacker re-enters through a different &quot;</span>
            <span class="s2">&quot;function that shares state with the vulnerable function. The two functions may &quot;</span>
            <span class="s2">&quot;individually appear safe but their interaction creates a vulnerability.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">mapping(address =&gt; uint) public balances;</span>

<span class="s2">function transfer(address to, uint amount) public {</span>
<span class="s2">    if (balances[msg.sender] &gt;= amount) {</span>
<span class="s2">        balances[to] += amount;</span>
<span class="s2">        balances[msg.sender] -= amount;</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">function withdraw() public {</span>
<span class="s2">    uint amount = balances[msg.sender];</span>
<span class="s2">    (bool success,) = msg.sender.call{value: amount}(&quot;&quot;);  // Reentrancy point</span>
<span class="s2">    require(success);</span>
<span class="s2">    balances[msg.sender] = 0;</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function withdraw() public nonReentrant {</span>
<span class="s2">    uint amount = balances[msg.sender];</span>
<span class="s2">    balances[msg.sender] = 0;  // Update state first</span>
<span class="s2">    (bool success,) = msg.sender.call{value: amount}(&quot;&quot;);</span>
<span class="s2">    require(success);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker has balance in contract. &quot;</span>
            <span class="s2">&quot;2. Attacker calls withdraw(). &quot;</span>
            <span class="s2">&quot;3. In receive(), attacker calls transfer() to move balance to another address. &quot;</span>
            <span class="s2">&quot;4. Original balance not yet zeroed, so transfer succeeds. &quot;</span>
            <span class="s2">&quot;5. Attacker now has double the funds.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple DeFi hacks use this pattern&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span> <span class="s2">&quot;cross-function&quot;</span><span class="p">,</span> <span class="s2">&quot;state-sharing&quot;</span><span class="p">,</span> <span class="s2">&quot;multi-function&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-107 Variant: Read-only Reentrancy</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;READ-ONLY-REENTRANCY&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-107&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-841&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Read-only Reentrancy&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;A reentrancy attack where the attacker exploits a view function that reads stale &quot;</span>
            <span class="s2">&quot;state during an external call. Even though the view function doesn&#39;t modify state, &quot;</span>
            <span class="s2">&quot;it can be used to manipulate other contracts that rely on accurate price/balance data.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Vulnerable Oracle</span>
<span class="s2">function getPrice() public view returns (uint256) {</span>
<span class="s2">    return totalValue / totalShares;  // Can be manipulated during callback</span>
<span class="s2">}</span>

<span class="s2">// Victim Protocol using the oracle</span>
<span class="s2">function borrow(uint256 amount) external {</span>
<span class="s2">    uint256 collateralValue = oracle.getPrice() * collateral[msg.sender];</span>
<span class="s2">    require(collateralValue &gt;= amount * 150 / 100);  // 150</span><span class="si">% c</span><span class="s2">ollateralization</span>
<span class="s2">    // ... proceed with borrow</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Use reentrancy guards on state-changing functions</span>
<span class="s2">// Use TWAP (Time-Weighted Average Price) for oracles</span>
<span class="s2">// Add staleness checks and manipulation detection</span>
<span class="s2">function getPrice() public view returns (uint256) {</span>
<span class="s2">    require(block.timestamp - lastUpdate &lt; MAX_STALENESS);</span>
<span class="s2">    return twapPrice;  // Use TWAP instead of spot price</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker triggers callback in pool during withdraw. &quot;</span>
            <span class="s2">&quot;2. During callback, pool&#39;s totalValue is reduced but totalShares not yet. &quot;</span>
            <span class="s2">&quot;3. getPrice() returns stale (inflated) value. &quot;</span>
            <span class="s2">&quot;4. Attacker borrows more than they should from victim protocol. &quot;</span>
            <span class="s2">&quot;5. Callback completes, price updates, attacker profits.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Curve/Vyper Read-only Reentrancy - $70M (2023)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span> <span class="s2">&quot;read-only&quot;</span><span class="p">,</span> <span class="s2">&quot;oracle&quot;</span><span class="p">,</span> <span class="s2">&quot;view-function&quot;</span><span class="p">,</span> <span class="s2">&quot;defi&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-105: Unprotected Ether Withdrawal</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-105&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-105&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-284&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Unprotected Ether Withdrawal&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Due to missing or insufficient access controls, malicious parties can &quot;</span>
            <span class="s2">&quot;withdraw some or all Ether from the contract account. Functions that send &quot;</span>
            <span class="s2">&quot;ETH must have proper authorization checks.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function withdrawAll() public {</span>
<span class="s2">    // No access control - anyone can call!</span>
<span class="s2">    payable(msg.sender).transfer(address(this).balance);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function withdrawAll() public onlyOwner {</span>
<span class="s2">    payable(msg.sender).transfer(address(this).balance);</span>
<span class="s2">}</span>

<span class="s2">// Or use OpenZeppelin Ownable</span>
<span class="s2">import &quot;@openzeppelin/contracts/access/Ownable.sol&quot;;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker finds contract with unprotected withdraw function. &quot;</span>
            <span class="s2">&quot;2. Attacker calls withdrawAll(). &quot;</span>
            <span class="s2">&quot;3. All ETH in contract sent to attacker. &quot;</span>
            <span class="s2">&quot;4. Contract is drained.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;access-control&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Parity Multisig Hack - $150M frozen (2017)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;access-control&quot;</span><span class="p">,</span> <span class="s2">&quot;withdrawal&quot;</span><span class="p">,</span> <span class="s2">&quot;authorization&quot;</span><span class="p">,</span> <span class="s2">&quot;missing-modifier&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-115: tx.origin Authentication</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-115&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-115&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-477&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Authorization through tx.origin&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;tx.origin returns the address that originated the transaction chain. &quot;</span>
            <span class="s2">&quot;Using it for authorization is dangerous because if the legitimate owner &quot;</span>
            <span class="s2">&quot;interacts with a malicious contract, that contract can call back and &quot;</span>
            <span class="s2">&quot;pass the tx.origin check.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function transferTo(address payable dest, uint amount) public {</span>
<span class="s2">    require(tx.origin == owner);  // DANGEROUS: uses tx.origin</span>
<span class="s2">    dest.transfer(amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function transferTo(address payable dest, uint amount) public {</span>
<span class="s2">    require(msg.sender == owner);  // SAFE: uses msg.sender</span>
<span class="s2">    dest.transfer(amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Owner interacts with malicious contract (e.g., fake airdrop). &quot;</span>
            <span class="s2">&quot;2. Malicious contract calls victim.transferTo(attacker, balance). &quot;</span>
            <span class="s2">&quot;3. tx.origin is still the owner (original transaction sender). &quot;</span>
            <span class="s2">&quot;4. Check passes, funds sent to attacker.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;access-control&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Common phishing vector in DeFi&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tx-origin&quot;</span><span class="p">,</span> <span class="s2">&quot;phishing&quot;</span><span class="p">,</span> <span class="s2">&quot;authorization&quot;</span><span class="p">,</span> <span class="s2">&quot;msg-sender&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-104: Unchecked Call Return Value</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-104&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-104&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-252&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Unchecked Call Return Value&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;The return value of low-level calls (call, send, delegatecall) must be checked. &quot;</span>
            <span class="s2">&quot;If not checked, execution continues even if the call failed, leading to &quot;</span>
            <span class="s2">&quot;inconsistent state and potential fund loss.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function sendEther(address payable _to, uint256 _amount) public {</span>
<span class="s2">    _to.call{value: _amount}(&quot;&quot;);  // Return value not checked!</span>
<span class="s2">    // Continues even if call fails</span>
<span class="s2">    balances[msg.sender] -= _amount;  // Balance decremented but ETH not sent</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function sendEther(address payable _to, uint256 _amount) public {</span>
<span class="s2">    (bool success,) = _to.call{value: _amount}(&quot;&quot;);</span>
<span class="s2">    require(success, &quot;Transfer failed&quot;);</span>
<span class="s2">    balances[msg.sender] -= _amount;</span>
<span class="s2">}</span>

<span class="s2">// Or use OpenZeppelin&#39;s Address library</span>
<span class="s2">import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
<span class="s2">Address.sendValue(_to, _amount);</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. User calls sendEther() to transfer funds. &quot;</span>
            <span class="s2">&quot;2. External call fails (recipient rejects or out of gas). &quot;</span>
            <span class="s2">&quot;3. Return value not checked, execution continues. &quot;</span>
            <span class="s2">&quot;4. User&#39;s balance decremented but ETH never sent. &quot;</span>
            <span class="s2">&quot;5. Funds effectively lost/locked.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;unchecked-call&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;unchecked-return&quot;</span><span class="p">,</span> <span class="s2">&quot;low-level-call&quot;</span><span class="p">,</span> <span class="s2">&quot;error-handling&quot;</span><span class="p">,</span> <span class="s2">&quot;send&quot;</span><span class="p">,</span> <span class="s2">&quot;call&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-101: Integer Overflow/Underflow</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-101&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-101&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-190&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Integer Overflow and Underflow&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Integer overflow occurs when an arithmetic operation exceeds the maximum value &quot;</span>
            <span class="s2">&quot;for that type (wraps to 0). Underflow is the opposite (wraps to max value). &quot;</span>
            <span class="s2">&quot;Solidity 0.8.0+ has built-in overflow checks, but unchecked blocks and older &quot;</span>
            <span class="s2">&quot;versions are still vulnerable.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Solidity &lt; 0.8.0 - No built-in checks</span>
<span class="s2">function transfer(address _to, uint256 _amount) public {</span>
<span class="s2">    require(balances[msg.sender] &gt;= _amount);</span>
<span class="s2">    balances[msg.sender] -= _amount;  // Can underflow if already 0</span>
<span class="s2">    balances[_to] += _amount;  // Can overflow to 0</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Solidity 0.8.0+: Built-in overflow checks (reverts on overflow)</span>

<span class="s2">// For older versions, use SafeMath:</span>
<span class="s2">using SafeMath for uint256;</span>
<span class="s2">function transfer(address _to, uint256 _amount) public {</span>
<span class="s2">    require(balances[msg.sender] &gt;= _amount);</span>
<span class="s2">    balances[msg.sender] = balances[msg.sender].sub(_amount);</span>
<span class="s2">    balances[_to] = balances[_to].add(_amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker has 0 tokens but exploits underflow. &quot;</span>
            <span class="s2">&quot;2. Calls transfer with amount &gt; 0. &quot;</span>
            <span class="s2">&quot;3. Balance wraps: 0 - 1 = 2^256 - 1 (max uint). &quot;</span>
            <span class="s2">&quot;4. Attacker now has essentially unlimited tokens.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;arithmetic&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;BEC Token - $900M theoretical (2018)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;overflow&quot;</span><span class="p">,</span> <span class="s2">&quot;underflow&quot;</span><span class="p">,</span> <span class="s2">&quot;arithmetic&quot;</span><span class="p">,</span> <span class="s2">&quot;safemath&quot;</span><span class="p">,</span> <span class="s2">&quot;solidity-version&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-112: Delegatecall to Untrusted Callee</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-112&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-112&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-829&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Delegatecall to Untrusted Callee&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;delegatecall executes code in another contract using the calling contract&#39;s &quot;</span>
            <span class="s2">&quot;storage and context. If the target is controlled by an attacker, they can &quot;</span>
            <span class="s2">&quot;modify any storage slot, including owner addresses and balances.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function execute(address _target, bytes memory _data) public {</span>
<span class="s2">    // DANGEROUS: delegatecall to arbitrary address</span>
<span class="s2">    _target.delegatecall(_data);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">mapping(address =&gt; bool) public allowedTargets;</span>

<span class="s2">function execute(address _target, bytes memory _data) public onlyOwner {</span>
<span class="s2">    require(allowedTargets[_target], &quot;Target not allowed&quot;);</span>
<span class="s2">    (bool success,) = _target.delegatecall(_data);</span>
<span class="s2">    require(success, &quot;Delegatecall failed&quot;);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker deploys malicious implementation contract. &quot;</span>
            <span class="s2">&quot;2. Attacker calls execute() with malicious target. &quot;</span>
            <span class="s2">&quot;3. delegatecall runs attacker&#39;s code with victim&#39;s storage. &quot;</span>
            <span class="s2">&quot;4. Attacker overwrites owner slot or drains funds.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;delegatecall&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Parity Wallet Hack - $30M (2017)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;delegatecall&quot;</span><span class="p">,</span> <span class="s2">&quot;proxy&quot;</span><span class="p">,</span> <span class="s2">&quot;code-injection&quot;</span><span class="p">,</span> <span class="s2">&quot;storage-manipulation&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Flash Loan Attack Pattern</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;FLASH-LOAN-ATTACK&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-682&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Flash Loan Attack&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Flash loans allow borrowing large amounts without collateral, as long as &quot;</span>
            <span class="s2">&quot;the loan is repaid within the same transaction. Attackers use this to &quot;</span>
            <span class="s2">&quot;temporarily manipulate prices, governance, or exploit arithmetic assumptions.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function getPrice() public view returns (uint256) {</span>
<span class="s2">    // Spot price from AMM - can be manipulated with flash loan</span>
<span class="s2">    return reserve1 / reserve0;</span>
<span class="s2">}</span>

<span class="s2">function borrow(uint256 amount) external {</span>
<span class="s2">    uint256 collateralValue = getPrice() * collateral[msg.sender];</span>
<span class="s2">    require(collateralValue &gt;= amount * 150 / 100);</span>
<span class="s2">    // Borrow proceeds...</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Use TWAP (Time-Weighted Average Price)</span>
<span class="s2">function getPrice() public view returns (uint256) {</span>
<span class="s2">    return priceCumulativeLast / timeElapsed;</span>
<span class="s2">}</span>

<span class="s2">// Or use Chainlink oracle</span>
<span class="s2">function getPrice() public view returns (uint256) {</span>
<span class="s2">    (, int256 price,,,) = priceFeed.latestRoundData();</span>
<span class="s2">    return uint256(price);</span>
<span class="s2">}</span>

<span class="s2">// Add flash loan protection</span>
<span class="s2">modifier noFlashLoan() {</span>
<span class="s2">    require(block.number &gt; lastActionBlock[msg.sender], &quot;Same block&quot;);</span>
<span class="s2">    lastActionBlock[msg.sender] = block.number;</span>
<span class="s2">    _;</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker takes $100M flash loan from Aave/dYdX. &quot;</span>
            <span class="s2">&quot;2. Swaps large amount in AMM, manipulating price. &quot;</span>
            <span class="s2">&quot;3. Exploits victim protocol relying on spot price. &quot;</span>
            <span class="s2">&quot;4. Swaps back, extracting profit. &quot;</span>
            <span class="s2">&quot;5. Repays flash loan + fee in same transaction.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;flash-loan&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;bZx Flash Loan Attack - $350K (2020), Cream Finance - $130M (2021)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;flash-loan&quot;</span><span class="p">,</span> <span class="s2">&quot;price-manipulation&quot;</span><span class="p">,</span> <span class="s2">&quot;oracle&quot;</span><span class="p">,</span> <span class="s2">&quot;defi&quot;</span><span class="p">,</span> <span class="s2">&quot;arbitrage&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Oracle Manipulation</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;ORACLE-MANIPULATION&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-682&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Price Oracle Manipulation&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Protocols relying on on-chain price oracles (especially AMM spot prices) &quot;</span>
            <span class="s2">&quot;are vulnerable to manipulation. Attackers can use flash loans or large &quot;</span>
            <span class="s2">&quot;trades to temporarily move prices and exploit dependent protocols.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Vulnerable: Using Uniswap spot price</span>
<span class="s2">function getTokenPrice() public view returns (uint256) {</span>
<span class="s2">    (uint112 reserve0, uint112 reserve1,) = uniswapPair.getReserves();</span>
<span class="s2">    return (reserve1 * 1e18) / reserve0;</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Use Chainlink oracle</span>
<span class="s2">import &quot;@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol&quot;;</span>

<span class="s2">function getTokenPrice() public view returns (uint256) {</span>
<span class="s2">    (, int256 price,, uint256 updatedAt,) = priceFeed.latestRoundData();</span>
<span class="s2">    require(block.timestamp - updatedAt &lt; MAX_STALENESS, &quot;Stale price&quot;);</span>
<span class="s2">    require(price &gt; 0, &quot;Invalid price&quot;);</span>
<span class="s2">    return uint256(price);</span>
<span class="s2">}</span>

<span class="s2">// Or use TWAP from Uniswap V3</span>
<span class="s2">function getTWAP() public view returns (uint256) {</span>
<span class="s2">    (int24 tick,) = oracle.observe([TWAP_PERIOD, 0]);</span>
<span class="s2">    return OracleLibrary.getQuoteAtTick(tick, amount, token0, token1);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker identifies protocol using AMM spot price. &quot;</span>
            <span class="s2">&quot;2. Takes flash loan and trades heavily in AMM. &quot;</span>
            <span class="s2">&quot;3. Price moves significantly (e.g., 10x). &quot;</span>
            <span class="s2">&quot;4. Exploits protocol (borrow at inflated collateral, liquidate at deflated price). &quot;</span>
            <span class="s2">&quot;5. Trades back and repays flash loan with profit.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;oracle&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Harvest Finance - $34M (2020), Mango Markets - $114M (2022)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;oracle&quot;</span><span class="p">,</span> <span class="s2">&quot;price-manipulation&quot;</span><span class="p">,</span> <span class="s2">&quot;flash-loan&quot;</span><span class="p">,</span> <span class="s2">&quot;twap&quot;</span><span class="p">,</span> <span class="s2">&quot;chainlink&quot;</span><span class="p">,</span> <span class="s2">&quot;defi&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Frontrunning / Sandwich Attack</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SANDWICH-ATTACK&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-362&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Sandwich Attack / Frontrunning&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;MEV (Maximal Extractable Value) attacks where a malicious actor sees a pending &quot;</span>
            <span class="s2">&quot;transaction and places their own transactions before and after it. In a sandwich &quot;</span>
            <span class="s2">&quot;attack, they buy before a large swap, let the victim&#39;s swap push the price up, &quot;</span>
            <span class="s2">&quot;then sell at the higher price.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function swap(uint256 amountIn) external {</span>
<span class="s2">    // No slippage protection - vulnerable to sandwich</span>
<span class="s2">    uint256 amountOut = getAmountOut(amountIn);</span>
<span class="s2">    token.transferFrom(msg.sender, address(this), amountIn);</span>
<span class="s2">    otherToken.transfer(msg.sender, amountOut);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function swap(uint256 amountIn, uint256 minAmountOut, uint256 deadline) external {</span>
<span class="s2">    require(block.timestamp &lt;= deadline, &quot;Transaction expired&quot;);</span>
<span class="s2">    uint256 amountOut = getAmountOut(amountIn);</span>
<span class="s2">    require(amountOut &gt;= minAmountOut, &quot;Slippage too high&quot;);  // Slippage protection</span>
<span class="s2">    token.transferFrom(msg.sender, address(this), amountIn);</span>
<span class="s2">    otherToken.transfer(msg.sender, amountOut);</span>
<span class="s2">}</span>

<span class="s2">// Or use private transaction services (Flashbots Protect)</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Victim submits swap for 100 ETH -&gt; USDC. &quot;</span>
            <span class="s2">&quot;2. Attacker sees pending tx in mempool. &quot;</span>
            <span class="s2">&quot;3. Attacker frontrun: buys USDC, pushing price up. &quot;</span>
            <span class="s2">&quot;4. Victim&#39;s tx executes at worse price. &quot;</span>
            <span class="s2">&quot;5. Attacker backruns: sells USDC at higher price.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;mev&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Common MEV extraction, estimated $1B+ annually&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;frontrunning&quot;</span><span class="p">,</span> <span class="s2">&quot;sandwich&quot;</span><span class="p">,</span> <span class="s2">&quot;slippage&quot;</span><span class="p">,</span> <span class="s2">&quot;deadline&quot;</span><span class="p">,</span> <span class="s2">&quot;mempool&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Governance Flash Loan Attack</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;GOVERNANCE-FLASH-LOAN&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-284&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Flash Loan Governance Attack&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Governance systems that use token balances at transaction time (spot voting) &quot;</span>
            <span class="s2">&quot;can be attacked with flash loans. An attacker can borrow tokens, vote, &quot;</span>
            <span class="s2">&quot;execute malicious proposal, and repay in same transaction.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function castVote(uint256 proposalId, bool support) external {</span>
<span class="s2">    // VULNERABLE: Uses current balance</span>
<span class="s2">    uint256 votes = token.balanceOf(msg.sender);</span>
<span class="s2">    proposals[proposalId].votes += support ? int256(votes) : -int256(votes);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Use checkpoints (snapshots) for voting power</span>
<span class="s2">function castVote(uint256 proposalId, bool support) external {</span>
<span class="s2">    Proposal storage proposal = proposals[proposalId];</span>
<span class="s2">    // Uses balance at snapshot block, before proposal was created</span>
<span class="s2">    uint256 votes = token.getPastVotes(msg.sender, proposal.snapshotBlock);</span>
<span class="s2">    require(votes &gt; 0, &quot;No voting power at snapshot&quot;);</span>
<span class="s2">    proposal.votes += support ? int256(votes) : -int256(votes);</span>
<span class="s2">}</span>

<span class="s2">// OpenZeppelin ERC20Votes provides this functionality</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker creates malicious proposal (e.g., drain treasury). &quot;</span>
            <span class="s2">&quot;2. Takes flash loan of governance tokens. &quot;</span>
            <span class="s2">&quot;3. Votes to pass proposal (now has majority). &quot;</span>
            <span class="s2">&quot;4. Executes proposal immediately (if no timelock). &quot;</span>
            <span class="s2">&quot;5. Repays flash loan, keeps stolen funds.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Beanstalk - $182M (2022)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;flash-loan&quot;</span><span class="p">,</span> <span class="s2">&quot;voting&quot;</span><span class="p">,</span> <span class="s2">&quot;snapshot&quot;</span><span class="p">,</span> <span class="s2">&quot;checkpoint&quot;</span><span class="p">,</span> <span class="s2">&quot;defi&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Proxy Storage Collision</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;PROXY-STORAGE-COLLISION&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-112&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-820&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Proxy Storage Collision&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Upgradeable proxy contracts can suffer from storage collisions if the proxy &quot;</span>
            <span class="s2">&quot;and implementation contracts share storage slots. The implementation&#39;s variables &quot;</span>
            <span class="s2">&quot;can overwrite critical proxy data like the admin address.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Proxy contract</span>
<span class="s2">contract Proxy {</span>
<span class="s2">    address public implementation;  // Slot 0</span>
<span class="s2">    address public admin;           // Slot 1</span>

<span class="s2">    function upgradeTo(address newImpl) public {</span>
<span class="s2">        require(msg.sender == admin);</span>
<span class="s2">        implementation = newImpl;</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Implementation contract</span>
<span class="s2">contract Implementation {</span>
<span class="s2">    uint256 public value;  // Slot 0 - COLLIDES with implementation address!</span>
<span class="s2">    address public owner;  // Slot 1 - COLLIDES with admin!</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Use EIP-1967 storage slots</span>
<span class="s2">contract Proxy {</span>
<span class="s2">    // Slot: keccak256(&quot;eip1967.proxy.implementation&quot;) - 1</span>
<span class="s2">    bytes32 constant IMPLEMENTATION_SLOT = 0x360894...;</span>
<span class="s2">    bytes32 constant ADMIN_SLOT = 0xb53127...;</span>

<span class="s2">    function _getImplementation() internal view returns (address) {</span>
<span class="s2">        return StorageSlot.getAddressSlot(IMPLEMENTATION_SLOT).value;</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Use OpenZeppelin TransparentUpgradeableProxy or UUPS</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Developer deploys proxy with admin at slot 1. &quot;</span>
            <span class="s2">&quot;2. Implementation&#39;s first variable maps to slot 0 (implementation address). &quot;</span>
            <span class="s2">&quot;3. If implementation&#39;s second variable is address type, it maps to slot 1. &quot;</span>
            <span class="s2">&quot;4. Setting owner in implementation overwrites proxy admin. &quot;</span>
            <span class="s2">&quot;5. Attacker can now upgrade proxy to malicious implementation.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;proxy&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple proxy-related hacks including Wormhole&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;proxy&quot;</span><span class="p">,</span> <span class="s2">&quot;storage-collision&quot;</span><span class="p">,</span> <span class="s2">&quot;upgradeable&quot;</span><span class="p">,</span> <span class="s2">&quot;eip-1967&quot;</span><span class="p">,</span> <span class="s2">&quot;delegatecall&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Signature Replay Attack</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SIGNATURE-REPLAY&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-121&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-294&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Signature Replay Attack&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Signed messages that don&#39;t include proper replay protection (nonce, chainId, &quot;</span>
            <span class="s2">&quot;contract address) can be reused across transactions, chains, or contracts. &quot;</span>
            <span class="s2">&quot;This allows attackers to replay valid signatures in unintended contexts.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function executeWithSig(</span>
<span class="s2">    address to,</span>
<span class="s2">    uint256 amount,</span>
<span class="s2">    bytes memory signature</span>
<span class="s2">) external {</span>
<span class="s2">    bytes32 hash = keccak256(abi.encodePacked(to, amount));</span>
<span class="s2">    address signer = recoverSigner(hash, signature);</span>
<span class="s2">    require(signer == owner, &quot;Invalid signature&quot;);</span>
<span class="s2">    // No nonce check - signature can be replayed!</span>
<span class="s2">    token.transfer(to, amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">mapping(address =&gt; uint256) public nonces;</span>

<span class="s2">function executeWithSig(</span>
<span class="s2">    address to,</span>
<span class="s2">    uint256 amount,</span>
<span class="s2">    uint256 nonce,</span>
<span class="s2">    uint256 deadline,</span>
<span class="s2">    bytes memory signature</span>
<span class="s2">) external {</span>
<span class="s2">    require(block.timestamp &lt;= deadline, &quot;Expired&quot;);</span>
<span class="s2">    require(nonce == nonces[owner]++, &quot;Invalid nonce&quot;);</span>

<span class="s2">    bytes32 hash = keccak256(abi.encodePacked(</span>
<span class="s2">        address(this),  // Contract address</span>
<span class="s2">        block.chainid,  // Chain ID</span>
<span class="s2">        to, amount, nonce, deadline</span>
<span class="s2">    ));</span>
<span class="s2">    address signer = recoverSigner(hash, signature);</span>
<span class="s2">    require(signer == owner, &quot;Invalid signature&quot;);</span>
<span class="s2">    token.transfer(to, amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. User signs message to transfer 100 tokens. &quot;</span>
            <span class="s2">&quot;2. Transaction executes successfully. &quot;</span>
            <span class="s2">&quot;3. Attacker captures the signature. &quot;</span>
            <span class="s2">&quot;4. Attacker replays same signature (no nonce protection). &quot;</span>
            <span class="s2">&quot;5. Another 100 tokens transferred. Repeat until drained.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;cryptography&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Wintermute - $160M (2022, related to signature vulnerability)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;signature&quot;</span><span class="p">,</span> <span class="s2">&quot;replay&quot;</span><span class="p">,</span> <span class="s2">&quot;nonce&quot;</span><span class="p">,</span> <span class="s2">&quot;ecrecover&quot;</span><span class="p">,</span> <span class="s2">&quot;eip-712&quot;</span><span class="p">,</span> <span class="s2">&quot;chainid&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Denial of Service - Gas Limit</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;DOS-GAS-LIMIT&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-128&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-400&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;DoS with Block Gas Limit&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Functions that iterate over unbounded arrays can exceed the block gas limit, &quot;</span>
            <span class="s2">&quot;making them impossible to execute. Attackers can intentionally grow arrays &quot;</span>
            <span class="s2">&quot;to cause permanent denial of service.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">address[] public recipients;</span>

<span class="s2">function distributeRewards() external {</span>
<span class="s2">    uint256 reward = address(this).balance / recipients.length;</span>
<span class="s2">    // VULNERABLE: Unbounded loop</span>
<span class="s2">    for (uint256 i = 0; i &lt; recipients.length; i++) {</span>
<span class="s2">        payable(recipients[i]).transfer(reward);</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Pull pattern - users withdraw themselves</span>
<span class="s2">mapping(address =&gt; uint256) public pendingRewards;</span>

<span class="s2">function distributeRewards(uint256 startIdx, uint256 batchSize) external {</span>
<span class="s2">    uint256 endIdx = min(startIdx + batchSize, recipients.length);</span>
<span class="s2">    uint256 reward = address(this).balance / recipients.length;</span>
<span class="s2">    for (uint256 i = startIdx; i &lt; endIdx; i++) {</span>
<span class="s2">        pendingRewards[recipients[i]] += reward;</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">function claimReward() external {</span>
<span class="s2">    uint256 reward = pendingRewards[msg.sender];</span>
<span class="s2">    pendingRewards[msg.sender] = 0;</span>
<span class="s2">    payable(msg.sender).transfer(reward);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker adds many addresses to recipients array. &quot;</span>
            <span class="s2">&quot;2. distributeRewards() now requires too much gas. &quot;</span>
            <span class="s2">&quot;3. Block gas limit exceeded - transaction always fails. &quot;</span>
            <span class="s2">&quot;4. No one can ever distribute or receive rewards.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;denial-of-service&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;GovernMental - locked funds forever (2016)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dos&quot;</span><span class="p">,</span> <span class="s2">&quot;gas-limit&quot;</span><span class="p">,</span> <span class="s2">&quot;unbounded-loop&quot;</span><span class="p">,</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span> <span class="s2">&quot;pull-pattern&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Uninitialized Storage Pointer</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-109&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-109&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-824&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Uninitialized Storage Pointer&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;In older Solidity versions (&lt; 0.5.0), local storage variables that are not &quot;</span>
            <span class="s2">&quot;initialized point to storage slot 0 by default. This can lead to accidental &quot;</span>
            <span class="s2">&quot;overwriting of state variables.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Solidity &lt; 0.5.0</span>
<span class="s2">contract Vulnerable {</span>
<span class="s2">    uint256 public secretData;</span>

<span class="s2">    function modifyData() public {</span>
<span class="s2">        MyStruct data;  // VULNERABLE: Uninitialized storage pointer</span>
<span class="s2">        data.value = 123;  // Overwrites slot 0 (secretData)!</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Solidity 0.5.0+: Compilation error for uninitialized storage</span>
<span class="s2">// Or explicitly use memory:</span>
<span class="s2">function modifyData() public {</span>
<span class="s2">    MyStruct memory data = MyStruct(123);  // Use memory</span>
<span class="s2">    // or</span>
<span class="s2">    MyStruct storage data = myStorageStruct;  // Explicit storage reference</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Contract stores owner address in slot 0. &quot;</span>
            <span class="s2">&quot;2. Function uses uninitialized local storage variable. &quot;</span>
            <span class="s2">&quot;3. Attacker triggers function with crafted input. &quot;</span>
            <span class="s2">&quot;4. Storage slot 0 overwritten with attacker&#39;s address. &quot;</span>
            <span class="s2">&quot;5. Attacker is now the owner.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;storage&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;OpenAddressLottery (2017)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;storage&quot;</span><span class="p">,</span> <span class="s2">&quot;uninitialized&quot;</span><span class="p">,</span> <span class="s2">&quot;pointer&quot;</span><span class="p">,</span> <span class="s2">&quot;solidity-version&quot;</span><span class="p">,</span> <span class="s2">&quot;slot-0&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># ERC-777 Hooks Reentrancy</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;ERC777-REENTRANCY&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-107&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-841&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ERC-777 Token Hooks Reentrancy&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;ERC-777 tokens have hooks (tokensReceived, tokensToSend) that are called &quot;</span>
            <span class="s2">&quot;during transfers. If a protocol is unaware of these hooks, they can be &quot;</span>
            <span class="s2">&quot;exploited for reentrancy attacks even when no ETH is involved.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function deposit(uint256 amount) external {</span>
<span class="s2">    require(token.balanceOf(msg.sender) &gt;= amount);</span>
<span class="s2">    // Transfer triggers tokensToSend hook - reentrancy point!</span>
<span class="s2">    token.transferFrom(msg.sender, address(this), amount);</span>
<span class="s2">    balances[msg.sender] += amount;  // State update after</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function deposit(uint256 amount) external nonReentrant {</span>
<span class="s2">    require(token.balanceOf(msg.sender) &gt;= amount);</span>
<span class="s2">    balances[msg.sender] += amount;  // Update state first</span>
<span class="s2">    token.transferFrom(msg.sender, address(this), amount);</span>
<span class="s2">}</span>

<span class="s2">// Or block ERC-777 tokens entirely</span>
<span class="s2">require(!ERC1820Registry.getInterfaceImplementer(</span>
<span class="s2">    address(token),</span>
<span class="s2">    keccak256(&quot;ERC777Token&quot;)</span>
<span class="s2">) != address(0), &quot;ERC777 not supported&quot;);</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker registers as ERC-777 tokensToSend hook. &quot;</span>
            <span class="s2">&quot;2. Attacker calls deposit() with ERC-777 token. &quot;</span>
            <span class="s2">&quot;3. transferFrom triggers attacker&#39;s hook. &quot;</span>
            <span class="s2">&quot;4. Hook calls deposit() again (balance not yet credited). &quot;</span>
            <span class="s2">&quot;5. Attacker gets credited multiple times for same deposit.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;imBTC Uniswap Attack - $300K (2020)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;erc777&quot;</span><span class="p">,</span> <span class="s2">&quot;hooks&quot;</span><span class="p">,</span> <span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span> <span class="s2">&quot;token&quot;</span><span class="p">,</span> <span class="s2">&quot;callback&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Fee-on-Transfer Token Issues</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;FEE-ON-TRANSFER&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-682&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Fee-on-Transfer Token Incompatibility&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Some tokens deduct a fee on every transfer. Protocols that assume &quot;</span>
            <span class="s2">&quot;transfer(amount) results in exactly `amount` being received will &quot;</span>
            <span class="s2">&quot;have accounting errors when used with these tokens.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function deposit(uint256 amount) external {</span>
<span class="s2">    token.transferFrom(msg.sender, address(this), amount);</span>
<span class="s2">    // WRONG: Assumes we received exactly &#39;amount&#39;</span>
<span class="s2">    balances[msg.sender] += amount;</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function deposit(uint256 amount) external {</span>
<span class="s2">    uint256 balanceBefore = token.balanceOf(address(this));</span>
<span class="s2">    token.transferFrom(msg.sender, address(this), amount);</span>
<span class="s2">    uint256 balanceAfter = token.balanceOf(address(this));</span>
<span class="s2">    uint256 actualReceived = balanceAfter - balanceBefore;</span>
<span class="s2">    balances[msg.sender] += actualReceived;  // Use actual amount</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Protocol assumes 100 tokens in = 100 tokens credited. &quot;</span>
            <span class="s2">&quot;2. Fee-on-transfer token has 1</span><span class="si">% f</span><span class="s2">ee. &quot;</span>
            <span class="s2">&quot;3. User deposits 100 tokens, protocol receives 99. &quot;</span>
            <span class="s2">&quot;4. User credited with 100 tokens in protocol. &quot;</span>
            <span class="s2">&quot;5. Last withdrawer can&#39;t withdraw - insufficient funds.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;token&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple DeFi protocols affected&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fee-on-transfer&quot;</span><span class="p">,</span> <span class="s2">&quot;token&quot;</span><span class="p">,</span> <span class="s2">&quot;accounting&quot;</span><span class="p">,</span> <span class="s2">&quot;balance-check&quot;</span><span class="p">,</span> <span class="s2">&quot;deflationary&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-106: Unprotected SELFDESTRUCT</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-106&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-106&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-284&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Unprotected SELFDESTRUCT Instruction&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;A contract with a public or unprotected selfdestruct() function can be &quot;</span>
            <span class="s2">&quot;destroyed by anyone. This permanently removes the contract code and sends &quot;</span>
            <span class="s2">&quot;all remaining ETH to a specified address.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function destroy() public {</span>
<span class="s2">    selfdestruct(payable(msg.sender));  // Anyone can call!</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function destroy() public onlyOwner {</span>
<span class="s2">    selfdestruct(payable(owner));</span>
<span class="s2">}</span>

<span class="s2">// Better: Remove selfdestruct entirely (deprecated in newer Solidity)</span>
<span class="s2">// Use pausable pattern instead</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker finds contract with unprotected selfdestruct. &quot;</span>
            <span class="s2">&quot;2. Attacker calls destroy(). &quot;</span>
            <span class="s2">&quot;3. Contract code is erased permanently. &quot;</span>
            <span class="s2">&quot;4. All ETH sent to attacker. &quot;</span>
            <span class="s2">&quot;5. Dependent contracts/users lose access forever.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;access-control&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Parity Multisig Library - $150M frozen permanently (2017)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selfdestruct&quot;</span><span class="p">,</span> <span class="s2">&quot;access-control&quot;</span><span class="p">,</span> <span class="s2">&quot;permanent&quot;</span><span class="p">,</span> <span class="s2">&quot;destructive&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-116: Block Timestamp Dependence</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-116&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-116&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-829&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Block Values as Time Proxy&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Miners can manipulate block.timestamp within a range (~15 seconds). &quot;</span>
            <span class="s2">&quot;Contracts that rely on precise timing or use timestamp for randomness &quot;</span>
            <span class="s2">&quot;are vulnerable to manipulation.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function isLotteryWinner() public view returns (bool) {</span>
<span class="s2">    return block.timestamp % 2 == 0;  // Manipulable!</span>
<span class="s2">}</span>

<span class="s2">function timeLock() public {</span>
<span class="s2">    require(block.timestamp &gt;= releaseTime);  // ~15s manipulation window</span>
<span class="s2">    // Release funds...</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// For randomness: Use Chainlink VRF</span>
<span class="s2">function requestRandomness() external returns (bytes32) {</span>
<span class="s2">    return requestRandomness(keyHash, fee);</span>
<span class="s2">}</span>

<span class="s2">// For time-locks: Add buffer for manipulation</span>
<span class="s2">function timeLock() public {</span>
<span class="s2">    require(block.timestamp &gt;= releaseTime + 15 minutes);  // Buffer</span>
<span class="s2">    // Or use block.number instead for longer periods</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Lottery uses timestamp for winner selection. &quot;</span>
            <span class="s2">&quot;2. Miner sees their transaction would lose. &quot;</span>
            <span class="s2">&quot;3. Miner adjusts block timestamp slightly. &quot;</span>
            <span class="s2">&quot;4. Miner wins the lottery.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;low&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;randomness&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;block-values&quot;</span><span class="p">,</span> <span class="s2">&quot;randomness&quot;</span><span class="p">,</span> <span class="s2">&quot;miner-manipulation&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-120: Weak Sources of Randomness</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-120&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-120&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-330&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Weak Sources of Randomness from Chain Attributes&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Using blockhash, block.timestamp, block.difficulty, or block.number as &quot;</span>
            <span class="s2">&quot;randomness sources is insecure. Miners can influence these values, and &quot;</span>
            <span class="s2">&quot;blockhash is only available for the 256 most recent blocks.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function random() internal view returns (uint256) {</span>
<span class="s2">    return uint256(keccak256(abi.encodePacked(</span>
<span class="s2">        block.timestamp,</span>
<span class="s2">        block.difficulty,</span>
<span class="s2">        msg.sender</span>
<span class="s2">    )));  // All predictable/manipulable!</span>
<span class="s2">}</span>

<span class="s2">function flipCoin() external payable {</span>
<span class="s2">    require(msg.value == 1 ether);</span>
<span class="s2">    if (random() % 2 == 0) {</span>
<span class="s2">        payable(msg.sender).transfer(2 ether);</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Use Chainlink VRF for secure randomness</span>
<span class="s2">import &quot;@chainlink/contracts/src/v0.8/vrf/VRFV2WrapperConsumerBase.sol&quot;;</span>

<span class="s2">function requestRandomWords() internal returns (uint256 requestId) {</span>
<span class="s2">    return requestRandomness(callbackGasLimit, requestConfirmations, numWords);</span>
<span class="s2">}</span>

<span class="s2">function fulfillRandomWords(uint256 requestId, uint256[] memory randomWords) internal override {</span>
<span class="s2">    // Use randomWords[0] for provably fair randomness</span>
<span class="s2">    processGameResult(randomWords[0]);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker predicts &#39;random&#39; outcome off-chain. &quot;</span>
            <span class="s2">&quot;2. Only submits transaction when outcome is favorable. &quot;</span>
            <span class="s2">&quot;3. Or miner manipulates block values to win. &quot;</span>
            <span class="s2">&quot;4. &#39;Random&#39; lottery/game is deterministic for attacker.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;randomness&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple lottery/gambling contracts exploited&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;randomness&quot;</span><span class="p">,</span> <span class="s2">&quot;blockhash&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;chainlink-vrf&quot;</span><span class="p">,</span> <span class="s2">&quot;predictable&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-100: Function Default Visibility</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-100&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-100&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-710&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Function Default Visibility&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Functions without explicit visibility default to &#39;public&#39; in older Solidity. &quot;</span>
            <span class="s2">&quot;This can expose internal functions that should be private, allowing attackers &quot;</span>
            <span class="s2">&quot;to call sensitive functions directly.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Solidity &lt; 0.5.0</span>
<span class="s2">contract Wallet {</span>
<span class="s2">    function transfer(address to, uint amount) {  // No visibility = public!</span>
<span class="s2">        // Internal transfer logic exposed</span>
<span class="s2">    }</span>

<span class="s2">    function _internalHelper() {  // Convention says private, but it&#39;s public!</span>
<span class="s2">        // Sensitive logic</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">contract Wallet {</span>
<span class="s2">    function transfer(address to, uint amount) public {</span>
<span class="s2">        // Explicitly public</span>
<span class="s2">    }</span>

<span class="s2">    function _internalHelper() private {</span>
<span class="s2">        // Explicitly private</span>
<span class="s2">    }</span>

<span class="s2">    function _protectedLogic() internal {</span>
<span class="s2">        // Explicitly internal</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Developer assumes underscore prefix means private. &quot;</span>
            <span class="s2">&quot;2. Function is actually public (no explicit visibility). &quot;</span>
            <span class="s2">&quot;3. Attacker calls _adminFunction() directly. &quot;</span>
            <span class="s2">&quot;4. Bypasses intended access control.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;visibility&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;visibility&quot;</span><span class="p">,</span> <span class="s2">&quot;public&quot;</span><span class="p">,</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span> <span class="s2">&quot;access-control&quot;</span><span class="p">,</span> <span class="s2">&quot;solidity-version&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-117: Signature Malleability</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-117&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-117&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-347&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Signature Malleability&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;ECDSA signatures in Ethereum have a malleability property: for any valid &quot;</span>
            <span class="s2">&quot;signature (r, s, v), there exists another valid signature (r, -s mod n, v&#39;). &quot;</span>
            <span class="s2">&quot;This can be exploited if signatures are used as unique identifiers.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">mapping(bytes =&gt; bool) public usedSignatures;</span>

<span class="s2">function claim(bytes memory signature) external {</span>
<span class="s2">    require(!usedSignatures[signature], &quot;Already used&quot;);</span>
<span class="s2">    // Verify signature...</span>
<span class="s2">    address signer = recoverSigner(message, signature);</span>
<span class="s2">    require(signer == trustedSigner);</span>
<span class="s2">    usedSignatures[signature] = true;</span>
<span class="s2">    // Process claim</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">mapping(bytes32 =&gt; bool) public usedMessages;  // Track message hash, not signature</span>

<span class="s2">function claim(bytes memory signature) external {</span>
<span class="s2">    bytes32 messageHash = getMessageHash(msg.sender, amount);</span>
<span class="s2">    require(!usedMessages[messageHash], &quot;Already claimed&quot;);</span>

<span class="s2">    // Use OpenZeppelin ECDSA for safe recovery</span>
<span class="s2">    address signer = ECDSA.recover(messageHash, signature);</span>
<span class="s2">    require(signer == trustedSigner);</span>

<span class="s2">    usedMessages[messageHash] = true;  // Mark message as used</span>
<span class="s2">    // Process claim</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. User submits valid signature S for claim. &quot;</span>
            <span class="s2">&quot;2. Contract marks signature S as used. &quot;</span>
            <span class="s2">&quot;3. Attacker computes malleable signature S&#39;. &quot;</span>
            <span class="s2">&quot;4. S&#39; is different but recovers same signer. &quot;</span>
            <span class="s2">&quot;5. Attacker claims again with S&#39;.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;cryptography&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;signature&quot;</span><span class="p">,</span> <span class="s2">&quot;malleability&quot;</span><span class="p">,</span> <span class="s2">&quot;ecdsa&quot;</span><span class="p">,</span> <span class="s2">&quot;ecrecover&quot;</span><span class="p">,</span> <span class="s2">&quot;replay&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-119: Shadowing State Variables</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-119&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-119&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-710&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Shadowing State Variables&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;State variable shadowing occurs when a derived contract declares a variable &quot;</span>
            <span class="s2">&quot;with the same name as a parent contract. This creates two separate storage &quot;</span>
            <span class="s2">&quot;slots and can lead to unexpected behavior.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">contract Parent {</span>
<span class="s2">    address public owner;</span>

<span class="s2">    constructor() {</span>
<span class="s2">        owner = msg.sender;</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">contract Child is Parent {</span>
<span class="s2">    address public owner;  // SHADOWS Parent.owner!</span>

<span class="s2">    function setOwner(address newOwner) public {</span>
<span class="s2">        owner = newOwner;  // Only sets Child.owner, not Parent.owner</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">contract Parent {</span>
<span class="s2">    address public owner;</span>

<span class="s2">    constructor() {</span>
<span class="s2">        owner = msg.sender;</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">contract Child is Parent {</span>
<span class="s2">    // Don&#39;t redeclare owner - use inherited variable</span>

<span class="s2">    function setOwner(address newOwner) public {</span>
<span class="s2">        owner = newOwner;  // Modifies Parent.owner correctly</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Parent contract checks owner for access control. &quot;</span>
            <span class="s2">&quot;2. Child shadows owner variable. &quot;</span>
            <span class="s2">&quot;3. Child&#39;s setOwner updates Child.owner only. &quot;</span>
            <span class="s2">&quot;4. Parent&#39;s owner check uses Parent.owner (unchanged). &quot;</span>
            <span class="s2">&quot;5. Access control behaves unexpectedly.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;inheritance&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;shadowing&quot;</span><span class="p">,</span> <span class="s2">&quot;inheritance&quot;</span><span class="p">,</span> <span class="s2">&quot;state-variable&quot;</span><span class="p">,</span> <span class="s2">&quot;storage&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-113: DoS with Failed Call</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-113&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-113&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-400&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;DoS with Failed Call&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;External calls can fail intentionally. If a contract iterates through &quot;</span>
            <span class="s2">&quot;recipients and one always reverts, the entire function becomes unusable. &quot;</span>
            <span class="s2">&quot;Attackers can exploit this to block legitimate operations.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">address[] public bidders;</span>

<span class="s2">function refundAll() external {</span>
<span class="s2">    for (uint i = 0; i &lt; bidders.length; i++) {</span>
<span class="s2">        // If any transfer fails, entire function reverts!</span>
<span class="s2">        payable(bidders[i]).transfer(bids[bidders[i]]);</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">mapping(address =&gt; uint256) public pendingReturns;</span>

<span class="s2">function refundAll() external {</span>
<span class="s2">    for (uint i = 0; i &lt; bidders.length; i++) {</span>
<span class="s2">        pendingReturns[bidders[i]] = bids[bidders[i]];</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Pull pattern - users withdraw themselves</span>
<span class="s2">function withdraw() external {</span>
<span class="s2">    uint256 amount = pendingReturns[msg.sender];</span>
<span class="s2">    require(amount &gt; 0);</span>
<span class="s2">    pendingReturns[msg.sender] = 0;</span>
<span class="s2">    (bool success,) = msg.sender.call{value: amount}(&quot;&quot;);</span>
<span class="s2">    require(success);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker bids in auction with contract that reverts on receive. &quot;</span>
            <span class="s2">&quot;2. Auction ends, refundAll() called to return funds. &quot;</span>
            <span class="s2">&quot;3. When transfer to attacker&#39;s contract happens, it reverts. &quot;</span>
            <span class="s2">&quot;4. Entire refundAll() reverts - no one gets refund. &quot;</span>
            <span class="s2">&quot;5. Funds locked forever.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;denial-of-service&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;King of the Ether (2016)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dos&quot;</span><span class="p">,</span> <span class="s2">&quot;failed-call&quot;</span><span class="p">,</span> <span class="s2">&quot;pull-pattern&quot;</span><span class="p">,</span> <span class="s2">&quot;revert&quot;</span><span class="p">,</span> <span class="s2">&quot;griefing&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-126: Insufficient Gas Griefing</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-126&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-126&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-691&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Insufficient Gas Griefing&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;When a contract makes an external call, the caller controls how much gas &quot;</span>
            <span class="s2">&quot;to forward. A malicious relayer can provide just enough gas for the outer &quot;</span>
            <span class="s2">&quot;call to succeed but the inner call to fail.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function relay(address target, bytes calldata data) external {</span>
<span class="s2">    (bool success,) = target.call(data);  // All remaining gas forwarded</span>
<span class="s2">    // But relayer can limit gas to fail inner call</span>
<span class="s2">    require(success, &quot;Call failed&quot;);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function relay(address target, bytes calldata data, uint256 gasLimit) external {</span>
<span class="s2">    require(gasleft() &gt;= gasLimit + 10000, &quot;Insufficient gas&quot;);</span>
<span class="s2">    (bool success,) = target.call{gas: gasLimit}(data);</span>
<span class="s2">    require(success, &quot;Call failed&quot;);</span>
<span class="s2">}</span>

<span class="s2">// Or use EIP-150 1/64th rule consideration</span>
<span class="s2">function safeRelay(address target, bytes calldata data) external {</span>
<span class="s2">    uint256 gasToForward = gasleft() - 5000;</span>
<span class="s2">    (bool success,) = target.call{gas: gasToForward}(data);</span>
<span class="s2">    require(success, &quot;Call failed&quot;);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. User relies on relayer to submit transaction. &quot;</span>
            <span class="s2">&quot;2. Relayer forwards minimal gas. &quot;</span>
            <span class="s2">&quot;3. Outer call succeeds (enough gas). &quot;</span>
            <span class="s2">&quot;4. Inner subcall fails (insufficient gas). &quot;</span>
            <span class="s2">&quot;5. User&#39;s transaction appears successful but didn&#39;t complete.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;gas&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gas-griefing&quot;</span><span class="p">,</span> <span class="s2">&quot;relay&quot;</span><span class="p">,</span> <span class="s2">&quot;insufficient-gas&quot;</span><span class="p">,</span> <span class="s2">&quot;eip-150&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-132: Unexpected Ether Balance</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-132&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-132&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-841&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Unexpected Ether Balance&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Contracts can receive ETH through selfdestruct (forced) or coinbase &quot;</span>
            <span class="s2">&quot;transactions without triggering receive/fallback. Contracts that rely on &quot;</span>
            <span class="s2">&quot;address(this).balance == expected_value are vulnerable.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function withdraw() external {</span>
<span class="s2">    require(address(this).balance == totalDeposits);  // Can be broken!</span>
<span class="s2">    payable(msg.sender).transfer(deposits[msg.sender]);</span>
<span class="s2">    totalDeposits -= deposits[msg.sender];</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Track balances independently, don&#39;t rely on address(this).balance</span>
<span class="s2">uint256 public accountedBalance;</span>

<span class="s2">function deposit() external payable {</span>
<span class="s2">    deposits[msg.sender] += msg.value;</span>
<span class="s2">    accountedBalance += msg.value;</span>
<span class="s2">}</span>

<span class="s2">function withdraw() external {</span>
<span class="s2">    uint256 amount = deposits[msg.sender];</span>
<span class="s2">    deposits[msg.sender] = 0;</span>
<span class="s2">    accountedBalance -= amount;</span>
<span class="s2">    payable(msg.sender).transfer(amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Contract checks balance == expected for invariant. &quot;</span>
            <span class="s2">&quot;2. Attacker creates contract with some ETH. &quot;</span>
            <span class="s2">&quot;3. Attacker selfdestructs, sending ETH to victim. &quot;</span>
            <span class="s2">&quot;4. Victim&#39;s balance check now fails. &quot;</span>
            <span class="s2">&quot;5. Contract functionality broken.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;low&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;balance&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selfdestruct&quot;</span><span class="p">,</span> <span class="s2">&quot;balance&quot;</span><span class="p">,</span> <span class="s2">&quot;unexpected-ether&quot;</span><span class="p">,</span> <span class="s2">&quot;invariant&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># SWC-124: Write to Arbitrary Storage</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;SWC-124&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-124&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-123&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Write to Arbitrary Storage Location&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Dynamic arrays in storage can be manipulated to write to arbitrary slots. &quot;</span>
            <span class="s2">&quot;If array length is user-controlled, attacker can overflow array index to &quot;</span>
            <span class="s2">&quot;target specific storage slots like owner address.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">uint256[] public data;</span>

<span class="s2">function write(uint256 index, uint256 value) external {</span>
<span class="s2">    // No bounds check!</span>
<span class="s2">    data[index] = value;  // Can write to ANY storage slot</span>
<span class="s2">}</span>

<span class="s2">function expand(uint256 newLength) external {</span>
<span class="s2">    data.length = newLength;  // Old Solidity: controllable length</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">uint256[] public data;</span>

<span class="s2">function write(uint256 index, uint256 value) external {</span>
<span class="s2">    require(index &lt; data.length, &quot;Out of bounds&quot;);</span>
<span class="s2">    data[index] = value;</span>
<span class="s2">}</span>

<span class="s2">// Modern Solidity: Use push() for dynamic arrays</span>
<span class="s2">function append(uint256 value) external {</span>
<span class="s2">    data.push(value);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Array stored at slot S, length at slot S. &quot;</span>
            <span class="s2">&quot;2. Array elements at keccak256(S) + index. &quot;</span>
            <span class="s2">&quot;3. Attacker calculates index to hit target slot (e.g., owner). &quot;</span>
            <span class="s2">&quot;4. Attacker calls write(malicious_index, attacker_address). &quot;</span>
            <span class="s2">&quot;5. Owner slot overwritten, attacker gains control.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;storage&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;arbitrary-write&quot;</span><span class="p">,</span> <span class="s2">&quot;storage&quot;</span><span class="p">,</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span> <span class="s2">&quot;overflow&quot;</span><span class="p">,</span> <span class="s2">&quot;solidity-version&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Permit Function Phishing</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;PERMIT-PHISHING&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-352&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ERC-2612 Permit Function Phishing&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;ERC-2612 permit() allows gasless approvals via signatures. Attackers can &quot;</span>
            <span class="s2">&quot;trick users into signing permit messages that approve unlimited spending &quot;</span>
            <span class="s2">&quot;to attacker-controlled addresses.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// This is actually standard permit - the vulnerability is in how it&#39;s used</span>
<span class="s2">function permit(</span>
<span class="s2">    address owner,</span>
<span class="s2">    address spender,</span>
<span class="s2">    uint256 value,</span>
<span class="s2">    uint256 deadline,</span>
<span class="s2">    uint8 v, bytes32 r, bytes32 s</span>
<span class="s2">) external {</span>
<span class="s2">    // Attacker tricks user into signing (owner=user, spender=attacker, value=MAX)</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// User protection: Always verify permit parameters before signing</span>
<span class="s2">// Wallet protection: Show clear permit details to user</span>
<span class="s2">// Protocol protection: Limit permit amounts and add time-based restrictions</span>

<span class="s2">// For smart contract wallets:</span>
<span class="s2">function safePermit(...) external {</span>
<span class="s2">    require(value &lt;= dailyLimit[owner], &quot;Exceeds daily limit&quot;);</span>
<span class="s2">    require(spender != address(0), &quot;Invalid spender&quot;);</span>
<span class="s2">    // Additional checks...</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker creates phishing site mimicking legitimate dApp. &quot;</span>
            <span class="s2">&quot;2. Site requests user to sign &#39;transaction&#39; (actually permit). &quot;</span>
            <span class="s2">&quot;3. User signs permit: spender=attacker, value=MAX_UINT. &quot;</span>
            <span class="s2">&quot;4. Attacker calls permit() with user&#39;s signature. &quot;</span>
            <span class="s2">&quot;5. Attacker now approved for all user&#39;s tokens, drains wallet.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;phishing&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple permit phishing attacks, millions lost (2023)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;permit&quot;</span><span class="p">,</span> <span class="s2">&quot;erc2612&quot;</span><span class="p">,</span> <span class="s2">&quot;phishing&quot;</span><span class="p">,</span> <span class="s2">&quot;signature&quot;</span><span class="p">,</span> <span class="s2">&quot;approval&quot;</span><span class="p">,</span> <span class="s2">&quot;gasless&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># ERC-4626 Vault Inflation Attack</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;ERC4626-INFLATION&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-682&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ERC-4626 Vault Inflation Attack&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;ERC-4626 vaults can be exploited if the first depositor manipulates the &quot;</span>
            <span class="s2">&quot;share/asset ratio. By donating assets directly (not through deposit), &quot;</span>
            <span class="s2">&quot;attacker inflates share price, causing later depositors to receive 0 shares.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Standard ERC-4626 without protection</span>
<span class="s2">function convertToShares(uint256 assets) public view returns (uint256) {</span>
<span class="s2">    uint256 supply = totalSupply();</span>
<span class="s2">    return supply == 0 ? assets : assets * supply / totalAssets();</span>
<span class="s2">}</span>

<span class="s2">function deposit(uint256 assets, address receiver) public returns (uint256 shares) {</span>
<span class="s2">    shares = convertToShares(assets);  // Can round to 0!</span>
<span class="s2">    // Transfer and mint...</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Add virtual shares/assets offset</span>
<span class="s2">function convertToShares(uint256 assets) public view returns (uint256) {</span>
<span class="s2">    return assets.mulDivDown(totalSupply() + 1, totalAssets() + 1);</span>
<span class="s2">}</span>

<span class="s2">// Or require minimum deposit on first deposit</span>
<span class="s2">function deposit(uint256 assets, address receiver) public returns (uint256 shares) {</span>
<span class="s2">    if (totalSupply() == 0) {</span>
<span class="s2">        require(assets &gt;= MIN_DEPOSIT, &quot;Below minimum&quot;);</span>
<span class="s2">    }</span>
<span class="s2">    shares = convertToShares(assets);</span>
<span class="s2">    require(shares &gt; 0, &quot;Zero shares&quot;);</span>
<span class="s2">    // Continue...</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker is first depositor, deposits 1 wei, gets 1 share. &quot;</span>
            <span class="s2">&quot;2. Attacker donates 100 ETH directly to vault (not deposit). &quot;</span>
            <span class="s2">&quot;3. 1 share = 100 ETH + 1 wei. &quot;</span>
            <span class="s2">&quot;4. Victim deposits 99 ETH. &quot;</span>
            <span class="s2">&quot;5. convertToShares(99 ETH) = 0 due to rounding. &quot;</span>
            <span class="s2">&quot;6. Victim gets 0 shares, attacker profits.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;vault&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple ERC-4626 implementations vulnerable&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;erc4626&quot;</span><span class="p">,</span> <span class="s2">&quot;vault&quot;</span><span class="p">,</span> <span class="s2">&quot;inflation&quot;</span><span class="p">,</span> <span class="s2">&quot;rounding&quot;</span><span class="p">,</span> <span class="s2">&quot;first-deposit&quot;</span><span class="p">,</span> <span class="s2">&quot;defi&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># UUPS Uninitialized Implementation</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;UUPS-UNINITIALIZED&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-665&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;UUPS Proxy Uninitialized Implementation&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;UUPS proxies store upgrade logic in the implementation. If the implementation &quot;</span>
            <span class="s2">&quot;is left uninitialized, anyone can call initialize() to become owner and then &quot;</span>
            <span class="s2">&quot;call upgradeToAndCall() to destroy or replace the proxy.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Implementation contract</span>
<span class="s2">contract MyContractV1 is UUPSUpgradeable {</span>
<span class="s2">    address public owner;</span>

<span class="s2">    function initialize(address _owner) public initializer {</span>
<span class="s2">        owner = _owner;</span>
<span class="s2">    }</span>

<span class="s2">    function _authorizeUpgrade(address) internal override {</span>
<span class="s2">        require(msg.sender == owner);</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// DANGER: Implementation deployed but initialize() not called</span>
<span class="s2">// Anyone can call initialize() on the implementation directly</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">contract MyContractV1 is UUPSUpgradeable {</span>
<span class="s2">    /// @custom:oz-upgrades-unsafe-allow constructor</span>
<span class="s2">    constructor() {</span>
<span class="s2">        _disableInitializers();  // Prevent initialization of implementation</span>
<span class="s2">    }</span>

<span class="s2">    function initialize(address _owner) public initializer {</span>
<span class="s2">        owner = _owner;</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Always call _disableInitializers() in constructor</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Protocol deploys UUPS implementation without initializing. &quot;</span>
            <span class="s2">&quot;2. Attacker calls implementation.initialize(attacker). &quot;</span>
            <span class="s2">&quot;3. Attacker is now owner of implementation. &quot;</span>
            <span class="s2">&quot;4. Attacker calls upgradeToAndCall with selfdestruct payload. &quot;</span>
            <span class="s2">&quot;5. Implementation destroyed, proxy becomes unusable.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;proxy&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Wormhole - Implementation takeover possible (2022)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;uups&quot;</span><span class="p">,</span> <span class="s2">&quot;proxy&quot;</span><span class="p">,</span> <span class="s2">&quot;uninitialized&quot;</span><span class="p">,</span> <span class="s2">&quot;upgradeable&quot;</span><span class="p">,</span> <span class="s2">&quot;initializer&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Cross-Contract Reentrancy</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;CROSS-CONTRACT-REENTRANCY&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-107&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-841&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Cross-Contract Reentrancy&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Reentrancy between different contracts in the same protocol. Contract A &quot;</span>
            <span class="s2">&quot;calls Contract B which calls back to Contract A (or C) before A&#39;s state &quot;</span>
            <span class="s2">&quot;is updated. Each contract may be safe individually but vulnerable together.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Contract A (Lending Pool)</span>
<span class="s2">function borrow(uint amount) external {</span>
<span class="s2">    require(collateral[msg.sender] &gt;= amount * 2);</span>
<span class="s2">    token.transfer(msg.sender, amount);  // External call</span>
<span class="s2">    borrowed[msg.sender] += amount;</span>
<span class="s2">}</span>

<span class="s2">// Contract B (Collateral Manager) - shares state with A</span>
<span class="s2">function withdraw(uint amount) external {</span>
<span class="s2">    require(collateral[msg.sender] &gt;= amount);</span>
<span class="s2">    collateral[msg.sender] -= amount;  // During reentrancy, this isn&#39;t updated yet in A&#39;s view</span>
<span class="s2">    msg.sender.call{value: amount}(&quot;&quot;);  // Callback point</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Use protocol-wide reentrancy lock</span>
<span class="s2">contract ReentrancyGuard {</span>
<span class="s2">    uint256 private constant UNLOCKED = 1;</span>
<span class="s2">    uint256 private constant LOCKED = 2;</span>
<span class="s2">    uint256 private _status = UNLOCKED;</span>

<span class="s2">    modifier nonReentrant() {</span>
<span class="s2">        require(_status == UNLOCKED);</span>
<span class="s2">        _status = LOCKED;</span>
<span class="s2">        _;</span>
<span class="s2">        _status = UNLOCKED;</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Share the lock across all protocol contracts</span>
<span class="s2">// Or use a central registry for cross-contract locks</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker deposits collateral in Contract B. &quot;</span>
            <span class="s2">&quot;2. Attacker calls borrow() in Contract A. &quot;</span>
            <span class="s2">&quot;3. Before borrow updates state, calls withdraw() in B. &quot;</span>
            <span class="s2">&quot;4. B sends ETH, triggering callback to attacker. &quot;</span>
            <span class="s2">&quot;5. Attacker re-borrows (collateral still shows as available). &quot;</span>
            <span class="s2">&quot;6. Protocol drained across contracts.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Fei Protocol Rari Hack - $80M (2022)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span> <span class="s2">&quot;cross-contract&quot;</span><span class="p">,</span> <span class="s2">&quot;protocol&quot;</span><span class="p">,</span> <span class="s2">&quot;shared-state&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Rebasing Token Issues</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;REBASING-TOKEN&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-682&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Rebasing Token Incompatibility&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Rebasing tokens (like stETH, AMPL) automatically adjust all balances. &quot;</span>
            <span class="s2">&quot;Protocols that cache balances or use transfer amounts directly will have &quot;</span>
            <span class="s2">&quot;accounting errors as the actual balance changes over time.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">mapping(address =&gt; uint256) public stakedAmount;</span>

<span class="s2">function stake(uint256 amount) external {</span>
<span class="s2">    rebasingToken.transferFrom(msg.sender, address(this), amount);</span>
<span class="s2">    stakedAmount[msg.sender] = amount;  // Cached amount, won&#39;t update on rebase</span>
<span class="s2">}</span>

<span class="s2">function unstake() external {</span>
<span class="s2">    uint256 amount = stakedAmount[msg.sender];</span>
<span class="s2">    stakedAmount[msg.sender] = 0;</span>
<span class="s2">    rebasingToken.transfer(msg.sender, amount);  // May fail if negative rebase occurred</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Use shares instead of amounts for rebasing tokens</span>
<span class="s2">mapping(address =&gt; uint256) public userShares;</span>

<span class="s2">function stake(uint256 amount) external {</span>
<span class="s2">    uint256 sharesBefore = rebasingToken.sharesOf(address(this));</span>
<span class="s2">    rebasingToken.transferFrom(msg.sender, address(this), amount);</span>
<span class="s2">    uint256 sharesAfter = rebasingToken.sharesOf(address(this));</span>
<span class="s2">    userShares[msg.sender] += sharesAfter - sharesBefore;</span>
<span class="s2">}</span>

<span class="s2">// Or simply don&#39;t support rebasing tokens</span>
<span class="s2">require(!isRebasingToken(token), &quot;Rebasing tokens not supported&quot;);</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. User stakes 100 stETH, protocol records 100. &quot;</span>
            <span class="s2">&quot;2. Positive rebase: user&#39;s stake is now worth 110 stETH. &quot;</span>
            <span class="s2">&quot;3. User withdraws, only gets 100 stETH (protocol&#39;s cached amount). &quot;</span>
            <span class="s2">&quot;4. Extra 10 stETH stuck in protocol. &quot;</span>
            <span class="s2">&quot;5. Or with negative rebase: protocol may be insolvent.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;token&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple DeFi protocols had rebasing issues&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rebasing&quot;</span><span class="p">,</span> <span class="s2">&quot;steth&quot;</span><span class="p">,</span> <span class="s2">&quot;ampl&quot;</span><span class="p">,</span> <span class="s2">&quot;shares&quot;</span><span class="p">,</span> <span class="s2">&quot;balance&quot;</span><span class="p">,</span> <span class="s2">&quot;defi&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Merkle Tree Leaf Collision</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;MERKLE-LEAF-COLLISION&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-327&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Merkle Tree Leaf vs Node Collision&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Merkle trees that don&#39;t differentiate between leaf and internal node hashes &quot;</span>
            <span class="s2">&quot;are vulnerable to second preimage attacks. An attacker can prove membership &quot;</span>
            <span class="s2">&quot;of fabricated data by providing an internal node as a &#39;leaf&#39;.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function verifyProof(</span>
<span class="s2">    bytes32[] memory proof,</span>
<span class="s2">    bytes32 root,</span>
<span class="s2">    bytes32 leaf</span>
<span class="s2">) internal pure returns (bool) {</span>
<span class="s2">    bytes32 computedHash = leaf;</span>
<span class="s2">    for (uint256 i = 0; i &lt; proof.length; i++) {</span>
<span class="s2">        computedHash = keccak256(abi.encodePacked(computedHash, proof[i]));</span>
<span class="s2">        // No distinction between leaf and internal node hashing!</span>
<span class="s2">    }</span>
<span class="s2">    return computedHash == root;</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Use different hash for leaves vs internal nodes</span>
<span class="s2">function verifyProof(...) internal pure returns (bool) {</span>
<span class="s2">    // Leaf hash: 0x00 prefix</span>
<span class="s2">    bytes32 computedHash = keccak256(abi.encodePacked(hex&quot;00&quot;, leaf));</span>

<span class="s2">    for (uint256 i = 0; i &lt; proof.length; i++) {</span>
<span class="s2">        // Internal node hash: 0x01 prefix + sorted children</span>
<span class="s2">        if (computedHash &lt; proof[i]) {</span>
<span class="s2">            computedHash = keccak256(abi.encodePacked(hex&quot;01&quot;, computedHash, proof[i]));</span>
<span class="s2">        } else {</span>
<span class="s2">            computedHash = keccak256(abi.encodePacked(hex&quot;01&quot;, proof[i], computedHash));</span>
<span class="s2">        }</span>
<span class="s2">    }</span>
<span class="s2">    return computedHash == root;</span>
<span class="s2">}</span>

<span class="s2">// Or use OpenZeppelin MerkleProof library</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Merkle tree has leaves: hash(A), hash(B). &quot;</span>
            <span class="s2">&quot;2. Internal node = hash(hash(A) || hash(B)). &quot;</span>
            <span class="s2">&quot;3. Attacker presents internal node value as &#39;leaf&#39;. &quot;</span>
            <span class="s2">&quot;4. Proof verifies (internal node is in tree). &quot;</span>
            <span class="s2">&quot;5. Attacker claims airdrop for fabricated data.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;cryptography&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;CVE-2012-2459 (Bitcoin), various Merkle airdrops&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;merkle&quot;</span><span class="p">,</span> <span class="s2">&quot;proof&quot;</span><span class="p">,</span> <span class="s2">&quot;collision&quot;</span><span class="p">,</span> <span class="s2">&quot;airdrop&quot;</span><span class="p">,</span> <span class="s2">&quot;cryptography&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Lack of Access Control on Callback</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;CALLBACK-ACCESS-CONTROL&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-284&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Missing Access Control on Callback Functions&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Callback functions (like Uniswap&#39;s uniswapV3SwapCallback or flash loan callbacks) &quot;</span>
            <span class="s2">&quot;must verify the caller. Without proper validation, attackers can call these &quot;</span>
            <span class="s2">&quot;functions directly with malicious parameters.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function uniswapV3SwapCallback(</span>
<span class="s2">    int256 amount0Delta,</span>
<span class="s2">    int256 amount1Delta,</span>
<span class="s2">    bytes calldata data</span>
<span class="s2">) external {</span>
<span class="s2">    // NO CALLER VALIDATION!</span>
<span class="s2">    // Attacker can call directly</span>
<span class="s2">    if (amount0Delta &gt; 0) {</span>
<span class="s2">        IERC20(token0).transfer(msg.sender, uint256(amount0Delta));</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function uniswapV3SwapCallback(</span>
<span class="s2">    int256 amount0Delta,</span>
<span class="s2">    int256 amount1Delta,</span>
<span class="s2">    bytes calldata data</span>
<span class="s2">) external {</span>
<span class="s2">    // Verify caller is legitimate Uniswap pool</span>
<span class="s2">    require(msg.sender == address(pool), &quot;Invalid caller&quot;);</span>
<span class="s2">    // Or compute expected pool address</span>
<span class="s2">    address expectedPool = PoolAddress.computeAddress(</span>
<span class="s2">        factory, PoolAddress.getPoolKey(token0, token1, fee)</span>
<span class="s2">    );</span>
<span class="s2">    require(msg.sender == expectedPool, &quot;Invalid pool&quot;);</span>

<span class="s2">    // Now safe to proceed</span>
<span class="s2">    if (amount0Delta &gt; 0) {</span>
<span class="s2">        IERC20(token0).transfer(msg.sender, uint256(amount0Delta));</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Protocol implements swap callback without caller check. &quot;</span>
            <span class="s2">&quot;2. Attacker calls callback directly (not through swap). &quot;</span>
            <span class="s2">&quot;3. Passes attacker&#39;s address for payment. &quot;</span>
            <span class="s2">&quot;4. Protocol sends tokens to attacker. &quot;</span>
            <span class="s2">&quot;5. Funds drained without actual swap occurring.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;access-control&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple DeFi protocols vulnerable to callback exploits&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span> <span class="s2">&quot;access-control&quot;</span><span class="p">,</span> <span class="s2">&quot;uniswap&quot;</span><span class="p">,</span> <span class="s2">&quot;flash-loan&quot;</span><span class="p">,</span> <span class="s2">&quot;verification&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Precision Loss in Division</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;PRECISION-LOSS&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-682&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Precision Loss in Division&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Solidity integer division truncates (rounds down). Operations like &quot;</span>
            <span class="s2">&quot;(a / b) * c lose precision compared to (a * c) / b. This can be &quot;</span>
            <span class="s2">&quot;exploited to extract value through rounding errors.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function calculateFee(uint256 amount) public pure returns (uint256) {</span>
<span class="s2">    return (amount / 10000) * 30;  // 0.3</span><span class="si">% f</span><span class="s2">ee - precision loss!</span>
<span class="s2">    // For amount = 9999, returns 0 instead of ~3</span>
<span class="s2">}</span>

<span class="s2">function swap(uint256 amountIn) external returns (uint256) {</span>
<span class="s2">    uint256 fee = calculateFee(amountIn);</span>
<span class="s2">    uint256 amountOut = (amountIn - fee) * price / 1e18;</span>
<span class="s2">    // Multiple division operations compound precision loss</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function calculateFee(uint256 amount) public pure returns (uint256) {</span>
<span class="s2">    return (amount * 30) / 10000;  // Multiply first, then divide</span>
<span class="s2">}</span>

<span class="s2">// Use higher precision internally</span>
<span class="s2">uint256 constant PRECISION = 1e18;</span>

<span class="s2">function swap(uint256 amountIn) external returns (uint256) {</span>
<span class="s2">    uint256 amountOutPrecise = amountIn * PRECISION * price / 10000 / 1e18;</span>
<span class="s2">    return amountOutPrecise / PRECISION;</span>
<span class="s2">}</span>

<span class="s2">// Or use fixed-point math libraries like PRBMath</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Protocol charges 0.3</span><span class="si">% f</span><span class="s2">ee with (amount/10000)*30. &quot;</span>
            <span class="s2">&quot;2. Attacker sends many small swaps of 9999 wei. &quot;</span>
            <span class="s2">&quot;3. Fee calculates to 0 each time (9999/10000 = 0). &quot;</span>
            <span class="s2">&quot;4. Attacker avoids all fees. &quot;</span>
            <span class="s2">&quot;5. Over time, significant value extracted.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;arithmetic&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;precision&quot;</span><span class="p">,</span> <span class="s2">&quot;division&quot;</span><span class="p">,</span> <span class="s2">&quot;rounding&quot;</span><span class="p">,</span> <span class="s2">&quot;fee&quot;</span><span class="p">,</span> <span class="s2">&quot;dust&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Time-lock Bypass</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;TIMELOCK-BYPASS&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-287&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Governance Timelock Bypass&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Timelocks protect users by delaying sensitive operations. However, some &quot;</span>
            <span class="s2">&quot;functions may bypass the timelock, or the timelock admin might have direct &quot;</span>
            <span class="s2">&quot;access, negating the protection entirely.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">contract Treasury {</span>
<span class="s2">    address public admin;</span>
<span class="s2">    address public timelock;</span>

<span class="s2">    function executeProposal(bytes calldata data) external {</span>
<span class="s2">        require(msg.sender == timelock, &quot;Only timelock&quot;);</span>
<span class="s2">        // Execute...</span>
<span class="s2">    }</span>

<span class="s2">    function emergencyWithdraw(address to) external {</span>
<span class="s2">        require(msg.sender == admin, &quot;Only admin&quot;);</span>
<span class="s2">        // BYPASSES TIMELOCK! Admin can drain instantly</span>
<span class="s2">        payable(to).transfer(address(this).balance);</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">contract Treasury {</span>
<span class="s2">    address public timelock;  // Only timelock can act</span>

<span class="s2">    // ALL sensitive functions go through timelock</span>
<span class="s2">    function executeProposal(bytes calldata data) external {</span>
<span class="s2">        require(msg.sender == timelock, &quot;Only timelock&quot;);</span>
<span class="s2">        // Execute...</span>
<span class="s2">    }</span>

<span class="s2">    // Even emergency functions have delay</span>
<span class="s2">    function emergencyWithdraw(address to) external {</span>
<span class="s2">        require(msg.sender == timelock, &quot;Only timelock&quot;);</span>
<span class="s2">        // Emergency can have shorter delay, but still has one</span>
<span class="s2">        payable(to).transfer(address(this).balance);</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Protocol advertises 48h timelock for governance safety. &quot;</span>
            <span class="s2">&quot;2. Admin (multisig) has emergencyWithdraw() bypassing timelock. &quot;</span>
            <span class="s2">&quot;3. Multisig keys compromised or malicious. &quot;</span>
            <span class="s2">&quot;4. Admin calls emergencyWithdraw() - no delay. &quot;</span>
            <span class="s2">&quot;5. Treasury drained before users can react.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;timelock&quot;</span><span class="p">,</span> <span class="s2">&quot;bypass&quot;</span><span class="p">,</span> <span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span> <span class="s2">&quot;emergency&quot;</span><span class="p">,</span> <span class="s2">&quot;defi&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Chainlink Stale Price</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;CHAINLINK-STALE-PRICE&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-754&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Chainlink Oracle Stale/Invalid Price&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Chainlink price feeds can return stale data, incomplete rounds, or zero &quot;</span>
            <span class="s2">&quot;prices during network congestion or oracle issues. Contracts must validate &quot;</span>
            <span class="s2">&quot;all returned values to avoid using bad price data.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function getPrice() external view returns (uint256) {</span>
<span class="s2">    (, int256 price,,,) = priceFeed.latestRoundData();</span>
<span class="s2">    return uint256(price);  // No validation!</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function getPrice() external view returns (uint256) {</span>
<span class="s2">    (</span>
<span class="s2">        uint80 roundId,</span>
<span class="s2">        int256 price,</span>
<span class="s2">        ,</span>
<span class="s2">        uint256 updatedAt,</span>
<span class="s2">        uint80 answeredInRound</span>
<span class="s2">    ) = priceFeed.latestRoundData();</span>

<span class="s2">    // Validate round completeness</span>
<span class="s2">    require(answeredInRound &gt;= roundId, &quot;Stale price round&quot;);</span>

<span class="s2">    // Validate freshness</span>
<span class="s2">    require(block.timestamp - updatedAt &lt; MAX_STALENESS, &quot;Stale price&quot;);</span>

<span class="s2">    // Validate price is positive</span>
<span class="s2">    require(price &gt; 0, &quot;Invalid price&quot;);</span>

<span class="s2">    // Validate price is within reasonable bounds</span>
<span class="s2">    require(price &lt; MAX_PRICE &amp;&amp; price &gt; MIN_PRICE, &quot;Price out of bounds&quot;);</span>

<span class="s2">    return uint256(price);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Network congestion delays Chainlink updates. &quot;</span>
            <span class="s2">&quot;2. Price feed returns 24-hour-old price. &quot;</span>
            <span class="s2">&quot;3. Actual market price has moved 50%. &quot;</span>
            <span class="s2">&quot;4. Attacker exploits stale price for arbitrage. &quot;</span>
            <span class="s2">&quot;5. Protocol loses funds due to mispricing.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;oracle&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple DeFi exploits during market volatility&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;chainlink&quot;</span><span class="p">,</span> <span class="s2">&quot;oracle&quot;</span><span class="p">,</span> <span class="s2">&quot;stale-price&quot;</span><span class="p">,</span> <span class="s2">&quot;validation&quot;</span><span class="p">,</span> <span class="s2">&quot;defi&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Missing Zero Address Validation</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;ZERO-ADDRESS-CHECK&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-20&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Missing Zero Address Validation&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Functions that accept addresses should validate against the zero address &quot;</span>
            <span class="s2">&quot;(address(0)). Sending tokens or ETH to zero address burns them permanently. &quot;</span>
            <span class="s2">&quot;Setting owner/admin to zero address removes access permanently.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function setOwner(address newOwner) external onlyOwner {</span>
<span class="s2">    owner = newOwner;  // If newOwner is address(0), ownership lost forever</span>
<span class="s2">}</span>

<span class="s2">function transfer(address to, uint256 amount) external {</span>
<span class="s2">    balances[msg.sender] -= amount;</span>
<span class="s2">    balances[to] += amount;  // Tokens sent to address(0) are burned</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">function setOwner(address newOwner) external onlyOwner {</span>
<span class="s2">    require(newOwner != address(0), &quot;Invalid address&quot;);</span>
<span class="s2">    owner = newOwner;</span>
<span class="s2">}</span>

<span class="s2">function transfer(address to, uint256 amount) external {</span>
<span class="s2">    require(to != address(0), &quot;Cannot transfer to zero address&quot;);</span>
<span class="s2">    balances[msg.sender] -= amount;</span>
<span class="s2">    balances[to] += amount;</span>
<span class="s2">}</span>

<span class="s2">// Or use custom error for gas efficiency (Solidity 0.8.4+)</span>
<span class="s2">error ZeroAddress();</span>
<span class="s2">if (to == address(0)) revert ZeroAddress();</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Admin accidentally calls setOwner(address(0)). &quot;</span>
            <span class="s2">&quot;2. Or attacker tricks admin into setting zero address. &quot;</span>
            <span class="s2">&quot;3. Contract now has no owner. &quot;</span>
            <span class="s2">&quot;4. No one can call onlyOwner functions. &quot;</span>
            <span class="s2">&quot;5. Contract stuck in current state forever.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;low&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;zero-address&quot;</span><span class="p">,</span> <span class="s2">&quot;validation&quot;</span><span class="p">,</span> <span class="s2">&quot;burn&quot;</span><span class="p">,</span> <span class="s2">&quot;access-control&quot;</span><span class="p">,</span> <span class="s2">&quot;input-validation&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># MEV / FRONTRUNNING PATTERNS (Expanded)</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># JIT Liquidity Attack</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;MEV-JIT-LIQUIDITY&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-362&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;JIT (Just-In-Time) Liquidity Attack&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Attacker observes pending swap in mempool, adds liquidity just before the &quot;</span>
            <span class="s2">&quot;swap executes, collects fees from the swap, then removes liquidity immediately &quot;</span>
            <span class="s2">&quot;after. This extracts value from LPs without providing persistent liquidity.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// AMM Pool without JIT protection</span>
<span class="s2">function swap(uint amountIn, uint minOut) external {</span>
<span class="s2">    // No time-weighted checks</span>
<span class="s2">    uint amountOut = getAmountOut(amountIn);</span>
<span class="s2">    require(amountOut &gt;= minOut);</span>
<span class="s2">    // Execute swap - vulnerable to JIT liquidity</span>
<span class="s2">    _swap(amountIn, amountOut);</span>
<span class="s2">}</span>

<span class="s2">function addLiquidity(uint amount) external {</span>
<span class="s2">    // No minimum lock period</span>
<span class="s2">    _mint(msg.sender, shares);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Protected with time-weighted average liquidity (TWAL)</span>
<span class="s2">uint256 public constant MIN_LIQUIDITY_LOCK = 1 hours;</span>
<span class="s2">mapping(address =&gt; uint256) public liquidityAddedAt;</span>

<span class="s2">function addLiquidity(uint amount) external {</span>
<span class="s2">    liquidityAddedAt[msg.sender] = block.timestamp;</span>
<span class="s2">    _mint(msg.sender, shares);</span>
<span class="s2">}</span>

<span class="s2">function removeLiquidity(uint shares) external {</span>
<span class="s2">    require(</span>
<span class="s2">        block.timestamp &gt;= liquidityAddedAt[msg.sender] + MIN_LIQUIDITY_LOCK,</span>
<span class="s2">        &quot;Liquidity locked&quot;</span>
<span class="s2">    );</span>
<span class="s2">    _burn(msg.sender, shares);</span>
<span class="s2">}</span>

<span class="s2">// Use TWAP for pricing to resist manipulation</span>
<span class="s2">function getAmountOut(uint amountIn) public view returns (uint) {</span>
<span class="s2">    return oracle.consultTWAP(token, amountIn, 30 minutes);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker monitors mempool for large pending swap (e.g., 100 ETH  USDC). &quot;</span>
            <span class="s2">&quot;2. Attacker frontruns by adding massive liquidity to the pool. &quot;</span>
            <span class="s2">&quot;3. Original swap executes, paying fees to attacker&#39;s liquidity. &quot;</span>
            <span class="s2">&quot;4. Attacker backruns by removing all liquidity immediately. &quot;</span>
            <span class="s2">&quot;5. Net profit: swap fees minus gas costs.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;mev&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Common on Uniswap V3 - $100M+ extracted annually&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;jit&quot;</span><span class="p">,</span> <span class="s2">&quot;liquidity&quot;</span><span class="p">,</span> <span class="s2">&quot;frontrunning&quot;</span><span class="p">,</span> <span class="s2">&quot;amm&quot;</span><span class="p">,</span> <span class="s2">&quot;uniswap&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Time-Bandit Attack</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;MEV-TIME-BANDIT&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-362&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Time-Bandit Attack (Chain Reorg MEV)&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Miners/validators with sufficient hashpower can reorg the chain to re-execute &quot;</span>
            <span class="s2">&quot;profitable transactions (like DEX arbitrage) to capture the MEV for themselves. &quot;</span>
            <span class="s2">&quot;This undermines transaction finality and consensus security.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// High-value arbitrage visible on-chain</span>
<span class="s2">function executeArbitrage(</span>
<span class="s2">    address[] calldata path,</span>
<span class="s2">    uint amountIn</span>
<span class="s2">) external {</span>
<span class="s2">    // Large profit visible to miners</span>
<span class="s2">    uint profit = _calculateProfit(path, amountIn);</span>
<span class="s2">    require(profit &gt; 0, &quot;No profit&quot;);</span>

<span class="s2">    // Execute trades - miner can reorg and front-this</span>
<span class="s2">    _executeTrades(path, amountIn);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Use commit-reveal to hide arbitrage details</span>
<span class="s2">mapping(bytes32 =&gt; uint256) public commitments;</span>

<span class="s2">function commitArbitrage(bytes32 hash) external {</span>
<span class="s2">    commitments[hash] = block.number;</span>
<span class="s2">}</span>

<span class="s2">function executeArbitrage(</span>
<span class="s2">    bytes calldata data,</span>
<span class="s2">    bytes32 salt</span>
<span class="s2">) external {</span>
<span class="s2">    bytes32 hash = keccak256(abi.encodePacked(data, salt, msg.sender));</span>
<span class="s2">    require(commitments[hash] &gt; 0, &quot;No commitment&quot;);</span>
<span class="s2">    require(block.number &gt; commitments[hash] + 1, &quot;Wait 1 block&quot;);</span>
<span class="s2">    delete commitments[hash];</span>

<span class="s2">    // Execute with hidden details</span>
<span class="s2">    _executeFromData(data);</span>
<span class="s2">}</span>

<span class="s2">// Or use Flashbots/private mempools for MEV protection</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. User submits profitable 10 ETH arbitrage transaction. &quot;</span>
            <span class="s2">&quot;2. Miner sees transaction in their mempool with high profit. &quot;</span>
            <span class="s2">&quot;3. Miner creates competing transaction capturing the arbitrage. &quot;</span>
            <span class="s2">&quot;4. If already mined, miner with &gt;50</span><span class="si">% ha</span><span class="s2">shpower can reorg chain. &quot;</span>
            <span class="s2">&quot;5. Miner&#39;s transaction replaces user&#39;s in new canonical chain.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;mev&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Theoretical but incentivized - discussed in &#39;Flash Boys 2.0&#39; paper&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;reorg&quot;</span><span class="p">,</span> <span class="s2">&quot;time-bandit&quot;</span><span class="p">,</span> <span class="s2">&quot;consensus&quot;</span><span class="p">,</span> <span class="s2">&quot;mining&quot;</span><span class="p">,</span> <span class="s2">&quot;finality&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Long-tail MEV</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;MEV-LONG-TAIL&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-362&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Long-tail MEV Extraction&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Beyond simple arbitrage and liquidations, sophisticated MEV extraction targets &quot;</span>
            <span class="s2">&quot;NFT mints, token launches, governance votes, and complex multi-step operations. &quot;</span>
            <span class="s2">&quot;Any on-chain action with economic value is potentially exploitable.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// NFT mint without MEV protection</span>
<span class="s2">function mint(uint256 quantity) external payable {</span>
<span class="s2">    require(msg.value &gt;= price * quantity);</span>
<span class="s2">    require(totalSupply + quantity &lt;= maxSupply);</span>

<span class="s2">    // Predictable - bots can frontrun popular mints</span>
<span class="s2">    for (uint i = 0; i &lt; quantity; i++) {</span>
<span class="s2">        _safeMint(msg.sender, totalSupply + i);</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Governance vote without delay</span>
<span class="s2">function castVote(uint proposalId, bool support) external {</span>
<span class="s2">    // Vote immediately visible - can be frontrun to manipulate</span>
<span class="s2">    _castVote(msg.sender, proposalId, support);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Protected NFT mint with commit-reveal</span>
<span class="s2">mapping(bytes32 =&gt; uint256) public mintCommitments;</span>

<span class="s2">function commitMint(bytes32 hash) external payable {</span>
<span class="s2">    mintCommitments[hash] = block.timestamp;</span>
<span class="s2">}</span>

<span class="s2">function revealMint(uint256 quantity, bytes32 salt) external {</span>
<span class="s2">    bytes32 hash = keccak256(abi.encodePacked(quantity, salt, msg.sender));</span>
<span class="s2">    require(mintCommitments[hash] &gt; 0, &quot;No commitment&quot;);</span>
<span class="s2">    require(block.timestamp &gt; mintCommitments[hash] + 1 minutes, &quot;Too soon&quot;);</span>
<span class="s2">    delete mintCommitments[hash];</span>
<span class="s2">    _mint(msg.sender, quantity);</span>
<span class="s2">}</span>

<span class="s2">// Governance with snapshot voting</span>
<span class="s2">function castVote(uint proposalId, bool support) external {</span>
<span class="s2">    uint256 votingPower = token.getPastVotes(msg.sender, proposals[proposalId].snapshot);</span>
<span class="s2">    _castVote(msg.sender, proposalId, support, votingPower);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Popular NFT announces mint at specific block. &quot;</span>
            <span class="s2">&quot;2. Bots prepare bundle with high gas to frontrun. &quot;</span>
            <span class="s2">&quot;3. Bots secure all/most NFTs before regular users. &quot;</span>
            <span class="s2">&quot;4. Bots resell NFTs at markup on secondary market. &quot;</span>
            <span class="s2">&quot;5. Regular users left with nothing or forced to pay premium.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;mev&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Bored Ape Yacht Club land mint - $175M gas war (2022)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;nft&quot;</span><span class="p">,</span> <span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;frontrunning&quot;</span><span class="p">,</span> <span class="s2">&quot;long-tail&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># CROSS-CHAIN / BRIDGE VULNERABILITIES</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># Bridge Message Replay</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;BRIDGE-MESSAGE-REPLAY&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-294&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Cross-Chain Message Replay Attack&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Bridge messages that lack proper replay protection can be re-executed multiple &quot;</span>
            <span class="s2">&quot;times, allowing attackers to mint tokens or execute actions repeatedly from &quot;</span>
            <span class="s2">&quot;a single legitimate cross-chain message.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Bridge receiver without replay protection</span>
<span class="s2">function receiveMessage(</span>
<span class="s2">    bytes32 messageHash,</span>
<span class="s2">    uint256 amount,</span>
<span class="s2">    address recipient,</span>
<span class="s2">    bytes calldata signature</span>
<span class="s2">) external {</span>
<span class="s2">    // Verify signature from trusted relayer</span>
<span class="s2">    require(verifySignature(messageHash, signature), &quot;Invalid sig&quot;);</span>

<span class="s2">    // VULNERABLE: No check if message already processed</span>
<span class="s2">    token.mint(recipient, amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Protected with nonce tracking</span>
<span class="s2">mapping(bytes32 =&gt; bool) public processedMessages;</span>
<span class="s2">mapping(uint256 =&gt; uint256) public sourceChainNonces;</span>

<span class="s2">function receiveMessage(</span>
<span class="s2">    uint256 sourceChain,</span>
<span class="s2">    uint256 nonce,</span>
<span class="s2">    uint256 amount,</span>
<span class="s2">    address recipient,</span>
<span class="s2">    bytes calldata signature</span>
<span class="s2">) external {</span>
<span class="s2">    bytes32 messageHash = keccak256(abi.encodePacked(</span>
<span class="s2">        sourceChain, nonce, amount, recipient</span>
<span class="s2">    ));</span>

<span class="s2">    // Replay protection</span>
<span class="s2">    require(!processedMessages[messageHash], &quot;Already processed&quot;);</span>
<span class="s2">    require(nonce == sourceChainNonces[sourceChain] + 1, &quot;Invalid nonce&quot;);</span>
<span class="s2">    require(verifySignature(messageHash, signature), &quot;Invalid sig&quot;);</span>

<span class="s2">    processedMessages[messageHash] = true;</span>
<span class="s2">    sourceChainNonces[sourceChain] = nonce;</span>

<span class="s2">    token.mint(recipient, amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. User bridges 100 tokens from Chain A to Chain B. &quot;</span>
            <span class="s2">&quot;2. Bridge message processed, 100 tokens minted on Chain B. &quot;</span>
            <span class="s2">&quot;3. Attacker captures the signed message. &quot;</span>
            <span class="s2">&quot;4. Attacker replays same message to bridge contract. &quot;</span>
            <span class="s2">&quot;5. Another 100 tokens minted - infinite minting possible.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;bridge&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Wormhole Bridge - $320M (February 2022)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bridge&quot;</span><span class="p">,</span> <span class="s2">&quot;replay&quot;</span><span class="p">,</span> <span class="s2">&quot;cross-chain&quot;</span><span class="p">,</span> <span class="s2">&quot;signature&quot;</span><span class="p">,</span> <span class="s2">&quot;nonce&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># L2 Sequencer Downtime Risk</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;L2-SEQUENCER-DOWNTIME&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-703&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;L2 Sequencer Downtime Risk&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Layer 2 rollups depend on sequencers to order transactions. During sequencer &quot;</span>
            <span class="s2">&quot;downtime, time-sensitive operations (liquidations, oracle updates) may fail &quot;</span>
            <span class="s2">&quot;or execute at stale prices, causing protocol insolvency or user losses.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Oracle without sequencer check</span>
<span class="s2">function getLatestPrice() public view returns (uint256) {</span>
<span class="s2">    (, int256 price,, uint256 updatedAt,) = priceFeed.latestRoundData();</span>
<span class="s2">    require(block.timestamp - updatedAt &lt; 1 hours, &quot;Stale price&quot;);</span>
<span class="s2">    return uint256(price);</span>
<span class="s2">}</span>

<span class="s2">// Liquidation without sequencer awareness</span>
<span class="s2">function liquidate(address user) external {</span>
<span class="s2">    uint256 price = getLatestPrice();  // May be stale during downtime</span>
<span class="s2">    require(isUndercollateralized(user, price), &quot;Not liquidatable&quot;);</span>
<span class="s2">    _liquidate(user);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Chainlink Sequencer Uptime Feed integration</span>
<span class="s2">AggregatorV3Interface public sequencerUptimeFeed;</span>
<span class="s2">uint256 public constant GRACE_PERIOD = 1 hours;</span>

<span class="s2">function getLatestPrice() public view returns (uint256) {</span>
<span class="s2">    // Check sequencer status first</span>
<span class="s2">    (, int256 answer, uint256 startedAt,,) = sequencerUptimeFeed.latestRoundData();</span>

<span class="s2">    bool isSequencerUp = answer == 0;</span>
<span class="s2">    require(isSequencerUp, &quot;Sequencer down&quot;);</span>

<span class="s2">    // Grace period after sequencer comes back up</span>
<span class="s2">    uint256 timeSinceUp = block.timestamp - startedAt;</span>
<span class="s2">    require(timeSinceUp &gt; GRACE_PERIOD, &quot;Grace period not over&quot;);</span>

<span class="s2">    // Now safe to use price</span>
<span class="s2">    (, int256 price,, uint256 updatedAt,) = priceFeed.latestRoundData();</span>
<span class="s2">    require(block.timestamp - updatedAt &lt; 1 hours, &quot;Stale price&quot;);</span>
<span class="s2">    return uint256(price);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. L2 sequencer goes down (maintenance, attack, bug). &quot;</span>
            <span class="s2">&quot;2. Oracle prices become stale but contract doesn&#39;t know. &quot;</span>
            <span class="s2">&quot;3. Market moves significantly during downtime. &quot;</span>
            <span class="s2">&quot;4. Sequencer comes back up with queue of pending transactions. &quot;</span>
            <span class="s2">&quot;5. Liquidations execute at stale prices, causing bad debt. &quot;</span>
            <span class="s2">&quot;6. Or: Users front-run with knowledge of price movement.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;bridge&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Arbitrum sequencer downtime - multiple DeFi protocols affected&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;l2&quot;</span><span class="p">,</span> <span class="s2">&quot;sequencer&quot;</span><span class="p">,</span> <span class="s2">&quot;oracle&quot;</span><span class="p">,</span> <span class="s2">&quot;downtime&quot;</span><span class="p">,</span> <span class="s2">&quot;arbitrum&quot;</span><span class="p">,</span> <span class="s2">&quot;optimism&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Cross-Chain Oracle Manipulation</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;CROSS-CHAIN-ORACLE&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-346&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Cross-Chain Oracle Manipulation&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Protocols relying on cross-chain data without proper validation can be exploited &quot;</span>
            <span class="s2">&quot;by manipulating prices on a less-liquid chain and using that manipulated price &quot;</span>
            <span class="s2">&quot;on the target chain for borrowing, liquidation, or trading.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Bridge using single chain price</span>
<span class="s2">function bridgeWithCollateral(</span>
<span class="s2">    uint256 sourceChain,</span>
<span class="s2">    uint256 amount,</span>
<span class="s2">    address token</span>
<span class="s2">) external {</span>
<span class="s2">    // Gets price only from destination chain</span>
<span class="s2">    uint256 price = localOracle.getPrice(token);</span>
<span class="s2">    uint256 collateralValue = amount * price;</span>

<span class="s2">    require(collateralValue &gt;= minCollateral, &quot;Insufficient collateral&quot;);</span>
<span class="s2">    _bridge(msg.sender, amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Multi-chain price verification</span>
<span class="s2">mapping(uint256 =&gt; address) public chainOracles;</span>
<span class="s2">uint256 public constant MAX_PRICE_DEVIATION = 5; // 5%</span>

<span class="s2">function bridgeWithCollateral(</span>
<span class="s2">    uint256 sourceChain,</span>
<span class="s2">    uint256 amount,</span>
<span class="s2">    address token</span>
<span class="s2">) external {</span>
<span class="s2">    // Get prices from multiple chains</span>
<span class="s2">    uint256 localPrice = localOracle.getPrice(token);</span>
<span class="s2">    uint256 sourcePrice = IOracle(chainOracles[sourceChain]).getPrice(token);</span>

<span class="s2">    // Verify prices are within acceptable deviation</span>
<span class="s2">    uint256 deviation = _calculateDeviation(localPrice, sourcePrice);</span>
<span class="s2">    require(deviation &lt;= MAX_PRICE_DEVIATION, &quot;Price deviation too high&quot;);</span>

<span class="s2">    // Use conservative (lower) price for collateral</span>
<span class="s2">    uint256 price = localPrice &lt; sourcePrice ? localPrice : sourcePrice;</span>
<span class="s2">    uint256 collateralValue = amount * price;</span>

<span class="s2">    require(collateralValue &gt;= minCollateral, &quot;Insufficient collateral&quot;);</span>
<span class="s2">    _bridge(msg.sender, amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Token has thin liquidity on Chain A, deep liquidity on Chain B. &quot;</span>
            <span class="s2">&quot;2. Attacker manipulates price on Chain A (flash loan + swap). &quot;</span>
            <span class="s2">&quot;3. Bridge/lending protocol uses Chain A price as reference. &quot;</span>
            <span class="s2">&quot;4. Attacker borrows on Chain B using inflated collateral value. &quot;</span>
            <span class="s2">&quot;5. Attacker defaults, protocol left with bad debt.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;bridge&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple cross-chain lending protocols affected in 2023&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cross-chain&quot;</span><span class="p">,</span> <span class="s2">&quot;oracle&quot;</span><span class="p">,</span> <span class="s2">&quot;bridge&quot;</span><span class="p">,</span> <span class="s2">&quot;manipulation&quot;</span><span class="p">,</span> <span class="s2">&quot;multichain&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># RECENT DEFI EXPLOITS (2023-2024)</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># Curve/Vyper Reentrancy (July 2023)</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;CURVE-VYPER-REENTRANCY&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="s2">&quot;SWC-107&quot;</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-841&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Vyper Compiler Reentrancy (Curve Finance Exploit)&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Vyper compiler versions 0.2.15, 0.2.16, and 0.3.0 had a bug where the @nonreentrant &quot;</span>
            <span class="s2">&quot;decorator malfunctioned due to incorrect storage slot allocation. This allowed &quot;</span>
            <span class="s2">&quot;reentrancy attacks on contracts that appeared protected.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Vyper 0.2.15-0.3.0 - @nonreentrant was BROKEN</span>
<span class="s2">@external</span>
<span class="s2">@nonreentrant(&quot;lock&quot;)  # This lock didn&#39;t work correctly!</span>
<span class="s2">def remove_liquidity(amount: uint256):</span>
<span class="s2">    # State changes</span>
<span class="s2">    self.balances[msg.sender] -= amount</span>

<span class="s2">    # External call - should be protected but wasn&#39;t</span>
<span class="s2">    send(msg.sender, amount)  # Reentrancy possible here!</span>

<span class="s2">    # More state changes after external call</span>
<span class="s2">    self.total_supply -= amount</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Fixed in Vyper 0.3.1+</span>
<span class="s2">@external</span>
<span class="s2">@nonreentrant(&quot;lock&quot;)  # Now works correctly</span>
<span class="s2">def remove_liquidity(amount: uint256):</span>
<span class="s2">    # CEI pattern as defense-in-depth</span>
<span class="s2">    old_balance: uint256 = self.balances[msg.sender]</span>
<span class="s2">    self.balances[msg.sender] = 0  # Clear balance FIRST</span>
<span class="s2">    self.total_supply -= amount</span>

<span class="s2">    # External call AFTER state changes</span>
<span class="s2">    send(msg.sender, old_balance)</span>

<span class="s2"># Always verify Vyper version &gt;= 0.3.1 for reentrancy protection</span>
<span class="s2"># Or implement manual reentrancy guards</span>
<span class="s2">locked: bool</span>

<span class="s2">@internal</span>
<span class="s2">def _lock():</span>
<span class="s2">    assert not self.locked, &quot;Reentrant call&quot;</span>
<span class="s2">    self.locked = True</span>

<span class="s2">@internal</span>
<span class="s2">def _unlock():</span>
<span class="s2">    self.locked = False</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker identifies Curve pool using Vyper 0.2.15-0.3.0. &quot;</span>
            <span class="s2">&quot;2. @nonreentrant decorator silently fails due to compiler bug. &quot;</span>
            <span class="s2">&quot;3. Attacker calls remove_liquidity with malicious contract. &quot;</span>
            <span class="s2">&quot;4. During ETH transfer, attacker reenters remove_liquidity. &quot;</span>
            <span class="s2">&quot;5. Balance not yet updated, attacker drains pool repeatedly.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Curve Finance - $70M stolen across multiple pools (July 2023)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;vyper&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span> <span class="s2">&quot;curve&quot;</span><span class="p">,</span> <span class="s2">&quot;nonreentrant&quot;</span><span class="p">,</span> <span class="s2">&quot;defi&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Euler Finance Attack</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;EULER-DONATE-ATTACK&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-682&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Donation Attack / Collateral Manipulation&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Attacker exploits a protocol&#39;s accounting by &#39;donating&#39; tokens directly to a &quot;</span>
            <span class="s2">&quot;contract (not through deposit functions), then using the inflated balance to &quot;</span>
            <span class="s2">&quot;borrow more than legitimately collateralized, leaving bad debt.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Vulnerable collateral calculation</span>
<span class="s2">function getCollateralValue(address user) public view returns (uint256) {</span>
<span class="s2">    // Uses raw token balance - can be manipulated by donation</span>
<span class="s2">    uint256 balance = collateralToken.balanceOf(address(this));</span>
<span class="s2">    uint256 userShare = shares[user] * balance / totalShares;</span>
<span class="s2">    return userShare * getPrice();</span>
<span class="s2">}</span>

<span class="s2">function borrow(uint256 amount) external {</span>
<span class="s2">    uint256 collateral = getCollateralValue(msg.sender);</span>
<span class="s2">    require(amount &lt;= collateral * LTV / 100, &quot;Insufficient collateral&quot;);</span>
<span class="s2">    _borrow(msg.sender, amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Track deposits internally, ignore donations</span>
<span class="s2">uint256 public totalDeposited;</span>
<span class="s2">mapping(address =&gt; uint256) public userDeposits;</span>

<span class="s2">function deposit(uint256 amount) external {</span>
<span class="s2">    collateralToken.transferFrom(msg.sender, address(this), amount);</span>
<span class="s2">    userDeposits[msg.sender] += amount;</span>
<span class="s2">    totalDeposited += amount;</span>
<span class="s2">}</span>

<span class="s2">function getCollateralValue(address user) public view returns (uint256) {</span>
<span class="s2">    // Use internal accounting, not raw balance</span>
<span class="s2">    return userDeposits[user] * getPrice();</span>
<span class="s2">}</span>

<span class="s2">// Rescue function for accidentally sent tokens (admin only)</span>
<span class="s2">function rescueDonatedTokens(address token) external onlyAdmin {</span>
<span class="s2">    if (token == address(collateralToken)) {</span>
<span class="s2">        uint256 donated = collateralToken.balanceOf(address(this)) - totalDeposited;</span>
<span class="s2">        collateralToken.transfer(treasury, donated);</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker takes flash loan of large token amount. &quot;</span>
            <span class="s2">&quot;2. Attacker deposits small amount as collateral normally. &quot;</span>
            <span class="s2">&quot;3. Attacker &#39;donates&#39; flash loaned tokens directly to contract. &quot;</span>
            <span class="s2">&quot;4. Contract&#39;s raw balance is now inflated. &quot;</span>
            <span class="s2">&quot;5. Attacker&#39;s collateral value appears much higher. &quot;</span>
            <span class="s2">&quot;6. Attacker borrows maximum against inflated collateral. &quot;</span>
            <span class="s2">&quot;7. Attacker withdraws borrowed funds and defaults.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;defi&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Euler Finance - $197M stolen (March 2023)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;donation&quot;</span><span class="p">,</span> <span class="s2">&quot;flash-loan&quot;</span><span class="p">,</span> <span class="s2">&quot;collateral&quot;</span><span class="p">,</span> <span class="s2">&quot;euler&quot;</span><span class="p">,</span> <span class="s2">&quot;accounting&quot;</span><span class="p">,</span> <span class="s2">&quot;defi&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># LP Token Inflation Attack</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;LP-INFLATION-ATTACK&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-682&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;LP Token Share Inflation Attack&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;First depositor in an empty vault/pool can manipulate share price by depositing &quot;</span>
            <span class="s2">&quot;minimum amount, then donating tokens. Subsequent depositors receive zero or minimal &quot;</span>
            <span class="s2">&quot;shares due to rounding in their favor.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Vulnerable share calculation</span>
<span class="s2">function deposit(uint256 assets) external returns (uint256 shares) {</span>
<span class="s2">    if (totalSupply == 0) {</span>
<span class="s2">        shares = assets;  // First deposit: 1:1 ratio</span>
<span class="s2">    } else {</span>
<span class="s2">        // shares = assets * totalSupply / totalAssets</span>
<span class="s2">        shares = assets * totalSupply / token.balanceOf(address(this));</span>
<span class="s2">    }</span>

<span class="s2">    require(shares &gt; 0, &quot;Zero shares&quot;);</span>
<span class="s2">    _mint(msg.sender, shares);</span>
<span class="s2">    token.transferFrom(msg.sender, address(this), assets);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Protected with virtual shares and minimum deposit</span>
<span class="s2">uint256 internal constant MINIMUM_SHARES = 1000;</span>
<span class="s2">uint256 internal constant VIRTUAL_ASSETS = 1;</span>
<span class="s2">uint256 internal constant VIRTUAL_SHARES = 1;</span>

<span class="s2">function deposit(uint256 assets) external returns (uint256 shares) {</span>
<span class="s2">    uint256 supply = totalSupply + VIRTUAL_SHARES;</span>
<span class="s2">    uint256 totalAssets = token.balanceOf(address(this)) + VIRTUAL_ASSETS;</span>

<span class="s2">    shares = assets * supply / totalAssets;</span>
<span class="s2">    require(shares &gt;= MINIMUM_SHARES, &quot;Shares below minimum&quot;);</span>

<span class="s2">    _mint(msg.sender, shares);</span>
<span class="s2">    token.transferFrom(msg.sender, address(this), assets);</span>
<span class="s2">}</span>

<span class="s2">// Or: Burn initial shares to dead address</span>
<span class="s2">function _initializePool(uint256 initialDeposit) internal {</span>
<span class="s2">    uint256 shares = initialDeposit;</span>
<span class="s2">    _mint(address(0xdead), MINIMUM_SHARES);  // Burn minimum</span>
<span class="s2">    _mint(msg.sender, shares - MINIMUM_SHARES);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Pool is empty (totalSupply = 0). &quot;</span>
            <span class="s2">&quot;2. Attacker deposits 1 wei, receives 1 share. &quot;</span>
            <span class="s2">&quot;3. Attacker donates 1e18 tokens directly to pool. &quot;</span>
            <span class="s2">&quot;4. Share price is now 1e18 tokens per share. &quot;</span>
            <span class="s2">&quot;5. Victim deposits 1.9e18 tokens. &quot;</span>
            <span class="s2">&quot;6. Victim receives 1.9e18 * 1 / 1e18 = 1 share (rounded down to 1). &quot;</span>
            <span class="s2">&quot;7. Attacker withdraws, taking majority of victim&#39;s deposit.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;vault&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple ERC-4626 vault implementations affected&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;inflation&quot;</span><span class="p">,</span> <span class="s2">&quot;vault&quot;</span><span class="p">,</span> <span class="s2">&quot;lp&quot;</span><span class="p">,</span> <span class="s2">&quot;shares&quot;</span><span class="p">,</span> <span class="s2">&quot;rounding&quot;</span><span class="p">,</span> <span class="s2">&quot;first-depositor&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># NFT-SPECIFIC VULNERABILITIES</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># Unlimited NFT Mint</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;NFT-UNLIMITED-MINT&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-284&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Unlimited NFT Mint Vulnerability&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;NFT contracts without proper mint limits per wallet allow attackers to mint &quot;</span>
            <span class="s2">&quot;entire supply or bypass whitelist restrictions using multiple transactions &quot;</span>
            <span class="s2">&quot;or contract-based minting.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Vulnerable mint function</span>
<span class="s2">uint256 public constant MAX_SUPPLY = 10000;</span>
<span class="s2">uint256 public constant MINT_PRICE = 0.08 ether;</span>

<span class="s2">function mint(uint256 quantity) external payable {</span>
<span class="s2">    require(totalSupply + quantity &lt;= MAX_SUPPLY, &quot;Exceeds supply&quot;);</span>
<span class="s2">    require(msg.value &gt;= MINT_PRICE * quantity, &quot;Insufficient payment&quot;);</span>

<span class="s2">    // No per-wallet limit - can mint entire supply</span>
<span class="s2">    for (uint i = 0; i &lt; quantity; i++) {</span>
<span class="s2">        _safeMint(msg.sender, totalSupply + i);</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Whitelist bypass - contract can call multiple times</span>
<span class="s2">function whitelistMint() external {</span>
<span class="s2">    require(whitelist[msg.sender], &quot;Not whitelisted&quot;);</span>
<span class="s2">    _safeMint(msg.sender, totalSupply);</span>
<span class="s2">    // Whitelist not cleared - can mint again!</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">uint256 public constant MAX_PER_WALLET = 3;</span>
<span class="s2">uint256 public constant MAX_PER_TX = 5;</span>
<span class="s2">mapping(address =&gt; uint256) public mintedCount;</span>

<span class="s2">function mint(uint256 quantity) external payable {</span>
<span class="s2">    require(quantity &lt;= MAX_PER_TX, &quot;Exceeds tx limit&quot;);</span>
<span class="s2">    require(mintedCount[msg.sender] + quantity &lt;= MAX_PER_WALLET, &quot;Exceeds wallet limit&quot;);</span>
<span class="s2">    require(totalSupply + quantity &lt;= MAX_SUPPLY, &quot;Exceeds supply&quot;);</span>
<span class="s2">    require(msg.value &gt;= MINT_PRICE * quantity, &quot;Insufficient payment&quot;);</span>

<span class="s2">    // Prevent contract minting (optional)</span>
<span class="s2">    require(msg.sender == tx.origin, &quot;No contract minting&quot;);</span>

<span class="s2">    mintedCount[msg.sender] += quantity;</span>

<span class="s2">    for (uint i = 0; i &lt; quantity; i++) {</span>
<span class="s2">        _safeMint(msg.sender, totalSupply + i);</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">function whitelistMint() external {</span>
<span class="s2">    require(whitelist[msg.sender], &quot;Not whitelisted&quot;);</span>
<span class="s2">    require(!whitelistMinted[msg.sender], &quot;Already minted&quot;);</span>

<span class="s2">    whitelistMinted[msg.sender] = true;  // Mark as minted</span>
<span class="s2">    _safeMint(msg.sender, totalSupply);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker deploys contract that calls mint() in loop. &quot;</span>
            <span class="s2">&quot;2. Attacker mints entire supply before regular users. &quot;</span>
            <span class="s2">&quot;3. Or: Attacker uses multiple wallets for whitelist mint. &quot;</span>
            <span class="s2">&quot;4. Regular users unable to mint, supply exhausted. &quot;</span>
            <span class="s2">&quot;5. Attacker sells NFTs at markup on secondary market.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;nft&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple NFT projects suffered &#39;bot&#39; mints in 2021-2022&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nft&quot;</span><span class="p">,</span> <span class="s2">&quot;mint&quot;</span><span class="p">,</span> <span class="s2">&quot;unlimited&quot;</span><span class="p">,</span> <span class="s2">&quot;bot&quot;</span><span class="p">,</span> <span class="s2">&quot;whitelist&quot;</span><span class="p">,</span> <span class="s2">&quot;erc721&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># NFT Royalty Bypass</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;NFT-ROYALTY-BYPASS&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-284&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;NFT Royalty Bypass via Wrapper Contracts&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;NFT royalties are not enforced at the protocol level. Marketplaces or wrapper &quot;</span>
            <span class="s2">&quot;contracts can facilitate royalty-free transfers by wrapping NFTs or using &quot;</span>
            <span class="s2">&quot;alternative transfer mechanisms that bypass royalty checks.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Standard ERC-721 with royalty info (EIP-2981)</span>
<span class="s2">function royaltyInfo(uint256 tokenId, uint256 salePrice)</span>
<span class="s2">    external view returns (address receiver, uint256 royaltyAmount)</span>
<span class="s2">{</span>
<span class="s2">    return (royaltyReceiver, salePrice * royaltyBps / 10000);</span>
<span class="s2">}</span>

<span class="s2">// Problem: royaltyInfo is just informational</span>
<span class="s2">// Nothing prevents direct transfers bypassing marketplace</span>
<span class="s2">function transferFrom(address from, address to, uint256 tokenId) public {</span>
<span class="s2">    // No royalty enforcement here</span>
<span class="s2">    _transfer(from, to, tokenId);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Operator filter registry (OpenSea&#39;s approach)</span>
<span class="s2">import </span><span class="si">{OperatorFilterer}</span><span class="s2"> from &quot;operator-filter-registry/OperatorFilterer.sol&quot;;</span>

<span class="s2">contract ProtectedNFT is ERC721, OperatorFilterer {</span>
<span class="s2">    constructor() OperatorFilterer(CANONICAL_OPERATOR_FILTER_REGISTRY, true) </span><span class="si">{}</span>

<span class="s2">    function transferFrom(address from, address to, uint256 tokenId)</span>
<span class="s2">        public</span>
<span class="s2">        override</span>
<span class="s2">        onlyAllowedOperator(from)  // Blocks blacklisted operators</span>
<span class="s2">    {</span>
<span class="s2">        super.transferFrom(from, to, tokenId);</span>
<span class="s2">    }</span>

<span class="s2">    function safeTransferFrom(address from, address to, uint256 tokenId)</span>
<span class="s2">        public</span>
<span class="s2">        override</span>
<span class="s2">        onlyAllowedOperator(from)</span>
<span class="s2">    {</span>
<span class="s2">        super.safeTransferFrom(from, to, tokenId);</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Alternative: On-chain royalty enforcement</span>
<span class="s2">function _beforeTokenTransfer(address from, address to, uint256 tokenId) internal {</span>
<span class="s2">    if (from != address(0) &amp;&amp; to != address(0)) {</span>
<span class="s2">        // Require royalty payment for non-mint transfers</span>
<span class="s2">        require(royaltyPaid[tokenId], &quot;Pay royalty first&quot;);</span>
<span class="s2">        royaltyPaid[tokenId] = false;  // Reset for next transfer</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Creator sets 5</span><span class="si">% r</span><span class="s2">oyalty on NFT collection. &quot;</span>
            <span class="s2">&quot;2. Buyer and seller agree to trade off-marketplace. &quot;</span>
            <span class="s2">&quot;3. Seller calls transferFrom() directly to buyer. &quot;</span>
            <span class="s2">&quot;4. Buyer sends payment via separate transaction. &quot;</span>
            <span class="s2">&quot;5. Creator receives 0</span><span class="si">% r</span><span class="s2">oyalty on sale.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;nft&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Blur, SudoSwap, and others enabled royalty-optional trading (2022-2023)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nft&quot;</span><span class="p">,</span> <span class="s2">&quot;royalty&quot;</span><span class="p">,</span> <span class="s2">&quot;bypass&quot;</span><span class="p">,</span> <span class="s2">&quot;erc721&quot;</span><span class="p">,</span> <span class="s2">&quot;eip2981&quot;</span><span class="p">,</span> <span class="s2">&quot;marketplace&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># ADVANCED PROXY / UPGRADEABLE PATTERNS</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># Diamond Proxy Storage Collision</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;DIAMOND-STORAGE-COLLISION&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-787&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Diamond Proxy (EIP-2535) Storage Collision&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Diamond proxies use multiple facets that share storage. Without careful &quot;</span>
            <span class="s2">&quot;storage slot management, facets can accidentally overwrite each other&#39;s &quot;</span>
            <span class="s2">&quot;state, corrupting data or enabling exploits.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Facet A - Uses storage starting at slot 0</span>
<span class="s2">contract FacetA {</span>
<span class="s2">    uint256 public valueA;  // Slot 0</span>
<span class="s2">    address public owner;   // Slot 1</span>

<span class="s2">    function setValueA(uint256 _value) external {</span>
<span class="s2">        valueA = _value;</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Facet B - COLLISION: Also uses slot 0!</span>
<span class="s2">contract FacetB {</span>
<span class="s2">    uint256 public valueB;  // Slot 0 - OVERWRITES valueA!</span>
<span class="s2">    mapping(address =&gt; uint256) balances;  // Slot 1 - CORRUPTS owner!</span>

<span class="s2">    function setValueB(uint256 _value) external {</span>
<span class="s2">        valueB = _value;  // This overwrites FacetA.valueA</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Diamond Storage Pattern - Each facet uses unique storage slot</span>
<span class="s2">library LibDiamond {</span>
<span class="s2">    bytes32 constant DIAMOND_STORAGE_POSITION =</span>
<span class="s2">        keccak256(&quot;diamond.standard.diamond.storage&quot;);</span>

<span class="s2">    struct DiamondStorage {</span>
<span class="s2">        mapping(bytes4 =&gt; address) facetAddresses;</span>
<span class="s2">        address contractOwner;</span>
<span class="s2">    }</span>

<span class="s2">    function diamondStorage() internal pure returns (DiamondStorage storage ds) {</span>
<span class="s2">        bytes32 position = DIAMOND_STORAGE_POSITION;</span>
<span class="s2">        assembly {</span>
<span class="s2">            ds.slot := position</span>
<span class="s2">        }</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Facet A - Unique storage slot</span>
<span class="s2">library LibFacetA {</span>
<span class="s2">    bytes32 constant STORAGE_POSITION = keccak256(&quot;myproject.facetA.storage&quot;);</span>

<span class="s2">    struct Storage {</span>
<span class="s2">        uint256 valueA;</span>
<span class="s2">        mapping(address =&gt; uint256) dataA;</span>
<span class="s2">    }</span>

<span class="s2">    function getStorage() internal pure returns (Storage storage s) {</span>
<span class="s2">        bytes32 position = STORAGE_POSITION;</span>
<span class="s2">        assembly {</span>
<span class="s2">            s.slot := position</span>
<span class="s2">        }</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">contract FacetA {</span>
<span class="s2">    function setValueA(uint256 _value) external {</span>
<span class="s2">        LibFacetA.getStorage().valueA = _value;</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Diamond proxy deployed with FacetA managing access control. &quot;</span>
            <span class="s2">&quot;2. FacetB added later, developer unaware of storage layout. &quot;</span>
            <span class="s2">&quot;3. FacetB.setValueB() called with attacker&#39;s address. &quot;</span>
            <span class="s2">&quot;4. This overwrites FacetA.owner at slot 1. &quot;</span>
            <span class="s2">&quot;5. Attacker now has owner privileges across all facets.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;proxy&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple Diamond implementations have had storage issues&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span> <span class="s2">&quot;proxy&quot;</span><span class="p">,</span> <span class="s2">&quot;storage&quot;</span><span class="p">,</span> <span class="s2">&quot;collision&quot;</span><span class="p">,</span> <span class="s2">&quot;eip2535&quot;</span><span class="p">,</span> <span class="s2">&quot;upgradeable&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Beacon Proxy Initialization</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;BEACON-PROXY-UNINIT&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-665&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Beacon Proxy Uninitialized Implementation&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Beacon proxies point to a shared implementation. If the implementation &quot;</span>
            <span class="s2">&quot;contract itself is not properly initialized, attackers can initialize it &quot;</span>
            <span class="s2">&quot;and potentially gain control or disrupt all proxies using that beacon.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Implementation contract - VULNERABLE</span>
<span class="s2">contract TokenImplementation is Initializable {</span>
<span class="s2">    address public owner;</span>

<span class="s2">    function initialize(address _owner) external initializer {</span>
<span class="s2">        owner = _owner;</span>
<span class="s2">    }</span>

<span class="s2">    function mint(address to, uint256 amount) external {</span>
<span class="s2">        require(msg.sender == owner, &quot;Not owner&quot;);</span>
<span class="s2">        _mint(to, amount);</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Deployment - Implementation left uninitialized!</span>
<span class="s2">TokenImplementation impl = new TokenImplementation();</span>
<span class="s2">// impl.initialize() NOT CALLED - anyone can call it!</span>

<span class="s2">UpgradeableBeacon beacon = new UpgradeableBeacon(address(impl));</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Protected implementation</span>
<span class="s2">contract TokenImplementation is Initializable {</span>
<span class="s2">    address public owner;</span>

<span class="s2">    /// @custom:oz-upgrades-unsafe-allow constructor</span>
<span class="s2">    constructor() {</span>
<span class="s2">        _disableInitializers();  // Prevents initialization of implementation</span>
<span class="s2">    }</span>

<span class="s2">    function initialize(address _owner) external initializer {</span>
<span class="s2">        owner = _owner;</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// Or: Initialize implementation to dead address</span>
<span class="s2">TokenImplementation impl = new TokenImplementation();</span>
<span class="s2">impl.initialize(address(0xdead));  // Initialize with unusable owner</span>

<span class="s2">UpgradeableBeacon beacon = new UpgradeableBeacon(address(impl));</span>

<span class="s2">// Each proxy still gets its own initialization</span>
<span class="s2">BeaconProxy proxy = new BeaconProxy(</span>
<span class="s2">    address(beacon),</span>
<span class="s2">    abi.encodeWithSelector(TokenImplementation.initialize.selector, realOwner)</span>
<span class="s2">);</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Protocol deploys beacon with uninitialized implementation. &quot;</span>
            <span class="s2">&quot;2. Attacker calls implementation.initialize(attackerAddress). &quot;</span>
            <span class="s2">&quot;3. Attacker is now owner of the implementation contract. &quot;</span>
            <span class="s2">&quot;4. If implementation has selfdestruct, attacker can destroy it. &quot;</span>
            <span class="s2">&quot;5. All beacon proxies now point to destroyed/malicious implementation.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;proxy&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Wormhole uninitialized implementation - $320M at risk&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;beacon&quot;</span><span class="p">,</span> <span class="s2">&quot;proxy&quot;</span><span class="p">,</span> <span class="s2">&quot;initialization&quot;</span><span class="p">,</span> <span class="s2">&quot;upgradeable&quot;</span><span class="p">,</span> <span class="s2">&quot;implementation&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># ZK CIRCUIT VULNERABILITIES</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># Underconstrained Circuit</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;ZK-UNDERCONSTRAINED&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-682&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Underconstrained ZK Circuit&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Zero-knowledge circuits must fully constrain all variables. Underconstrained &quot;</span>
            <span class="s2">&quot;circuits allow multiple valid witness values for the same public inputs, &quot;</span>
            <span class="s2">&quot;enabling attackers to forge proofs or bypass verification.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Circom - Underconstrained multiplier</span>
<span class="s2">template Multiplier() {</span>
<span class="s2">    signal input a;</span>
<span class="s2">    signal input b;</span>
<span class="s2">    signal output c;</span>

<span class="s2">    c &lt;-- a * b;  // Assignment only, NO constraint!</span>
<span class="s2">    // Prover can set c to anything</span>
<span class="s2">}</span>

<span class="s2">// Missing constraint example</span>
<span class="s2">template RangeCheck(n) {</span>
<span class="s2">    signal input value;</span>
<span class="s2">    signal bits[n];</span>

<span class="s2">    var sum = 0;</span>
<span class="s2">    for (var i = 0; i &lt; n; i++) {</span>
<span class="s2">        bits[i] &lt;-- (value &gt;&gt; i) &amp; 1;  // Assignment only</span>
<span class="s2">        sum += bits[i] * (2 ** i);</span>
<span class="s2">        // Missing: bits[i] * (bits[i] - 1) === 0</span>
<span class="s2">    }</span>
<span class="s2">    // Missing: sum === value</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Properly constrained multiplier</span>
<span class="s2">template Multiplier() {</span>
<span class="s2">    signal input a;</span>
<span class="s2">    signal input b;</span>
<span class="s2">    signal output c;</span>

<span class="s2">    c &lt;== a * b;  // &lt;== creates constraint: c === a * b</span>
<span class="s2">}</span>

<span class="s2">// Properly constrained range check</span>
<span class="s2">template RangeCheck(n) {</span>
<span class="s2">    signal input value;</span>
<span class="s2">    signal bits[n];</span>

<span class="s2">    var sum = 0;</span>
<span class="s2">    for (var i = 0; i &lt; n; i++) {</span>
<span class="s2">        bits[i] &lt;-- (value &gt;&gt; i) &amp; 1;</span>
<span class="s2">        bits[i] * (bits[i] - 1) === 0;  // Constraint: bit is 0 or 1</span>
<span class="s2">        sum += bits[i] * (2 ** i);</span>
<span class="s2">    }</span>
<span class="s2">    sum === value;  // Constraint: bits reconstruct value</span>
<span class="s2">}</span>

<span class="s2">// Use established libraries</span>
<span class="s2">include &quot;circomlib/circuits/comparators.circom&quot;;</span>
<span class="s2">component rangeCheck = LessThan(252);</span>
<span class="s2">rangeCheck.in[0] &lt;== value;</span>
<span class="s2">rangeCheck.in[1] &lt;== maxValue;</span>
<span class="s2">rangeCheck.out === 1;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. ZK rollup uses underconstrained circuit for transfers. &quot;</span>
            <span class="s2">&quot;2. Circuit doesn&#39;t fully constrain balance updates. &quot;</span>
            <span class="s2">&quot;3. Attacker generates proof with arbitrary balance. &quot;</span>
            <span class="s2">&quot;4. Proof passes verification despite invalid state transition. &quot;</span>
            <span class="s2">&quot;5. Attacker mints tokens or steals funds from rollup.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;zk&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Zcash counterfeiting vulnerability (2019) - fixed before exploitation&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;zk&quot;</span><span class="p">,</span> <span class="s2">&quot;circom&quot;</span><span class="p">,</span> <span class="s2">&quot;underconstrained&quot;</span><span class="p">,</span> <span class="s2">&quot;snark&quot;</span><span class="p">,</span> <span class="s2">&quot;circuit&quot;</span><span class="p">,</span> <span class="s2">&quot;proof&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># ZK Nullifier Collision</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;ZK-NULLIFIER-COLLISION&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-327&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ZK Nullifier Collision / Double-Spend&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Privacy protocols use nullifiers to prevent double-spending without revealing &quot;</span>
            <span class="s2">&quot;which note is spent. Weak nullifier derivation or missing uniqueness checks &quot;</span>
            <span class="s2">&quot;can enable double-spends or nullifier grinding attacks.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Weak nullifier derivation</span>
<span class="s2">template SpendNote() {</span>
<span class="s2">    signal input secret;</span>
<span class="s2">    signal input noteIndex;</span>
<span class="s2">    signal output nullifier;</span>

<span class="s2">    // VULNERABLE: Nullifier only depends on secret</span>
<span class="s2">    // Same secret = same nullifier across all notes</span>
<span class="s2">    nullifier &lt;== hash(secret);</span>
<span class="s2">}</span>

<span class="s2">// Missing nullifier check in contract</span>
<span class="s2">contract PrivacyPool {</span>
<span class="s2">    mapping(bytes32 =&gt; bool) public nullifiers;</span>

<span class="s2">    function withdraw(bytes calldata proof, bytes32 nullifier) external {</span>
<span class="s2">        // VULNERABLE: Check happens after state change</span>
<span class="s2">        require(verifyProof(proof), &quot;Invalid proof&quot;);</span>

<span class="s2">        // Race condition possible</span>
<span class="s2">        nullifiers[nullifier] = true;</span>

<span class="s2">        payable(msg.sender).transfer(AMOUNT);</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Proper nullifier derivation</span>
<span class="s2">template SpendNote() {</span>
<span class="s2">    signal input secret;</span>
<span class="s2">    signal input noteCommitment;  // Unique per note</span>
<span class="s2">    signal input leafIndex;       // Position in Merkle tree</span>
<span class="s2">    signal output nullifier;</span>

<span class="s2">    // Nullifier uniquely tied to specific note</span>
<span class="s2">    nullifier &lt;== hash(secret, noteCommitment, leafIndex);</span>
<span class="s2">}</span>

<span class="s2">// Safe nullifier handling</span>
<span class="s2">contract PrivacyPool {</span>
<span class="s2">    mapping(bytes32 =&gt; bool) public nullifiers;</span>

<span class="s2">    function withdraw(</span>
<span class="s2">        bytes calldata proof,</span>
<span class="s2">        bytes32 nullifier,</span>
<span class="s2">        bytes32 root</span>
<span class="s2">    ) external nonReentrant {</span>
<span class="s2">        // Check nullifier FIRST</span>
<span class="s2">        require(!nullifiers[nullifier], &quot;Note already spent&quot;);</span>
<span class="s2">        require(isKnownRoot(root), &quot;Unknown root&quot;);</span>
<span class="s2">        require(verifyProof(proof, nullifier, root), &quot;Invalid proof&quot;);</span>

<span class="s2">        // Mark spent BEFORE transfer</span>
<span class="s2">        nullifiers[nullifier] = true;</span>

<span class="s2">        payable(msg.sender).transfer(AMOUNT);</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. User deposits 1 ETH, receives note commitment. &quot;</span>
            <span class="s2">&quot;2. User generates nullifier and withdraws 1 ETH. &quot;</span>
            <span class="s2">&quot;3. Due to weak derivation, user can generate same nullifier for different &#39;note&#39;. &quot;</span>
            <span class="s2">&quot;4. User submits second withdrawal with same nullifier. &quot;</span>
            <span class="s2">&quot;5. If nullifier check is missing/weak, user withdraws twice.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;zk&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Tornado Cash fork vulnerabilities discovered in 2023&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;zk&quot;</span><span class="p">,</span> <span class="s2">&quot;nullifier&quot;</span><span class="p">,</span> <span class="s2">&quot;double-spend&quot;</span><span class="p">,</span> <span class="s2">&quot;privacy&quot;</span><span class="p">,</span> <span class="s2">&quot;tornado&quot;</span><span class="p">,</span> <span class="s2">&quot;merkle&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># DEFI PROTOCOL-SPECIFIC PATTERNS</span>
    <span class="c1"># =========================================================================</span>
    <span class="c1"># Compound Fork Interest Rate Manipulation</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;COMPOUND-INTEREST-MANIPULATION&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-682&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Interest Rate Model Manipulation&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Compound-style lending protocols calculate interest rates based on utilization. &quot;</span>
            <span class="s2">&quot;Attackers can manipulate utilization via large flash-borrowed deposits/withdrawals &quot;</span>
            <span class="s2">&quot;to spike rates and force liquidations or extract value from rate-sensitive positions.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Simple interest rate model</span>
<span class="s2">function getBorrowRate(uint256 cash, uint256 borrows) public pure returns (uint256) {</span>
<span class="s2">    uint256 utilization = borrows * 1e18 / (cash + borrows);</span>

<span class="s2">    // Linear model - easily manipulable</span>
<span class="s2">    return baseRate + utilization * multiplier / 1e18;</span>
<span class="s2">}</span>

<span class="s2">// Vulnerable to flash loan manipulation</span>
<span class="s2">function accrueInterest() external {</span>
<span class="s2">    uint256 rate = getBorrowRate(getCash(), totalBorrows);</span>
<span class="s2">    uint256 interestAccumulated = rate * (block.timestamp - lastAccrual);</span>

<span class="s2">    // Interest spikes immediately based on current utilization</span>
<span class="s2">    totalBorrows += interestAccumulated;</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Time-weighted utilization</span>
<span class="s2">uint256 public lastUtilization;</span>
<span class="s2">uint256 public lastUtilizationUpdate;</span>
<span class="s2">uint256 public constant SMOOTHING_PERIOD = 1 hours;</span>

<span class="s2">function getSmoothedUtilization() public view returns (uint256) {</span>
<span class="s2">    uint256 currentUtil = getCurrentUtilization();</span>
<span class="s2">    uint256 elapsed = block.timestamp - lastUtilizationUpdate;</span>

<span class="s2">    if (elapsed &gt;= SMOOTHING_PERIOD) {</span>
<span class="s2">        return currentUtil;</span>
<span class="s2">    }</span>

<span class="s2">    // Exponential smoothing</span>
<span class="s2">    uint256 weight = elapsed * 1e18 / SMOOTHING_PERIOD;</span>
<span class="s2">    return (lastUtilization * (1e18 - weight) + currentUtil * weight) / 1e18;</span>
<span class="s2">}</span>

<span class="s2">function getBorrowRate() public view returns (uint256) {</span>
<span class="s2">    uint256 utilization = getSmoothedUtilization();</span>

<span class="s2">    // Kinked model with dampening</span>
<span class="s2">    if (utilization &lt;= kink) {</span>
<span class="s2">        return baseRate + utilization * multiplierPerBlock / 1e18;</span>
<span class="s2">    } else {</span>
<span class="s2">        uint256 normalRate = baseRate + kink * multiplierPerBlock / 1e18;</span>
<span class="s2">        uint256 excessUtil = utilization - kink;</span>
<span class="s2">        return normalRate + excessUtil * jumpMultiplier / 1e18;</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Protocol has $10M deposits, $5M borrows (50</span><span class="si">% u</span><span class="s2">tilization, 5</span><span class="si">% r</span><span class="s2">ate). &quot;</span>
            <span class="s2">&quot;2. Attacker flash loans $9M. &quot;</span>
            <span class="s2">&quot;3. Attacker withdraws $9M from protocol (leaving $1M cash). &quot;</span>
            <span class="s2">&quot;4. Utilization spikes to 83%, rate jumps to 20%. &quot;</span>
            <span class="s2">&quot;5. Interest accrues at manipulated rate. &quot;</span>
            <span class="s2">&quot;6. Attacker redeposits $9M, repays flash loan. &quot;</span>
            <span class="s2">&quot;7. Protocol accrued excess interest, borrowers damaged.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;defi&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Cream Finance interest rate manipulation (2021)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;compound&quot;</span><span class="p">,</span> <span class="s2">&quot;interest-rate&quot;</span><span class="p">,</span> <span class="s2">&quot;utilization&quot;</span><span class="p">,</span> <span class="s2">&quot;flash-loan&quot;</span><span class="p">,</span> <span class="s2">&quot;lending&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Governance Proposal Spam</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;GOV-PROPOSAL-SPAM&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-400&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Governance Proposal Spam / DoS&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Governance systems without adequate proposal thresholds or rate limiting &quot;</span>
            <span class="s2">&quot;can be spammed with proposals, overwhelming voters, hiding malicious proposals &quot;</span>
            <span class="s2">&quot;among benign ones, or consuming gas for on-chain execution.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Vulnerable governance - low barrier to propose</span>
<span class="s2">contract Governance {</span>
<span class="s2">    uint256 public constant PROPOSAL_THRESHOLD = 100e18;  // Only 100 tokens</span>

<span class="s2">    function propose(</span>
<span class="s2">        address[] memory targets,</span>
<span class="s2">        uint256[] memory values,</span>
<span class="s2">        bytes[] memory calldatas,</span>
<span class="s2">        string memory description</span>
<span class="s2">    ) external returns (uint256) {</span>
<span class="s2">        require(token.balanceOf(msg.sender) &gt;= PROPOSAL_THRESHOLD, &quot;Below threshold&quot;);</span>

<span class="s2">        // No rate limiting - can spam proposals</span>
<span class="s2">        uint256 proposalId = _createProposal(targets, values, calldatas, description);</span>
<span class="s2">        return proposalId;</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">contract Governance {</span>
<span class="s2">    uint256 public constant PROPOSAL_THRESHOLD = 10000e18;  // 10,000 tokens (1</span><span class="si">% s</span><span class="s2">upply)</span>
<span class="s2">    uint256 public constant MAX_ACTIVE_PROPOSALS = 10;</span>
<span class="s2">    uint256 public constant PROPOSAL_COOLDOWN = 7 days;</span>

<span class="s2">    mapping(address =&gt; uint256) public lastProposalTime;</span>
<span class="s2">    uint256 public activeProposalCount;</span>

<span class="s2">    function propose(</span>
<span class="s2">        address[] memory targets,</span>
<span class="s2">        uint256[] memory values,</span>
<span class="s2">        bytes[] memory calldatas,</span>
<span class="s2">        string memory description</span>
<span class="s2">    ) external returns (uint256) {</span>
<span class="s2">        require(</span>
<span class="s2">            token.getPastVotes(msg.sender, block.number - 1) &gt;= PROPOSAL_THRESHOLD,</span>
<span class="s2">            &quot;Below threshold&quot;</span>
<span class="s2">        );</span>
<span class="s2">        require(activeProposalCount &lt; MAX_ACTIVE_PROPOSALS, &quot;Too many proposals&quot;);</span>
<span class="s2">        require(</span>
<span class="s2">            block.timestamp &gt;= lastProposalTime[msg.sender] + PROPOSAL_COOLDOWN,</span>
<span class="s2">            &quot;Cooldown active&quot;</span>
<span class="s2">        );</span>

<span class="s2">        lastProposalTime[msg.sender] = block.timestamp;</span>
<span class="s2">        activeProposalCount++;</span>

<span class="s2">        return _createProposal(targets, values, calldatas, description);</span>
<span class="s2">    }</span>

<span class="s2">    function _finalizeProposal(uint256 proposalId) internal {</span>
<span class="s2">        activeProposalCount--;</span>
<span class="s2">        // ...</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker acquires minimal token threshold. &quot;</span>
            <span class="s2">&quot;2. Attacker submits hundreds of trivial proposals. &quot;</span>
            <span class="s2">&quot;3. Real malicious proposal hidden among spam. &quot;</span>
            <span class="s2">&quot;4. Voters overwhelmed, don&#39;t review all proposals. &quot;</span>
            <span class="s2">&quot;5. Malicious proposal passes unnoticed.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Beanstalk governance attack used distraction proposals (2022)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;proposal&quot;</span><span class="p">,</span> <span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;dos&quot;</span><span class="p">,</span> <span class="s2">&quot;voting&quot;</span><span class="p">,</span> <span class="s2">&quot;dao&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Airdrop Claim Vulnerability</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;AIRDROP-CLAIM-VULN&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-284&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Airdrop Merkle Proof Vulnerabilities&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Airdrop contracts using Merkle proofs can have vulnerabilities in proof &quot;</span>
            <span class="s2">&quot;verification, allowing attackers to claim more than allocated, claim on &quot;</span>
            <span class="s2">&quot;behalf of others, or replay claims across different airdrops.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Vulnerable airdrop - weak leaf encoding</span>
<span class="s2">contract Airdrop {</span>
<span class="s2">    bytes32 public merkleRoot;</span>
<span class="s2">    mapping(address =&gt; bool) public claimed;</span>

<span class="s2">    function claim(uint256 amount, bytes32[] calldata proof) external {</span>
<span class="s2">        require(!claimed[msg.sender], &quot;Already claimed&quot;);</span>

<span class="s2">        // VULNERABLE: Leaf doesn&#39;t include msg.sender binding</span>
<span class="s2">        bytes32 leaf = keccak256(abi.encodePacked(amount));</span>
<span class="s2">        require(MerkleProof.verify(proof, merkleRoot, leaf), &quot;Invalid proof&quot;);</span>

<span class="s2">        claimed[msg.sender] = true;</span>
<span class="s2">        token.transfer(msg.sender, amount);</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">// VULNERABLE: Second preimage attack possible</span>
<span class="s2">bytes32 leaf = keccak256(abi.encodePacked(address, amount));</span>
<span class="s2">// If address + amount = 64 bytes, could match intermediate node</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">contract Airdrop {</span>
<span class="s2">    bytes32 public merkleRoot;</span>
<span class="s2">    mapping(address =&gt; bool) public claimed;</span>

<span class="s2">    function claim(uint256 index, address account, uint256 amount, bytes32[] calldata proof) external {</span>
<span class="s2">        require(!claimed[account], &quot;Already claimed&quot;);</span>

<span class="s2">        // Secure leaf encoding with index and double-hash</span>
<span class="s2">        bytes32 leaf = keccak256(bytes.concat(</span>
<span class="s2">            keccak256(abi.encode(index, account, amount))</span>
<span class="s2">        ));</span>
<span class="s2">        require(MerkleProof.verify(proof, merkleRoot, leaf), &quot;Invalid proof&quot;);</span>

<span class="s2">        claimed[account] = true;</span>
<span class="s2">        token.transfer(account, amount);  // Transfer to account, not msg.sender</span>
<span class="s2">    }</span>

<span class="s2">    // Or use bitmap for gas-efficient claim tracking</span>
<span class="s2">    mapping(uint256 =&gt; uint256) private claimedBitmap;</span>

<span class="s2">    function isClaimed(uint256 index) public view returns (bool) {</span>
<span class="s2">        uint256 wordIndex = index / 256;</span>
<span class="s2">        uint256 bitIndex = index % 256;</span>
<span class="s2">        return claimedBitmap[wordIndex] &amp; (1 &lt;&lt; bitIndex) != 0;</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Airdrop uses weak leaf encoding (amount only). &quot;</span>
            <span class="s2">&quot;2. Attacker finds another user&#39;s proof for same amount. &quot;</span>
            <span class="s2">&quot;3. Attacker uses proof to claim tokens to their address. &quot;</span>
            <span class="s2">&quot;4. Legitimate user can no longer claim. &quot;</span>
            <span class="s2">&quot;Or: Attacker constructs proof matching intermediate Merkle node.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;token&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple airdrop implementations with second preimage issues&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;airdrop&quot;</span><span class="p">,</span> <span class="s2">&quot;merkle&quot;</span><span class="p">,</span> <span class="s2">&quot;proof&quot;</span><span class="p">,</span> <span class="s2">&quot;claim&quot;</span><span class="p">,</span> <span class="s2">&quot;token&quot;</span><span class="p">,</span> <span class="s2">&quot;distribution&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Time-Locked Admin Bypass</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;EMERGENCY-TIMELOCK-BYPASS&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-863&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Timelock Bypass via Emergency Functions&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Protocols implement timelocks to give users time to exit before changes. &quot;</span>
            <span class="s2">&quot;However, emergency or admin functions that bypass the timelock can be &quot;</span>
            <span class="s2">&quot;abused to make instant changes without user protection.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Timelock with dangerous bypass</span>
<span class="s2">contract TimelockController {</span>
<span class="s2">    uint256 public constant DELAY = 2 days;</span>
<span class="s2">    mapping(bytes32 =&gt; uint256) public timestamps;</span>

<span class="s2">    function schedule(bytes32 id, address target, bytes calldata data) external onlyAdmin {</span>
<span class="s2">        timestamps[id] = block.timestamp + DELAY;</span>
<span class="s2">    }</span>

<span class="s2">    function execute(bytes32 id, address target, bytes calldata data) external {</span>
<span class="s2">        require(block.timestamp &gt;= timestamps[id], &quot;Not ready&quot;);</span>
<span class="s2">        (bool success,) = target.call(data);</span>
<span class="s2">        require(success);</span>
<span class="s2">    }</span>

<span class="s2">    // DANGEROUS: Bypasses all timelock protections!</span>
<span class="s2">    function emergencyExecute(address target, bytes calldata data) external onlyAdmin {</span>
<span class="s2">        (bool success,) = target.call(data);</span>
<span class="s2">        require(success);</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">contract TimelockController {</span>
<span class="s2">    uint256 public constant DELAY = 2 days;</span>
<span class="s2">    uint256 public constant EMERGENCY_DELAY = 6 hours;  // Shorter but not instant</span>

<span class="s2">    mapping(bytes32 =&gt; uint256) public timestamps;</span>

<span class="s2">    // Regular timelock</span>
<span class="s2">    function schedule(bytes32 id, address target, bytes calldata data) external onlyAdmin {</span>
<span class="s2">        timestamps[id] = block.timestamp + DELAY;</span>
<span class="s2">        emit Scheduled(id, target, data, timestamps[id]);</span>
<span class="s2">    }</span>

<span class="s2">    // Emergency still has delay + limited scope</span>
<span class="s2">    function emergencySchedule(bytes32 id, address target, bytes calldata data) external {</span>
<span class="s2">        require(isEmergencyAction(target, data), &quot;Not emergency action&quot;);</span>
<span class="s2">        require(msg.sender == guardian, &quot;Only guardian&quot;);</span>

<span class="s2">        timestamps[id] = block.timestamp + EMERGENCY_DELAY;</span>
<span class="s2">        emit EmergencyScheduled(id, target, data, timestamps[id]);</span>
<span class="s2">    }</span>

<span class="s2">    // Define what counts as emergency (pause, not upgrade)</span>
<span class="s2">    function isEmergencyAction(address target, bytes calldata data) internal view returns (bool) {</span>
<span class="s2">        bytes4 selector = bytes4(data[:4]);</span>
<span class="s2">        return selector == IProtocol.pause.selector;  // Only pause allowed</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Protocol has 2-day timelock for upgrades. &quot;</span>
            <span class="s2">&quot;2. Admin key compromised or malicious insider. &quot;</span>
            <span class="s2">&quot;3. Attacker uses emergencyExecute to upgrade instantly. &quot;</span>
            <span class="s2">&quot;4. Malicious implementation drains all funds. &quot;</span>
            <span class="s2">&quot;5. Users had no time to exit despite &#39;timelock protection&#39;.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;Multiple DeFi protocols had emergency function abuse&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;timelock&quot;</span><span class="p">,</span> <span class="s2">&quot;bypass&quot;</span><span class="p">,</span> <span class="s2">&quot;emergency&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span> <span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;upgrade&quot;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="c1"># Permit Signature Phishing</span>
    <span class="n">VulnerabilityDocument</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;PERMIT-SIGNATURE-PHISHING&quot;</span><span class="p">,</span>
        <span class="n">swc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cwe_id</span><span class="o">=</span><span class="s2">&quot;CWE-346&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ERC-20 Permit Signature Phishing&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;ERC-2612 permit() allows gasless approvals via signatures. Attackers can &quot;</span>
            <span class="s2">&quot;trick users into signing permit messages that look harmless but grant &quot;</span>
            <span class="s2">&quot;unlimited token approvals to attacker-controlled addresses.&quot;</span>
        <span class="p">),</span>
        <span class="n">vulnerable_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Legitimate permit implementation - not vulnerable itself</span>
<span class="s2">// But users can be tricked into signing malicious permits</span>

<span class="s2">// Phishing site presents this as &quot;Sign to verify wallet&quot;:</span>
<span class="s2">const domain = {</span>
<span class="s2">    name: &quot;USD Coin&quot;,</span>
<span class="s2">    version: &quot;1&quot;,</span>
<span class="s2">    chainId: 1,</span>
<span class="s2">    verifyingContract: &quot;0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48&quot;</span>
<span class="s2">};</span>

<span class="s2">const permit = {</span>
<span class="s2">    owner: victimAddress,</span>
<span class="s2">    spender: attackerAddress,  // Hidden in UI</span>
<span class="s2">    value: &quot;115792089237316195423570985008687907853269984665640564039457584007913129639935&quot;,  // uint256 max</span>
<span class="s2">    nonce: 0,</span>
<span class="s2">    deadline: 1893456000  // Far future</span>
<span class="s2">};</span>

<span class="s2">// User signs, thinking it&#39;s wallet verification</span>
<span class="s2">const signature = await signer._signTypedData(domain, types, permit);</span>

<span class="s2">// Attacker submits permit and drains tokens</span>
<span class="s2">usdc.permit(victim, attacker, MAX_UINT256, deadline, v, r, s);</span>
<span class="s2">usdc.transferFrom(victim, attacker, usdc.balanceOf(victim));</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">fixed_code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Wallet protection - show clear permit details</span>
<span class="s2">// MetaMask and other wallets should display:</span>
<span class="s2">// &quot;Approve [SPENDER] to spend [AMOUNT] [TOKEN]&quot;</span>

<span class="s2">// Contract-side: Consider permit with amount limits</span>
<span class="s2">function permitWithLimit(</span>
<span class="s2">    address owner,</span>
<span class="s2">    address spender,</span>
<span class="s2">    uint256 value,</span>
<span class="s2">    uint256 deadline,</span>
<span class="s2">    uint8 v, bytes32 r, bytes32 s</span>
<span class="s2">) external {</span>
<span class="s2">    require(value &lt;= MAX_PERMIT_AMOUNT, &quot;Amount too high&quot;);</span>
<span class="s2">    _permit(owner, spender, value, deadline, v, r, s);</span>
<span class="s2">}</span>

<span class="s2">// User-side: Always verify before signing</span>
<span class="s2">// 1. Check the spender address</span>
<span class="s2">// 2. Check the amount (MAX_UINT256 = unlimited!)</span>
<span class="s2">// 3. Check the deadline</span>
<span class="s2">// 4. Verify the contract address matches expected token</span>

<span class="s2">// Protocol-side: Use minimal necessary approvals</span>
<span class="s2">function depositWithPermit(</span>
<span class="s2">    uint256 amount,</span>
<span class="s2">    uint256 deadline,</span>
<span class="s2">    uint8 v, bytes32 r, bytes32 s</span>
<span class="s2">) external {</span>
<span class="s2">    // Only approve exact amount needed</span>
<span class="s2">    token.permit(msg.sender, address(this), amount, deadline, v, r, s);</span>
<span class="s2">    token.transferFrom(msg.sender, address(this), amount);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">attack_scenario</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;1. Attacker creates phishing site mimicking popular dApp. &quot;</span>
            <span class="s2">&quot;2. Site prompts &#39;Sign to verify your wallet&#39;. &quot;</span>
            <span class="s2">&quot;3. User sees EIP-712 signature request, appears legitimate. &quot;</span>
            <span class="s2">&quot;4. Hidden in data: permit granting attacker unlimited approval. &quot;</span>
            <span class="s2">&quot;5. User signs, attacker now has approval without on-chain tx. &quot;</span>
            <span class="s2">&quot;6. Attacker calls transferFrom to drain user&#39;s tokens.&quot;</span>
        <span class="p">),</span>
        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;phishing&quot;</span><span class="p">,</span>
        <span class="n">real_exploit</span><span class="o">=</span><span class="s2">&quot;OpenSea permit phishing - $1.7M stolen (2022)&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;permit&quot;</span><span class="p">,</span> <span class="s2">&quot;phishing&quot;</span><span class="p">,</span> <span class="s2">&quot;erc2612&quot;</span><span class="p">,</span> <span class="s2">&quot;signature&quot;</span><span class="p">,</span> <span class="s2">&quot;approval&quot;</span><span class="p">,</span> <span class="s2">&quot;gasless&quot;</span><span class="p">],</span>
    <span class="p">),</span>
<span class="p">]</span>


<span class="c1"># =============================================================================</span>
<span class="c1"># CHROMADB EMBEDDING RAG</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="EmbeddingRAG">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">EmbeddingRAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ChromaDB-powered Retrieval-Augmented Generation for vulnerability analysis.</span>

<span class="sd">    Uses sentence-transformers for embeddings and ChromaDB for vector storage.</span>
<span class="sd">    Provides semantic similarity search across the vulnerability knowledge base.</span>

<span class="sd">    Performance Optimizations (v5.1.0):</span>
<span class="sd">    - O(1) document lookup via _doc_index dict</span>
<span class="sd">    - Query result caching with configurable TTL</span>
<span class="sd">    - Batch search support for multiple queries</span>
<span class="sd">    - Category-based query deduplication</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DEFAULT_MODEL</span> <span class="o">=</span> <span class="s2">&quot;all-MiniLM-L6-v2&quot;</span>  <span class="c1"># Fast, good quality embeddings</span>
    <span class="n">COLLECTION_NAME</span> <span class="o">=</span> <span class="s2">&quot;miesc_vulnerabilities&quot;</span>

    <span class="c1"># Cache settings</span>
    <span class="n">CACHE_MAX_SIZE</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="n">CACHE_TTL_SECONDS</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># 5 minutes</span>

<div class="viewcode-block" id="EmbeddingRAG.__init__">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">persist_directory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">embedding_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_MODEL</span><span class="p">,</span>
        <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">enable_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the embedding RAG system.</span>

<span class="sd">        Args:</span>
<span class="sd">            persist_directory: Directory for ChromaDB persistence.</span>
<span class="sd">                              If None, uses in-memory database.</span>
<span class="sd">            embedding_model: Sentence-transformers model name.</span>
<span class="sd">            top_k: Number of results to return from searches.</span>
<span class="sd">            enable_cache: Enable query result caching (default: True).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top_k</span> <span class="o">=</span> <span class="n">top_k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedding_model_name</span> <span class="o">=</span> <span class="n">embedding_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable_cache</span> <span class="o">=</span> <span class="n">enable_cache</span>

        <span class="c1"># Set up persistence directory</span>
        <span class="k">if</span> <span class="n">persist_directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">persist_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;.miesc&quot;</span> <span class="o">/</span> <span class="s2">&quot;chromadb&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">persist_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">persist_directory</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">persist_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Lazy-loaded components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_embedder</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># O(1) document lookup index (built on first access)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_doc_index</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">VulnerabilityDocument</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Query cache: {cache_key: (timestamp, results)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_query_cache</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;RetrievalResult&quot;</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_hits</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_misses</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;EmbeddingRAG configured with model=</span><span class="si">{</span><span class="n">embedding_model</span><span class="si">}</span><span class="s2">, top_k=</span><span class="si">{</span><span class="n">top_k</span><span class="si">}</span><span class="s2">, cache=</span><span class="si">{</span><span class="n">enable_cache</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_ensure_initialized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lazy initialization of ChromaDB and embeddings.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Build O(1) document lookup index</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_doc_index</span><span class="p">()</span>

            <span class="c1"># Initialize sentence-transformers</span>
            <span class="n">SentenceTransformer</span> <span class="o">=</span> <span class="n">_get_sentence_transformer</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_embedder</span> <span class="o">=</span> <span class="n">SentenceTransformer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embedding_model_name</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded embedding model: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">embedding_model_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Initialize ChromaDB</span>
            <span class="n">chromadb</span> <span class="o">=</span> <span class="n">_get_chromadb</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">chromadb</span><span class="o">.</span><span class="n">PersistentClient</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">persist_dir</span><span class="p">))</span>

            <span class="c1"># Get or create collection with optimized HNSW parameters</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">get_or_create_collection</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">COLLECTION_NAME</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;hnsw:space&quot;</span><span class="p">:</span> <span class="s2">&quot;cosine&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;hnsw:search_ef&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>  <span class="c1"># Better recall (default 10)</span>
                    <span class="s2">&quot;hnsw:M&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>  <span class="c1"># Default, good balance</span>
                <span class="p">},</span>
            <span class="p">)</span>

            <span class="c1"># Check if we need to populate the knowledge base</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Indexing vulnerability knowledge base...&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_index_knowledge_base</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using existing index with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2"> documents&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Required dependency not found: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="s2">&quot;Install with: pip install chromadb sentence-transformers&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_doc_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build O(1) lookup index for vulnerability documents.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doc_index</span><span class="p">:</span>
            <span class="k">return</span>  <span class="c1"># Already built</span>

        <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">VULNERABILITY_KNOWLEDGE_BASE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_doc_index</span><span class="p">[</span><span class="n">doc</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">doc</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Built document index with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_doc_index</span><span class="p">)</span><span class="si">}</span><span class="s2"> entries&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_cache_key</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">filter_category</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">filter_severity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">n_results</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate cache key for a search query.&quot;&quot;&quot;</span>
        <span class="n">key_parts</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">query</span><span class="p">[:</span><span class="mi">200</span><span class="p">],</span>  <span class="c1"># Truncate long queries</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">filter_category</span><span class="p">),</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">filter_severity</span><span class="p">),</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">n_results</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">key_parts</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_cached_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="s2">&quot;RetrievalResult&quot;</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get cached result if valid (not expired).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_cache</span> <span class="ow">or</span> <span class="n">cache_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">timestamp</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">timestamp</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">CACHE_TTL_SECONDS</span><span class="p">:</span>
            <span class="c1"># Expired</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_hits</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_cache_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;RetrievalResult&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cache search results.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_cache</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Evict oldest entries if cache is full</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_cache</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CACHE_MAX_SIZE</span><span class="p">:</span>
            <span class="n">oldest_key</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_cache</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_cache</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_cache</span><span class="p">[</span><span class="n">oldest_key</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_query_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span> <span class="n">results</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_misses</span> <span class="o">+=</span> <span class="mi">1</span>

<div class="viewcode-block" id="EmbeddingRAG.get_cache_stats">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.get_cache_stats">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_cache_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get cache performance statistics.&quot;&quot;&quot;</span>
        <span class="n">total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_hits</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_misses</span>
        <span class="n">hit_rate</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache_hits</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;hits&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_hits</span><span class="p">,</span>
            <span class="s2">&quot;misses&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_misses</span><span class="p">,</span>
            <span class="s2">&quot;hit_rate&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hit_rate</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cache_size&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_cache</span><span class="p">),</span>
            <span class="s2">&quot;max_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">CACHE_MAX_SIZE</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="EmbeddingRAG.clear_cache">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.clear_cache">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the query cache.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_query_cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_hits</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_misses</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Query cache cleared&quot;</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_index_knowledge_base</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Index the vulnerability knowledge base into ChromaDB.&quot;&quot;&quot;</span>
        <span class="n">documents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">metadatas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">VULNERABILITY_KNOWLEDGE_BASE</span><span class="p">:</span>
            <span class="n">documents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vuln</span><span class="o">.</span><span class="n">to_text</span><span class="p">())</span>
            <span class="n">metadatas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vuln</span><span class="o">.</span><span class="n">to_metadata</span><span class="p">())</span>
            <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vuln</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="c1"># Generate embeddings</span>
        <span class="n">embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embedder</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">documents</span><span class="p">,</span> <span class="n">show_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Add to ChromaDB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
            <span class="n">documents</span><span class="o">=</span><span class="n">documents</span><span class="p">,</span>
            <span class="n">embeddings</span><span class="o">=</span><span class="n">embeddings</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">metadatas</span><span class="o">=</span><span class="n">metadatas</span><span class="p">,</span>
            <span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Indexed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span><span class="si">}</span><span class="s2"> vulnerability documents&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="EmbeddingRAG.search">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.search">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">filter_category</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">filter_severity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_results</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RetrievalResult</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Search for similar vulnerabilities using semantic similarity.</span>

<span class="sd">        Args:</span>
<span class="sd">            query: Search query (natural language or code snippet)</span>
<span class="sd">            filter_category: Filter by vulnerability category</span>
<span class="sd">            filter_severity: Filter by severity level</span>
<span class="sd">            n_results: Number of results (overrides top_k)</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of RetrievalResult with matched documents and scores</span>

<span class="sd">        Performance:</span>
<span class="sd">            - Uses O(1) document lookup via _doc_index</span>
<span class="sd">            - Caches results for identical queries (5 min TTL)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">n_results</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_k</span>

        <span class="c1"># Check cache first</span>
        <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">filter_category</span><span class="p">,</span> <span class="n">filter_severity</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_result</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cached</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cache hit for query (key=</span><span class="si">{</span><span class="n">cache_key</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cached</span>

        <span class="c1"># Build filter conditions</span>
        <span class="n">where_filter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">filter_category</span> <span class="ow">or</span> <span class="n">filter_severity</span><span class="p">:</span>
            <span class="n">conditions</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">filter_category</span><span class="p">:</span>
                <span class="n">conditions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="n">filter_category</span><span class="p">})</span>
            <span class="k">if</span> <span class="n">filter_severity</span><span class="p">:</span>
                <span class="n">conditions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">filter_severity</span><span class="p">})</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">where_filter</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">where_filter</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$and&quot;</span><span class="p">:</span> <span class="n">conditions</span><span class="p">}</span>

        <span class="c1"># Query ChromaDB</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
            <span class="n">query_texts</span><span class="o">=</span><span class="p">[</span><span class="n">query</span><span class="p">],</span>
            <span class="n">n_results</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
            <span class="n">where</span><span class="o">=</span><span class="n">where_filter</span><span class="p">,</span>
            <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;documents&quot;</span><span class="p">,</span> <span class="s2">&quot;metadatas&quot;</span><span class="p">,</span> <span class="s2">&quot;distances&quot;</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="c1"># Convert to RetrievalResult objects using O(1) lookup</span>
        <span class="n">retrieval_results</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">doc_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
                <span class="c1"># O(1) lookup instead of O(n) linear search</span>
                <span class="n">original_doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doc_index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">doc_id</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">original_doc</span><span class="p">:</span>
                    <span class="c1"># ChromaDB returns distance, convert to similarity</span>
                    <span class="n">distance</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">similarity</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">distance</span>  <span class="c1"># Cosine distance to similarity</span>

                    <span class="n">retrieval_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">RetrievalResult</span><span class="p">(</span>
                            <span class="n">document</span><span class="o">=</span><span class="n">original_doc</span><span class="p">,</span>
                            <span class="n">similarity_score</span><span class="o">=</span><span class="n">similarity</span><span class="p">,</span>
                            <span class="n">relevance_reason</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_explain_relevance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">original_doc</span><span class="p">),</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

        <span class="c1"># Cache the results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_result</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">retrieval_results</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">retrieval_results</span></div>


<div class="viewcode-block" id="EmbeddingRAG.batch_search">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.batch_search">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">batch_search</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">queries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">filter_category</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">filter_severity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_results</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">RetrievalResult</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Batch search for multiple queries efficiently.</span>

<span class="sd">        Args:</span>
<span class="sd">            queries: List of search queries</span>
<span class="sd">            filter_category: Filter by vulnerability category (applied to all)</span>
<span class="sd">            filter_severity: Filter by severity level (applied to all)</span>
<span class="sd">            n_results: Number of results per query</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of result lists, one per query</span>

<span class="sd">        Performance:</span>
<span class="sd">            - Deduplicates identical queries</span>
<span class="sd">            - Uses single ChromaDB call for all unique queries</span>
<span class="sd">            - 50-75% faster than sequential searches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">queries</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">n_results</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_k</span>

        <span class="c1"># Deduplicate queries while preserving order mapping</span>
        <span class="n">unique_queries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">query_to_index</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">original_to_unique</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
            <span class="n">q_normalized</span> <span class="o">=</span> <span class="n">q</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span>  <span class="c1"># Truncate for comparison</span>
            <span class="k">if</span> <span class="n">q_normalized</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_to_index</span><span class="p">:</span>
                <span class="n">query_to_index</span><span class="p">[</span><span class="n">q_normalized</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_queries</span><span class="p">)</span>
                <span class="n">unique_queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
            <span class="n">original_to_unique</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query_to_index</span><span class="p">[</span><span class="n">q_normalized</span><span class="p">])</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch search: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">queries</span><span class="p">)</span><span class="si">}</span><span class="s2"> queries -&gt; </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_queries</span><span class="p">)</span><span class="si">}</span><span class="s2"> unique&quot;</span><span class="p">)</span>

        <span class="c1"># Check cache for each unique query</span>
        <span class="n">cached_results</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">RetrievalResult</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">uncached_queries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_queries</span><span class="p">):</span>
            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">filter_category</span><span class="p">,</span> <span class="n">filter_severity</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_result</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cached</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cached_results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cached</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">uncached_queries</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>

        <span class="c1"># Query ChromaDB for uncached queries</span>
        <span class="k">if</span> <span class="n">uncached_queries</span><span class="p">:</span>
            <span class="c1"># Build filter</span>
            <span class="n">where_filter</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">filter_category</span> <span class="ow">or</span> <span class="n">filter_severity</span><span class="p">:</span>
                <span class="n">conditions</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">filter_category</span><span class="p">:</span>
                    <span class="n">conditions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="n">filter_category</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">filter_severity</span><span class="p">:</span>
                    <span class="n">conditions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">filter_severity</span><span class="p">})</span>
                <span class="n">where_filter</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">{</span><span class="s2">&quot;$and&quot;</span><span class="p">:</span> <span class="n">conditions</span><span class="p">}</span>

            <span class="c1"># Batch query to ChromaDB</span>
            <span class="n">query_texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">uncached_queries</span><span class="p">]</span>
            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
                <span class="n">query_texts</span><span class="o">=</span><span class="n">query_texts</span><span class="p">,</span>
                <span class="n">n_results</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
                <span class="n">where</span><span class="o">=</span><span class="n">where_filter</span><span class="p">,</span>
                <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;documents&quot;</span><span class="p">,</span> <span class="s2">&quot;metadatas&quot;</span><span class="p">,</span> <span class="s2">&quot;distances&quot;</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="c1"># Process results for each query</span>
            <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">unique_idx</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">uncached_queries</span><span class="p">):</span>
                <span class="n">retrieval_results</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">batch_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">]):</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">doc_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">][</span><span class="n">batch_idx</span><span class="p">]):</span>
                        <span class="n">original_doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doc_index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">doc_id</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">original_doc</span><span class="p">:</span>
                            <span class="n">distance</span> <span class="o">=</span> <span class="p">(</span>
                                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">][</span><span class="n">batch_idx</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span>
                            <span class="p">)</span>
                            <span class="n">similarity</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">distance</span>
                            <span class="n">retrieval_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="n">RetrievalResult</span><span class="p">(</span>
                                    <span class="n">document</span><span class="o">=</span><span class="n">original_doc</span><span class="p">,</span>
                                    <span class="n">similarity_score</span><span class="o">=</span><span class="n">similarity</span><span class="p">,</span>
                                    <span class="n">relevance_reason</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_explain_relevance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">original_doc</span><span class="p">),</span>
                                <span class="p">)</span>
                            <span class="p">)</span>

                <span class="c1"># Cache this result</span>
                <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">filter_category</span><span class="p">,</span> <span class="n">filter_severity</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cache_result</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">retrieval_results</span><span class="p">)</span>
                <span class="n">cached_results</span><span class="p">[</span><span class="n">unique_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">retrieval_results</span>

        <span class="c1"># Map back to original query order</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">cached_results</span><span class="p">[</span><span class="n">original_to_unique</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">queries</span><span class="p">))]</span></div>


<div class="viewcode-block" id="EmbeddingRAG.search_by_finding">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.search_by_finding">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">search_by_finding</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">finding</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">code_context</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RetrievalResult</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Search for similar vulnerabilities based on a security finding.</span>

<span class="sd">        Args:</span>
<span class="sd">            finding: A vulnerability finding dictionary</span>
<span class="sd">            code_context: Optional code snippet for context</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of relevant vulnerabilities from knowledge base</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Build query from finding</span>
        <span class="n">query_parts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">):</span>
            <span class="n">query_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vulnerability type: </span><span class="si">{</span><span class="n">finding</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">):</span>
            <span class="n">query_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Issue: </span><span class="si">{</span><span class="n">finding</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">):</span>
            <span class="n">query_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">][:</span><span class="mi">500</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;swc_id&quot;</span><span class="p">):</span>
            <span class="n">query_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SWC ID: </span><span class="si">{</span><span class="n">finding</span><span class="p">[</span><span class="s1">&#39;swc_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">code_context</span><span class="p">:</span>
            <span class="n">query_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Code: </span><span class="si">{</span><span class="n">code_context</span><span class="p">[:</span><span class="mi">500</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">query_parts</span><span class="p">)</span>

        <span class="c1"># Determine category filter from finding</span>
        <span class="n">category</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">vuln_type</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;reentrancy&quot;</span> <span class="ow">in</span> <span class="n">vuln_type</span><span class="p">:</span>
            <span class="n">category</span> <span class="o">=</span> <span class="s2">&quot;reentrancy&quot;</span>
        <span class="k">elif</span> <span class="s2">&quot;access&quot;</span> <span class="ow">in</span> <span class="n">vuln_type</span> <span class="ow">or</span> <span class="s2">&quot;auth&quot;</span> <span class="ow">in</span> <span class="n">vuln_type</span><span class="p">:</span>
            <span class="n">category</span> <span class="o">=</span> <span class="s2">&quot;access-control&quot;</span>
        <span class="k">elif</span> <span class="s2">&quot;oracle&quot;</span> <span class="ow">in</span> <span class="n">vuln_type</span> <span class="ow">or</span> <span class="s2">&quot;price&quot;</span> <span class="ow">in</span> <span class="n">vuln_type</span><span class="p">:</span>
            <span class="n">category</span> <span class="o">=</span> <span class="s2">&quot;oracle&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">filter_category</span><span class="o">=</span><span class="n">category</span><span class="p">)</span></div>


<div class="viewcode-block" id="EmbeddingRAG.get_context_for_llm">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.get_context_for_llm">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_context_for_llm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">finding</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">code_context</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">max_context_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate context string for LLM prompt enrichment.</span>

<span class="sd">        Args:</span>
<span class="sd">            finding: The vulnerability finding to enhance</span>
<span class="sd">            code_context: Optional code snippet</span>
<span class="sd">            max_context_length: Maximum length of returned context</span>

<span class="sd">        Returns:</span>
<span class="sd">            Formatted context string for LLM prompt</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_by_finding</span><span class="p">(</span><span class="n">finding</span><span class="p">,</span> <span class="n">code_context</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;No similar vulnerabilities found in knowledge base.&quot;</span>

        <span class="n">context_parts</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;## Similar Known Vulnerabilities</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]</span>
        <span class="n">current_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">context_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">to_context</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">current_length</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_context_length</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">context_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="n">context_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">current_length</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span>

        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">context_parts</span><span class="p">)</span></div>


<div class="viewcode-block" id="EmbeddingRAG.add_custom_vulnerability">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.add_custom_vulnerability">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_custom_vulnerability</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">vulnerability</span><span class="p">:</span> <span class="n">VulnerabilityDocument</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a custom vulnerability to the knowledge base.</span>

<span class="sd">        Args:</span>
<span class="sd">            vulnerability: VulnerabilityDocument to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="c1"># Generate embedding</span>
        <span class="n">embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embedder</span><span class="o">.</span><span class="n">encode</span><span class="p">([</span><span class="n">vulnerability</span><span class="o">.</span><span class="n">to_text</span><span class="p">()])[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Add to ChromaDB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
            <span class="n">documents</span><span class="o">=</span><span class="p">[</span><span class="n">vulnerability</span><span class="o">.</span><span class="n">to_text</span><span class="p">()],</span>
            <span class="n">embeddings</span><span class="o">=</span><span class="p">[</span><span class="n">embedding</span><span class="o">.</span><span class="n">tolist</span><span class="p">()],</span>
            <span class="n">metadatas</span><span class="o">=</span><span class="p">[</span><span class="n">vulnerability</span><span class="o">.</span><span class="n">to_metadata</span><span class="p">()],</span>
            <span class="n">ids</span><span class="o">=</span><span class="p">[</span><span class="n">vulnerability</span><span class="o">.</span><span class="n">id</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added custom vulnerability: </span><span class="si">{</span><span class="n">vulnerability</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_explain_relevance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">VulnerabilityDocument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate explanation for why a document is relevant.&quot;&quot;&quot;</span>
        <span class="n">reasons</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">query_lower</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">doc</span><span class="o">.</span><span class="n">swc_id</span> <span class="ow">and</span> <span class="n">doc</span><span class="o">.</span><span class="n">swc_id</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">query_lower</span><span class="p">:</span>
            <span class="n">reasons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matches SWC ID: </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">swc_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">doc</span><span class="o">.</span><span class="n">category</span> <span class="ow">and</span> <span class="n">doc</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">query_lower</span><span class="p">:</span>
            <span class="n">reasons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matches category: </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">category</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Check for keyword matches</span>
        <span class="n">keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span> <span class="s2">&quot;overflow&quot;</span><span class="p">,</span> <span class="s2">&quot;access&quot;</span><span class="p">,</span> <span class="s2">&quot;oracle&quot;</span><span class="p">,</span> <span class="s2">&quot;flash&quot;</span><span class="p">,</span> <span class="s2">&quot;signature&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">query_lower</span> <span class="ow">and</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">reasons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Keyword match: </span><span class="si">{</span><span class="n">kw</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">doc</span><span class="o">.</span><span class="n">real_exploit</span><span class="p">:</span>
            <span class="n">reasons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Real-world exploit documented&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">reasons</span><span class="p">:</span>
            <span class="n">reasons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Semantic similarity match&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">reasons</span><span class="p">)</span>

<div class="viewcode-block" id="EmbeddingRAG.get_stats">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.get_stats">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get statistics about the knowledge base.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;total_documents&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span>
            <span class="s2">&quot;embedding_model&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedding_model_name</span><span class="p">,</span>
            <span class="s2">&quot;persist_directory&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">persist_dir</span><span class="p">),</span>
            <span class="s2">&quot;categories&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">({</span><span class="n">d</span><span class="o">.</span><span class="n">category</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">VULNERABILITY_KNOWLEDGE_BASE</span><span class="p">}),</span>
            <span class="s2">&quot;knowledge_base_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="EmbeddingRAG.reindex">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.reindex">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reindex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Force reindex of the entire knowledge base.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="c1"># Delete existing collection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">delete_collection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COLLECTION_NAME</span><span class="p">)</span>

        <span class="c1"># Recreate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">create_collection</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">COLLECTION_NAME</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;hnsw:space&quot;</span><span class="p">:</span> <span class="s2">&quot;cosine&quot;</span><span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># Reindex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index_knowledge_base</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Knowledge base reindexed&quot;</span><span class="p">)</span></div>
</div>



<span class="c1"># =============================================================================</span>
<span class="c1"># HYBRID RAG (Embeddings + BM25)</span>
<span class="c1"># =============================================================================</span>


<div class="viewcode-block" id="HybridRAG">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.HybridRAG">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">HybridRAG</span><span class="p">(</span><span class="n">EmbeddingRAG</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Hybrid RAG combining semantic embeddings with BM25 lexical search.</span>

<span class="sd">    Provides better results by combining:</span>
<span class="sd">    - Semantic similarity (understanding meaning)</span>
<span class="sd">    - Lexical matching (exact keyword matches)</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="HybridRAG.__init__">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.HybridRAG.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">persist_directory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">embedding_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">EmbeddingRAG</span><span class="o">.</span><span class="n">DEFAULT_MODEL</span><span class="p">,</span>
        <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">embedding_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize hybrid RAG.</span>

<span class="sd">        Args:</span>
<span class="sd">            persist_directory: ChromaDB persistence directory</span>
<span class="sd">            embedding_model: Sentence-transformers model</span>
<span class="sd">            top_k: Number of results</span>
<span class="sd">            embedding_weight: Weight for embedding scores (0-1).</span>
<span class="sd">                             BM25 weight = 1 - embedding_weight</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">persist_directory</span><span class="p">,</span> <span class="n">embedding_model</span><span class="p">,</span> <span class="n">top_k</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedding_weight</span> <span class="o">=</span> <span class="n">embedding_weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bm25</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span> <span class="o">=</span> <span class="kc">None</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_ensure_initialized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize both embedding and BM25 indexes.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bm25</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_bm25_index</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_bm25_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build BM25 index from knowledge base.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">rank_bm25</span><span class="w"> </span><span class="kn">import</span> <span class="n">BM25Okapi</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;rank_bm25 not installed, falling back to embeddings only&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Tokenize documents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">VULNERABILITY_KNOWLEDGE_BASE</span><span class="p">:</span>
            <span class="n">tokens</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">to_text</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_bm25</span> <span class="o">=</span> <span class="n">BM25Okapi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;BM25 index built&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="HybridRAG.search">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.HybridRAG.search">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">filter_category</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">filter_severity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_results</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RetrievalResult</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hybrid search combining embeddings and BM25.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">n_results</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_k</span>

        <span class="c1"># Get embedding results (fetch more for reranking)</span>
        <span class="n">embedding_results</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">filter_category</span><span class="p">,</span> <span class="n">filter_severity</span><span class="p">,</span> <span class="n">n_results</span><span class="o">=</span><span class="n">n</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bm25</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Fall back to embedding-only if BM25 not available</span>
            <span class="k">return</span> <span class="n">embedding_results</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>

        <span class="c1"># Get BM25 scores</span>
        <span class="n">query_tokens</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">bm25_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bm25</span><span class="o">.</span><span class="n">get_scores</span><span class="p">(</span><span class="n">query_tokens</span><span class="p">)</span>

        <span class="c1"># Normalize BM25 scores</span>
        <span class="n">max_bm25</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bm25_scores</span><span class="p">)</span> <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">bm25_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="n">bm25_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="o">/</span> <span class="n">max_bm25</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">bm25_scores</span><span class="p">]</span>

        <span class="c1"># Create ID to BM25 score mapping</span>
        <span class="n">id_to_bm25</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">VULNERABILITY_KNOWLEDGE_BASE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">bm25_scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">VULNERABILITY_KNOWLEDGE_BASE</span><span class="p">))</span>
        <span class="p">}</span>

        <span class="c1"># Combine scores</span>
        <span class="n">hybrid_results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">embedding_results</span><span class="p">:</span>
            <span class="n">bm25_score</span> <span class="o">=</span> <span class="n">id_to_bm25</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">hybrid_score</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">embedding_weight</span> <span class="o">*</span> <span class="n">result</span><span class="o">.</span><span class="n">similarity_score</span>
                <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedding_weight</span><span class="p">)</span> <span class="o">*</span> <span class="n">bm25_score</span>
            <span class="p">)</span>

            <span class="n">hybrid_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">RetrievalResult</span><span class="p">(</span>
                    <span class="n">document</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">document</span><span class="p">,</span>
                    <span class="n">similarity_score</span><span class="o">=</span><span class="n">hybrid_score</span><span class="p">,</span>
                    <span class="n">relevance_reason</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">relevance_reason</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; (hybrid: emb=</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">similarity_score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, bm25=</span><span class="si">{</span><span class="n">bm25_score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># Sort by hybrid score and return top-k</span>
        <span class="n">hybrid_results</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">similarity_score</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">hybrid_results</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span></div>
</div>



<span class="c1"># =============================================================================</span>
<span class="c1"># CONVENIENCE FUNCTIONS</span>
<span class="c1"># =============================================================================</span>

<span class="n">_default_rag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EmbeddingRAG</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<div class="viewcode-block" id="get_rag">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.get_rag">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_rag</span><span class="p">(</span><span class="n">hybrid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EmbeddingRAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the default RAG instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        hybrid: Use HybridRAG if True, else EmbeddingRAG</span>

<span class="sd">    Returns:</span>
<span class="sd">        Configured RAG instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_default_rag</span>

    <span class="k">if</span> <span class="n">_default_rag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hybrid</span><span class="p">:</span>
            <span class="n">_default_rag</span> <span class="o">=</span> <span class="n">HybridRAG</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_default_rag</span> <span class="o">=</span> <span class="n">EmbeddingRAG</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">_default_rag</span></div>



<div class="viewcode-block" id="search_vulnerabilities">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.search_vulnerabilities">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">search_vulnerabilities</span><span class="p">(</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">hybrid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RetrievalResult</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search the vulnerability knowledge base.</span>

<span class="sd">    Args:</span>
<span class="sd">        query: Search query</span>
<span class="sd">        top_k: Number of results</span>
<span class="sd">        hybrid: Use hybrid search</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of matching vulnerabilities</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rag</span> <span class="o">=</span> <span class="n">get_rag</span><span class="p">(</span><span class="n">hybrid</span><span class="o">=</span><span class="n">hybrid</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rag</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">n_results</span><span class="o">=</span><span class="n">top_k</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_context_for_finding">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.get_context_for_finding">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_context_for_finding</span><span class="p">(</span>
    <span class="n">finding</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">hybrid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get RAG context for a security finding.</span>

<span class="sd">    Args:</span>
<span class="sd">        finding: Vulnerability finding dict</span>
<span class="sd">        code: Code context</span>
<span class="sd">        hybrid: Use hybrid search</span>

<span class="sd">    Returns:</span>
<span class="sd">        Context string for LLM enhancement</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rag</span> <span class="o">=</span> <span class="n">get_rag</span><span class="p">(</span><span class="n">hybrid</span><span class="o">=</span><span class="n">hybrid</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rag</span><span class="o">.</span><span class="n">get_context_for_llm</span><span class="p">(</span><span class="n">finding</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span></div>



<div class="viewcode-block" id="batch_get_context_for_findings">
<a class="viewcode-back" href="../../../api/llm.html#src.llm.embedding_rag.batch_get_context_for_findings">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">batch_get_context_for_findings</span><span class="p">(</span>
    <span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">hybrid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get RAG context for multiple findings efficiently using batch search.</span>

<span class="sd">    This is 50-75% faster than calling get_context_for_finding individually</span>
<span class="sd">    for each finding, due to:</span>
<span class="sd">    - Query deduplication (identical vulnerability types share results)</span>
<span class="sd">    - Query caching (subsequent identical queries hit cache)</span>
<span class="sd">    - Batch ChromaDB queries where possible</span>

<span class="sd">    Args:</span>
<span class="sd">        findings: List of vulnerability finding dicts</span>
<span class="sd">        code: Code context (shared across all findings)</span>
<span class="sd">        hybrid: Use hybrid search</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict mapping finding title/id to context string</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; findings = [</span>
<span class="sd">        ...     {&quot;type&quot;: &quot;reentrancy&quot;, &quot;title&quot;: &quot;Reentrancy in withdraw&quot;},</span>
<span class="sd">        ...     {&quot;type&quot;: &quot;reentrancy&quot;, &quot;title&quot;: &quot;Reentrancy in deposit&quot;},</span>
<span class="sd">        ...     {&quot;type&quot;: &quot;oracle&quot;, &quot;title&quot;: &quot;Price manipulation&quot;}</span>
<span class="sd">        ... ]</span>
<span class="sd">        &gt;&gt;&gt; contexts = batch_get_context_for_findings(findings, code)</span>
<span class="sd">        &gt;&gt;&gt; # Only 2 unique queries: &quot;reentrancy&quot; and &quot;oracle&quot;</span>
<span class="sd">        &gt;&gt;&gt; # Context cached for reuse</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">findings</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="n">rag</span> <span class="o">=</span> <span class="n">get_rag</span><span class="p">(</span><span class="n">hybrid</span><span class="o">=</span><span class="n">hybrid</span><span class="p">)</span>

    <span class="c1"># Group findings by vulnerability type for efficient querying</span>
    <span class="n">type_to_findings</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
        <span class="n">vuln_type</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;general&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vuln_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">type_to_findings</span><span class="p">:</span>
            <span class="n">type_to_findings</span><span class="p">[</span><span class="n">vuln_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">type_to_findings</span><span class="p">[</span><span class="n">vuln_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch context: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">findings</span><span class="p">)</span><span class="si">}</span><span class="s2"> findings -&gt; </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">type_to_findings</span><span class="p">)</span><span class="si">}</span><span class="s2"> unique types&quot;</span><span class="p">)</span>

    <span class="c1"># Build queries for unique types</span>
    <span class="n">queries</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">type_order</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vuln_type</span><span class="p">,</span> <span class="n">type_findings</span> <span class="ow">in</span> <span class="n">type_to_findings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Use first finding of each type to build query</span>
        <span class="n">representative</span> <span class="o">=</span> <span class="n">type_findings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">query_parts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">representative</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">):</span>
            <span class="n">query_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vulnerability type: </span><span class="si">{</span><span class="n">representative</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">representative</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">):</span>
            <span class="n">query_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">representative</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">][:</span><span class="mi">300</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">code</span><span class="p">:</span>
            <span class="n">query_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Code: </span><span class="si">{</span><span class="n">code</span><span class="p">[:</span><span class="mi">300</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">query_parts</span><span class="p">)</span> <span class="k">if</span> <span class="n">query_parts</span> <span class="k">else</span> <span class="n">vuln_type</span><span class="p">)</span>
        <span class="n">type_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">)</span>

    <span class="c1"># Batch search (uses caching internally)</span>
    <span class="n">all_results</span> <span class="o">=</span> <span class="n">rag</span><span class="o">.</span><span class="n">batch_search</span><span class="p">(</span><span class="n">queries</span><span class="p">)</span>

    <span class="c1"># Build context strings for each type</span>
    <span class="n">type_to_context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vuln_type</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">type_order</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">all_results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">type_to_context</span><span class="p">[</span><span class="n">vuln_type</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;No similar vulnerabilities found in knowledge base.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context_parts</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;## Similar Known Vulnerabilities</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>  <span class="c1"># Limit to top 3 for brevity</span>
                <span class="n">context_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">to_context</span><span class="p">())</span>
                <span class="n">context_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">type_to_context</span><span class="p">[</span><span class="n">vuln_type</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">context_parts</span><span class="p">)</span>

    <span class="c1"># Map back to individual findings</span>
    <span class="n">result</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
        <span class="n">vuln_type</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;general&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">finding_key</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">finding</span><span class="p">))))</span>
        <span class="n">result</span><span class="p">[</span><span class="n">finding_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_to_context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">,</span> <span class="s2">&quot;No context available.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span></div>



<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Data structures</span>
    <span class="s2">&quot;VulnerabilityDocument&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RetrievalResult&quot;</span><span class="p">,</span>
    <span class="c1"># RAG classes</span>
    <span class="s2">&quot;EmbeddingRAG&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HybridRAG&quot;</span><span class="p">,</span>
    <span class="c1"># Convenience functions</span>
    <span class="s2">&quot;get_rag&quot;</span><span class="p">,</span>
    <span class="s2">&quot;search_vulnerabilities&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_context_for_finding&quot;</span><span class="p">,</span>
    <span class="s2">&quot;batch_get_context_for_findings&quot;</span><span class="p">,</span>
    <span class="c1"># Knowledge base</span>
    <span class="s2">&quot;VULNERABILITY_KNOWLEDGE_BASE&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Fernando Boiero.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>