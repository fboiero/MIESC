

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.adapters.gptlens_adapter &mdash; MIESC 5.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=2880b4b0" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=1bd908e2"></script>
      <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            MIESC
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#quick-install">Quick Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#development-install">Development Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#optional-dependencies">Optional Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#docker-installation">Docker Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#external-tools">External Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#verifying-installation">Verifying Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quickstart Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#output-formats">Output Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#python-api">Python API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#using-adapters-directly">Using Adapters Directly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#llm-enhanced-analysis">LLM-Enhanced Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#docker-usage">Docker Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/adapters.html">Adapters Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#module-src.core.tool_protocol">Base Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory"><code class="docutils literal notranslate"><span class="pre">ToolCategory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.STATIC_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.STATIC_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.DYNAMIC_TESTING"><code class="docutils literal notranslate"><span class="pre">ToolCategory.DYNAMIC_TESTING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.SYMBOLIC_EXECUTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.SYMBOLIC_EXECUTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.FORMAL_VERIFICATION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.FORMAL_VERIFICATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.AI_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.AI_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.ML_DETECTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.ML_DETECTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.SPECIALIZED"><code class="docutils literal notranslate"><span class="pre">ToolCategory.SPECIALIZED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.CROSSCHAIN_ZK"><code class="docutils literal notranslate"><span class="pre">ToolCategory.CROSSCHAIN_ZK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.ADVANCED_AI_ENSEMBLE"><code class="docutils literal notranslate"><span class="pre">ToolCategory.ADVANCED_AI_ENSEMBLE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.COMPLIANCE"><code class="docutils literal notranslate"><span class="pre">ToolCategory.COMPLIANCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.AUDIT_READINESS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.AUDIT_READINESS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.GAS_OPTIMIZATION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.GAS_OPTIMIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.MEV_DETECTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.MEV_DETECTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCategory.PRIVACY_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.PRIVACY_ANALYSIS</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus"><code class="docutils literal notranslate"><span class="pre">ToolStatus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus.AVAILABLE"><code class="docutils literal notranslate"><span class="pre">ToolStatus.AVAILABLE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus.NOT_INSTALLED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.NOT_INSTALLED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus.CONFIGURATION_ERROR"><code class="docutils literal notranslate"><span class="pre">ToolStatus.CONFIGURATION_ERROR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus.LICENSE_REQUIRED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.LICENSE_REQUIRED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolStatus.DEPRECATED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.DEPRECATED</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability"><code class="docutils literal notranslate"><span class="pre">ToolCapability</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability.name"><code class="docutils literal notranslate"><span class="pre">ToolCapability.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability.description"><code class="docutils literal notranslate"><span class="pre">ToolCapability.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability.supported_languages"><code class="docutils literal notranslate"><span class="pre">ToolCapability.supported_languages</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability.detection_types"><code class="docutils literal notranslate"><span class="pre">ToolCapability.detection_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolCapability.__init__"><code class="docutils literal notranslate"><span class="pre">ToolCapability.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata"><code class="docutils literal notranslate"><span class="pre">ToolMetadata</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.name"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.version"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.category"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.author"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.license"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.license</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.homepage"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.homepage</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.repository"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.repository</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.documentation"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.documentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.installation_cmd"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.installation_cmd</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.capabilities"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.capabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.cost"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.cost</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.requires_api_key"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.requires_api_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.is_optional"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.is_optional</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolMetadata.__init__"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter"><code class="docutils literal notranslate"><span class="pre">ToolAdapter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.get_metadata"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.is_available"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.is_available()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.analyze"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.normalize_findings"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.normalize_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.get_installation_instructions"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_installation_instructions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.can_analyze"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.can_analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.get_default_config"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.validate_config"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.validate_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.check_binary_available"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.check_binary_available()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.run_subprocess"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.run_subprocess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.parse_json_safely"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.parse_json_safely()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.normalize_severity"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.normalize_severity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.create_finding"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.create_finding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.create_result"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.create_result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolAdapter.find_binary"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.find_binary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry"><code class="docutils literal notranslate"><span class="pre">ToolRegistry</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.__init__"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.register"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.get_tool"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tool()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.get_all_tools"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_all_tools()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.get_tools_by_category"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tools_by_category()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.get_available_tools"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_available_tools()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.ToolRegistry.get_tool_status_report"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tool_status_report()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#src.core.tool_protocol.get_tool_registry"><code class="docutils literal notranslate"><span class="pre">get_tool_registry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#static-analysis-adapters">Static Analysis Adapters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.slither_adapter">Slither Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.slither_adapter.SlitherAdapter"><code class="docutils literal notranslate"><span class="pre">SlitherAdapter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.aderyn_adapter">Aderyn Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#aderyn-static-analyzer-adapter-2025-security-enhancement">Aderyn Static Analyzer Adapter - 2025 Security Enhancement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.aderyn_adapter.AderynAdapter"><code class="docutils literal notranslate"><span class="pre">AderynAdapter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.solhint_adapter">Solhint Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#solhint-linter-adapter-layer-2-dynamic-testing-linting">Solhint Linter Adapter - Layer 2: Dynamic Testing (Linting)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.solhint_adapter.SolhintAdapter"><code class="docutils literal notranslate"><span class="pre">SolhintAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.solhint_adapter.register_adapter"><code class="docutils literal notranslate"><span class="pre">register_adapter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.semgrep_adapter">Semgrep Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#semgrep-adapter-layer-1-static-analysis">Semgrep Adapter - Layer 1: Static Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.semgrep_adapter.SemgrepAdapter"><code class="docutils literal notranslate"><span class="pre">SemgrepAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.semgrep_adapter.register_adapter"><code class="docutils literal notranslate"><span class="pre">register_adapter()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#symbolic-execution-adapters">Symbolic Execution Adapters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.mythril_adapter">Mythril Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#mythril-symbolic-execution-adapter-miesc-phase-3">Mythril Symbolic Execution Adapter - MIESC Phase 3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.mythril_adapter.MythrilAdapter"><code class="docutils literal notranslate"><span class="pre">MythrilAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.mythril_adapter.validate_findings_with_mythril"><code class="docutils literal notranslate"><span class="pre">validate_findings_with_mythril()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#dynamic-testing-adapters">Dynamic Testing Adapters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.hardhat_adapter">Hardhat Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#hardhat-adapter-layer-2-dynamic-testing">Hardhat Adapter - Layer 2: Dynamic Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.hardhat_adapter.HardhatAdapter"><code class="docutils literal notranslate"><span class="pre">HardhatAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.hardhat_adapter.register_adapter"><code class="docutils literal notranslate"><span class="pre">register_adapter()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#defi-adapters">DeFi Adapters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.defi_adapter">DeFi Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.defi_adapter.DeFiAdapter"><code class="docutils literal notranslate"><span class="pre">DeFiAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.defi_adapter.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.advanced_detector_adapter">Advanced Detector Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.advanced_detector_adapter.AdvancedDetectorAdapter"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorAdapter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.advanced_detector_adapter.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/adapters.html#llm-adapters">LLM Adapters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.smartllm_adapter">SmartLLM Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.smartllm_adapter.SmartLLMAdapter"><code class="docutils literal notranslate"><span class="pre">SmartLLMAdapter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/adapters.html#module-src.adapters.gptlens_adapter">GPTLens Adapter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#gptlens-adapter-dual-role-llm-vulnerability-detection-icse-2024">GPTLens Adapter - Dual-Role LLM Vulnerability Detection (ICSE 2024)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/adapters.html#src.adapters.gptlens_adapter.GPTLensAdapter"><code class="docutils literal notranslate"><span class="pre">GPTLensAdapter</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/agents.html">Agents Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#module-src.agents.base_agent">Base Agent</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent"><code class="docutils literal notranslate"><span class="pre">BaseAgent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.__init__"><code class="docutils literal notranslate"><span class="pre">BaseAgent.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.analyze"><code class="docutils literal notranslate"><span class="pre">BaseAgent.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.get_context_types"><code class="docutils literal notranslate"><span class="pre">BaseAgent.get_context_types()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.publish_findings"><code class="docutils literal notranslate"><span class="pre">BaseAgent.publish_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.subscribe_to"><code class="docutils literal notranslate"><span class="pre">BaseAgent.subscribe_to()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.get_latest_context"><code class="docutils literal notranslate"><span class="pre">BaseAgent.get_latest_context()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.aggregate_contexts"><code class="docutils literal notranslate"><span class="pre">BaseAgent.aggregate_contexts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.set_status"><code class="docutils literal notranslate"><span class="pre">BaseAgent.set_status()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.handle_error"><code class="docutils literal notranslate"><span class="pre">BaseAgent.handle_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.run"><code class="docutils literal notranslate"><span class="pre">BaseAgent.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.base_agent.BaseAgent.get_stats"><code class="docutils literal notranslate"><span class="pre">BaseAgent.get_stats()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#llm-agents">LLM Agents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#smartllm-agent">SmartLLM Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.smartllm_agent.SmartLLMAgent"><code class="docutils literal notranslate"><span class="pre">SmartLLMAgent</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.gptscan_agent">GPTScan Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.gptscan_agent.GPTScanAgent"><code class="docutils literal notranslate"><span class="pre">GPTScanAgent</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.llm_smartaudit_agent">LLM SmartAudit Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.llm_smartaudit_agent.LLMSmartAuditAgent"><code class="docutils literal notranslate"><span class="pre">LLMSmartAuditAgent</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#ollama-agent">Ollama Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.ollama_agent.OllamaAgent"><code class="docutils literal notranslate"><span class="pre">OllamaAgent</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#static-analysis-agents">Static Analysis Agents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.aderyn_agent">Aderyn Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.aderyn_agent.AderynAgent"><code class="docutils literal notranslate"><span class="pre">AderynAgent</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#symbolic-execution-agents">Symbolic Execution Agents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.halmos_agent">Halmos Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.halmos_agent.HalmosAgent"><code class="docutils literal notranslate"><span class="pre">HalmosAgent</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.smtchecker_agent">SMTChecker Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.smtchecker_agent.SMTCheckerAgent"><code class="docutils literal notranslate"><span class="pre">SMTCheckerAgent</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#fuzzing-agents">Fuzzing Agents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.medusa_agent">Medusa Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.medusa_agent.MedusaAgent"><code class="docutils literal notranslate"><span class="pre">MedusaAgent</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#module-src.agents.wake_agent">Wake Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.wake_agent.WakeAgent"><code class="docutils literal notranslate"><span class="pre">WakeAgent</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/agents.html#coordination">Coordination</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/agents.html#crewai-coordinator">CrewAI Coordinator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/agents.html#src.agents.crewai_coordinator.CrewAICoordinator"><code class="docutils literal notranslate"><span class="pre">CrewAICoordinator</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/core.html">Core Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#module-src.core.config_loader">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig"><code class="docutils literal notranslate"><span class="pre">AdapterConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.name"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.enabled"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.enabled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.layer"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.layer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.timeout"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.timeout</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.options"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.options</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.AdapterConfig.__init__"><code class="docutils literal notranslate"><span class="pre">AdapterConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig"><code class="docutils literal notranslate"><span class="pre">LayerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig.name"><code class="docutils literal notranslate"><span class="pre">LayerConfig.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig.enabled"><code class="docutils literal notranslate"><span class="pre">LayerConfig.enabled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig.priority"><code class="docutils literal notranslate"><span class="pre">LayerConfig.priority</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig.tools"><code class="docutils literal notranslate"><span class="pre">LayerConfig.tools</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.LayerConfig.__init__"><code class="docutils literal notranslate"><span class="pre">LayerConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig"><code class="docutils literal notranslate"><span class="pre">MIESCConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.reload"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.reload()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.version"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.global_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.global_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.max_workers"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.max_workers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.cache_enabled"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.cache_enabled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.log_level"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.log_level</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_adapter_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_adapter_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_layer_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_layer_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_enabled_adapters"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_enabled_adapters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_adapters_by_layer"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_adapters_by_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_all_layers"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_all_layers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_llm_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_llm_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_results_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_results_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_compliance_frameworks"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_compliance_frameworks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_chain_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_chain_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_enabled_chains"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_enabled_chains()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.get_license_plan_config"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.get_license_plan_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.MIESCConfig.to_dict"><code class="docutils literal notranslate"><span class="pre">MIESCConfig.to_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.config_loader.get_config"><code class="docutils literal notranslate"><span class="pre">get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#tool-protocol">Tool Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory"><code class="docutils literal notranslate"><span class="pre">ToolCategory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.STATIC_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.STATIC_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.DYNAMIC_TESTING"><code class="docutils literal notranslate"><span class="pre">ToolCategory.DYNAMIC_TESTING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.SYMBOLIC_EXECUTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.SYMBOLIC_EXECUTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.FORMAL_VERIFICATION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.FORMAL_VERIFICATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.AI_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.AI_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.ML_DETECTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.ML_DETECTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.SPECIALIZED"><code class="docutils literal notranslate"><span class="pre">ToolCategory.SPECIALIZED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.CROSSCHAIN_ZK"><code class="docutils literal notranslate"><span class="pre">ToolCategory.CROSSCHAIN_ZK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.ADVANCED_AI_ENSEMBLE"><code class="docutils literal notranslate"><span class="pre">ToolCategory.ADVANCED_AI_ENSEMBLE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.COMPLIANCE"><code class="docutils literal notranslate"><span class="pre">ToolCategory.COMPLIANCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.AUDIT_READINESS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.AUDIT_READINESS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.GAS_OPTIMIZATION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.GAS_OPTIMIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.MEV_DETECTION"><code class="docutils literal notranslate"><span class="pre">ToolCategory.MEV_DETECTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCategory.PRIVACY_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">ToolCategory.PRIVACY_ANALYSIS</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus"><code class="docutils literal notranslate"><span class="pre">ToolStatus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus.AVAILABLE"><code class="docutils literal notranslate"><span class="pre">ToolStatus.AVAILABLE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus.NOT_INSTALLED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.NOT_INSTALLED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus.CONFIGURATION_ERROR"><code class="docutils literal notranslate"><span class="pre">ToolStatus.CONFIGURATION_ERROR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus.LICENSE_REQUIRED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.LICENSE_REQUIRED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolStatus.DEPRECATED"><code class="docutils literal notranslate"><span class="pre">ToolStatus.DEPRECATED</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability"><code class="docutils literal notranslate"><span class="pre">ToolCapability</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability.name"><code class="docutils literal notranslate"><span class="pre">ToolCapability.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability.description"><code class="docutils literal notranslate"><span class="pre">ToolCapability.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability.supported_languages"><code class="docutils literal notranslate"><span class="pre">ToolCapability.supported_languages</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability.detection_types"><code class="docutils literal notranslate"><span class="pre">ToolCapability.detection_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolCapability.__init__"><code class="docutils literal notranslate"><span class="pre">ToolCapability.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata"><code class="docutils literal notranslate"><span class="pre">ToolMetadata</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.name"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.version"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.category"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.author"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.license"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.license</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.homepage"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.homepage</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.repository"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.repository</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.documentation"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.documentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.installation_cmd"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.installation_cmd</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.capabilities"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.capabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.cost"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.cost</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.requires_api_key"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.requires_api_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.is_optional"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.is_optional</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolMetadata.__init__"><code class="docutils literal notranslate"><span class="pre">ToolMetadata.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter"><code class="docutils literal notranslate"><span class="pre">ToolAdapter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.get_metadata"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.is_available"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.is_available()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.analyze"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.normalize_findings"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.normalize_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.get_installation_instructions"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_installation_instructions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.can_analyze"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.can_analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.get_default_config"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.validate_config"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.validate_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.check_binary_available"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.check_binary_available()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.run_subprocess"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.run_subprocess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.parse_json_safely"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.parse_json_safely()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.normalize_severity"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.normalize_severity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.create_finding"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.create_finding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.create_result"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.create_result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolAdapter.find_binary"><code class="docutils literal notranslate"><span class="pre">ToolAdapter.find_binary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry"><code class="docutils literal notranslate"><span class="pre">ToolRegistry</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.__init__"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.register"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.get_tool"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tool()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.get_all_tools"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_all_tools()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.get_tools_by_category"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tools_by_category()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.get_available_tools"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_available_tools()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.ToolRegistry.get_tool_status_report"><code class="docutils literal notranslate"><span class="pre">ToolRegistry.get_tool_status_report()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.tool_protocol.get_tool_registry"><code class="docutils literal notranslate"><span class="pre">get_tool_registry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#agent-protocol">Agent Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#miesc-agent-protocol">MIESC Agent Protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability"><code class="docutils literal notranslate"><span class="pre">AgentCapability</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.STATIC_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">AgentCapability.STATIC_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.SYMBOLIC_EXECUTION"><code class="docutils literal notranslate"><span class="pre">AgentCapability.SYMBOLIC_EXECUTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.AI_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">AgentCapability.AI_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.FUZZING"><code class="docutils literal notranslate"><span class="pre">AgentCapability.FUZZING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.FORMAL_VERIFICATION"><code class="docutils literal notranslate"><span class="pre">AgentCapability.FORMAL_VERIFICATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.GAS_OPTIMIZATION"><code class="docutils literal notranslate"><span class="pre">AgentCapability.GAS_OPTIMIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.PATTERN_MATCHING"><code class="docutils literal notranslate"><span class="pre">AgentCapability.PATTERN_MATCHING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.DEPENDENCY_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">AgentCapability.DEPENDENCY_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.CODE_QUALITY"><code class="docutils literal notranslate"><span class="pre">AgentCapability.CODE_QUALITY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentCapability.CUSTOM_RULES"><code class="docutils literal notranslate"><span class="pre">AgentCapability.CUSTOM_RULES</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentSpeed"><code class="docutils literal notranslate"><span class="pre">AgentSpeed</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentSpeed.FAST"><code class="docutils literal notranslate"><span class="pre">AgentSpeed.FAST</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentSpeed.MEDIUM"><code class="docutils literal notranslate"><span class="pre">AgentSpeed.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentSpeed.SLOW"><code class="docutils literal notranslate"><span class="pre">AgentSpeed.SLOW</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisStatus"><code class="docutils literal notranslate"><span class="pre">AnalysisStatus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisStatus.SUCCESS"><code class="docutils literal notranslate"><span class="pre">AnalysisStatus.SUCCESS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisStatus.ERROR"><code class="docutils literal notranslate"><span class="pre">AnalysisStatus.ERROR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisStatus.TIMEOUT"><code class="docutils literal notranslate"><span class="pre">AnalysisStatus.TIMEOUT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisStatus.SKIPPED"><code class="docutils literal notranslate"><span class="pre">AnalysisStatus.SKIPPED</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity"><code class="docutils literal notranslate"><span class="pre">FindingSeverity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity.CRITICAL"><code class="docutils literal notranslate"><span class="pre">FindingSeverity.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity.HIGH"><code class="docutils literal notranslate"><span class="pre">FindingSeverity.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity.MEDIUM"><code class="docutils literal notranslate"><span class="pre">FindingSeverity.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity.LOW"><code class="docutils literal notranslate"><span class="pre">FindingSeverity.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.FindingSeverity.INFO"><code class="docutils literal notranslate"><span class="pre">FindingSeverity.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata"><code class="docutils literal notranslate"><span class="pre">AgentMetadata</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.name"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.version"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.description"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.author"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.license"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.license</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.capabilities"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.capabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.supported_languages"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.supported_languages</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.cost"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.cost</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.speed"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.speed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.homepage"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.homepage</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.repository"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.repository</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.documentation"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.documentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.installation"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.installation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.requires"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.requires</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentMetadata.__init__"><code class="docutils literal notranslate"><span class="pre">AgentMetadata.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding"><code class="docutils literal notranslate"><span class="pre">Finding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.type"><code class="docutils literal notranslate"><span class="pre">Finding.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.severity"><code class="docutils literal notranslate"><span class="pre">Finding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.location"><code class="docutils literal notranslate"><span class="pre">Finding.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.message"><code class="docutils literal notranslate"><span class="pre">Finding.message</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.description"><code class="docutils literal notranslate"><span class="pre">Finding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.recommendation"><code class="docutils literal notranslate"><span class="pre">Finding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.reference"><code class="docutils literal notranslate"><span class="pre">Finding.reference</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.confidence"><code class="docutils literal notranslate"><span class="pre">Finding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.impact"><code class="docutils literal notranslate"><span class="pre">Finding.impact</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.code_snippet"><code class="docutils literal notranslate"><span class="pre">Finding.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.Finding.__init__"><code class="docutils literal notranslate"><span class="pre">Finding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult"><code class="docutils literal notranslate"><span class="pre">AnalysisResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.agent"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.agent</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.version"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.status"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.status</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.timestamp"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.timestamp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.execution_time"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.execution_time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.findings"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.findings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.summary"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.summary</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.metadata"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.error"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.error</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AnalysisResult.__init__"><code class="docutils literal notranslate"><span class="pre">AnalysisResult.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent"><code class="docutils literal notranslate"><span class="pre">SecurityAgent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.name"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.version"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.description"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.author"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.license"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.license</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.capabilities"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.capabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.supported_languages"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.supported_languages</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.cost"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.cost</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.speed"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.speed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.is_available"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.is_available()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.can_analyze"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.can_analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.analyze"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.get_metadata"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.get_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.validate"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.validate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.get_config_schema"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.get_config_schema()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.SecurityAgent.configure"><code class="docutils literal notranslate"><span class="pre">SecurityAgent.configure()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentPlugin"><code class="docutils literal notranslate"><span class="pre">AgentPlugin</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentPlugin.register"><code class="docutils literal notranslate"><span class="pre">AgentPlugin.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_protocol.AgentPlugin.get_registered_agents"><code class="docutils literal notranslate"><span class="pre">AgentPlugin.get_registered_agents()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#agent-registry">Agent Registry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#miesc-agent-registry">MIESC Agent Registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry"><code class="docutils literal notranslate"><span class="pre">AgentRegistry</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.__init__"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.register"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.unregister"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.unregister()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.get"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.list_agents"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.list_agents()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.discover_all"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.discover_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.filter_agents"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.filter_agents()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.get_statistics"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.get_statistics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.validate_all"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.validate_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.__len__"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.__len__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.__contains__"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.agent_registry.AgentRegistry.__iter__"><code class="docutils literal notranslate"><span class="pre">AgentRegistry.__iter__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#orchestration">Orchestration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#module-src.core.ml_orchestrator">ML Orchestrator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.ml_orchestrator.MLAnalysisResult"><code class="docutils literal notranslate"><span class="pre">MLAnalysisResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.ml_orchestrator.MLOrchestrator"><code class="docutils literal notranslate"><span class="pre">MLOrchestrator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.ml_orchestrator.get_ml_orchestrator"><code class="docutils literal notranslate"><span class="pre">get_ml_orchestrator()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#exporters">Exporters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding"><code class="docutils literal notranslate"><span class="pre">Finding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.id"><code class="docutils literal notranslate"><span class="pre">Finding.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.type"><code class="docutils literal notranslate"><span class="pre">Finding.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.severity"><code class="docutils literal notranslate"><span class="pre">Finding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.title"><code class="docutils literal notranslate"><span class="pre">Finding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.description"><code class="docutils literal notranslate"><span class="pre">Finding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.file_path"><code class="docutils literal notranslate"><span class="pre">Finding.file_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.line_start"><code class="docutils literal notranslate"><span class="pre">Finding.line_start</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.line_end"><code class="docutils literal notranslate"><span class="pre">Finding.line_end</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.column_start"><code class="docutils literal notranslate"><span class="pre">Finding.column_start</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.column_end"><code class="docutils literal notranslate"><span class="pre">Finding.column_end</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.tool"><code class="docutils literal notranslate"><span class="pre">Finding.tool</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.layer"><code class="docutils literal notranslate"><span class="pre">Finding.layer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.cwe"><code class="docutils literal notranslate"><span class="pre">Finding.cwe</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.swc"><code class="docutils literal notranslate"><span class="pre">Finding.swc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.confidence"><code class="docutils literal notranslate"><span class="pre">Finding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.remediation"><code class="docutils literal notranslate"><span class="pre">Finding.remediation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.Finding.__init__"><code class="docutils literal notranslate"><span class="pre">Finding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SARIFExporter"><code class="docutils literal notranslate"><span class="pre">SARIFExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SARIFExporter.SARIF_VERSION"><code class="docutils literal notranslate"><span class="pre">SARIFExporter.SARIF_VERSION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SARIFExporter.SARIF_SCHEMA"><code class="docutils literal notranslate"><span class="pre">SARIFExporter.SARIF_SCHEMA</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SARIFExporter.__init__"><code class="docutils literal notranslate"><span class="pre">SARIFExporter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SARIFExporter.export"><code class="docutils literal notranslate"><span class="pre">SARIFExporter.export()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SonarQubeExporter"><code class="docutils literal notranslate"><span class="pre">SonarQubeExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.SonarQubeExporter.export"><code class="docutils literal notranslate"><span class="pre">SonarQubeExporter.export()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.CheckmarxExporter"><code class="docutils literal notranslate"><span class="pre">CheckmarxExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.CheckmarxExporter.export"><code class="docutils literal notranslate"><span class="pre">CheckmarxExporter.export()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.MarkdownExporter"><code class="docutils literal notranslate"><span class="pre">MarkdownExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.MarkdownExporter.export"><code class="docutils literal notranslate"><span class="pre">MarkdownExporter.export()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.JSONExporter"><code class="docutils literal notranslate"><span class="pre">JSONExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.JSONExporter.export"><code class="docutils literal notranslate"><span class="pre">JSONExporter.export()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.exporters.ReportExporter"><code class="docutils literal notranslate"><span class="pre">ReportExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.ReportExporter.__init__"><code class="docutils literal notranslate"><span class="pre">ReportExporter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.ReportExporter.export"><code class="docutils literal notranslate"><span class="pre">ReportExporter.export()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.exporters.ReportExporter.export_all"><code class="docutils literal notranslate"><span class="pre">ReportExporter.export_all()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#framework-detection">Framework Detection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#miesc-framework-auto-detection">MIESC Framework Auto-Detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework"><code class="docutils literal notranslate"><span class="pre">Framework</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework.FOUNDRY"><code class="docutils literal notranslate"><span class="pre">Framework.FOUNDRY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework.HARDHAT"><code class="docutils literal notranslate"><span class="pre">Framework.HARDHAT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework.TRUFFLE"><code class="docutils literal notranslate"><span class="pre">Framework.TRUFFLE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework.BROWNIE"><code class="docutils literal notranslate"><span class="pre">Framework.BROWNIE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.Framework.UNKNOWN"><code class="docutils literal notranslate"><span class="pre">Framework.UNKNOWN</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.framework"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.framework</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.root_path"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.root_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.config_file"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.config_file</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.solc_version"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.solc_version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.evm_version"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.evm_version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.optimizer_enabled"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.optimizer_enabled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.optimizer_runs"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.optimizer_runs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.remappings"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.remappings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.lib_paths"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.lib_paths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.src_path"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.src_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.test_path"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.test_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.out_path"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.out_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.extra_config"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.extra_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.to_dict"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkConfig.__init__"><code class="docutils literal notranslate"><span class="pre">FrameworkConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.DETECTION_FILES"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.DETECTION_FILES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.__init__"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.detect"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.detect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.get_solc_args"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.get_solc_args()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.get_slither_args"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.get_slither_args()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.FrameworkDetector.clear_cache"><code class="docutils literal notranslate"><span class="pre">FrameworkDetector.clear_cache()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.detect_framework"><code class="docutils literal notranslate"><span class="pre">detect_framework()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.get_framework_name"><code class="docutils literal notranslate"><span class="pre">get_framework_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.is_foundry_project"><code class="docutils literal notranslate"><span class="pre">is_foundry_project()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.framework_detector.is_hardhat_project"><code class="docutils literal notranslate"><span class="pre">is_hardhat_project()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#rich-cli">Rich CLI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle"><code class="docutils literal notranslate"><span class="pre">SeverityStyle</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle.CRITICAL"><code class="docutils literal notranslate"><span class="pre">SeverityStyle.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle.HIGH"><code class="docutils literal notranslate"><span class="pre">SeverityStyle.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle.MEDIUM"><code class="docutils literal notranslate"><span class="pre">SeverityStyle.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle.LOW"><code class="docutils literal notranslate"><span class="pre">SeverityStyle.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.SeverityStyle.INFO"><code class="docutils literal notranslate"><span class="pre">SeverityStyle.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.BANNER"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.BANNER</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.__init__"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_banner"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_banner()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_welcome"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_welcome()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_tools_status"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_tools_status()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_contract_info"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_contract_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.create_progress"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.create_progress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.run_with_progress"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.run_with_progress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.run_audit_with_progress"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.run_audit_with_progress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_findings_summary"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_findings_summary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_findings_detail"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_findings_detail()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_findings_tree"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_findings_tree()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.prompt_contract"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.prompt_contract()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.prompt_tools"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.prompt_tools()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.prompt_confirm"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.prompt_confirm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_export_options"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_export_options()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.show_completion"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.show_completion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.error"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.warning"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.warning()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.success"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.success()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.MIESCRichCLI.info"><code class="docutils literal notranslate"><span class="pre">MIESCRichCLI.info()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.rich_cli.create_cli"><code class="docutils literal notranslate"><span class="pre">create_cli()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html#correlation-api">Correlation API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.__init__"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.add_tool_results"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.add_tool_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.analyze"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.get_findings_by_severity"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.get_findings_by_severity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.get_findings_by_type"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.get_findings_by_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.get_cross_validated_only"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.get_cross_validated_only()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.MIESCCorrelationAPI.clear"><code class="docutils literal notranslate"><span class="pre">MIESCCorrelationAPI.clear()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.analyze_contract_with_correlation"><code class="docutils literal notranslate"><span class="pre">analyze_contract_with_correlation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#src.core.correlation_api.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/detectors.html">Detectors Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/detectors.html#detector-api">Detector API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity"><code class="docutils literal notranslate"><span class="pre">Severity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.CRITICAL"><code class="docutils literal notranslate"><span class="pre">Severity.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.HIGH"><code class="docutils literal notranslate"><span class="pre">Severity.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.MEDIUM"><code class="docutils literal notranslate"><span class="pre">Severity.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.LOW"><code class="docutils literal notranslate"><span class="pre">Severity.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.INFO"><code class="docutils literal notranslate"><span class="pre">Severity.INFO</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Severity.from_string"><code class="docutils literal notranslate"><span class="pre">Severity.from_string()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category"><code class="docutils literal notranslate"><span class="pre">Category</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.REENTRANCY"><code class="docutils literal notranslate"><span class="pre">Category.REENTRANCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.ACCESS_CONTROL"><code class="docutils literal notranslate"><span class="pre">Category.ACCESS_CONTROL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.ARITHMETIC"><code class="docutils literal notranslate"><span class="pre">Category.ARITHMETIC</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.FLASH_LOAN"><code class="docutils literal notranslate"><span class="pre">Category.FLASH_LOAN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.ORACLE_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">Category.ORACLE_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.GOVERNANCE"><code class="docutils literal notranslate"><span class="pre">Category.GOVERNANCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.RUG_PULL"><code class="docutils literal notranslate"><span class="pre">Category.RUG_PULL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.HONEYPOT"><code class="docutils literal notranslate"><span class="pre">Category.HONEYPOT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.PROXY_UPGRADE"><code class="docutils literal notranslate"><span class="pre">Category.PROXY_UPGRADE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.CENTRALIZATION"><code class="docutils literal notranslate"><span class="pre">Category.CENTRALIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.DOS"><code class="docutils literal notranslate"><span class="pre">Category.DOS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.FRONT_RUNNING"><code class="docutils literal notranslate"><span class="pre">Category.FRONT_RUNNING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.TIMESTAMP_DEPENDENCY"><code class="docutils literal notranslate"><span class="pre">Category.TIMESTAMP_DEPENDENCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.UNCHECKED_RETURN"><code class="docutils literal notranslate"><span class="pre">Category.UNCHECKED_RETURN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.GAS_OPTIMIZATION"><code class="docutils literal notranslate"><span class="pre">Category.GAS_OPTIMIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Category.CUSTOM"><code class="docutils literal notranslate"><span class="pre">Category.CUSTOM</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location"><code class="docutils literal notranslate"><span class="pre">Location</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.file_path"><code class="docutils literal notranslate"><span class="pre">Location.file_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.line_start"><code class="docutils literal notranslate"><span class="pre">Location.line_start</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.line_end"><code class="docutils literal notranslate"><span class="pre">Location.line_end</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.column_start"><code class="docutils literal notranslate"><span class="pre">Location.column_start</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.column_end"><code class="docutils literal notranslate"><span class="pre">Location.column_end</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Location.__init__"><code class="docutils literal notranslate"><span class="pre">Location.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding"><code class="docutils literal notranslate"><span class="pre">Finding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.detector"><code class="docutils literal notranslate"><span class="pre">Finding.detector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.title"><code class="docutils literal notranslate"><span class="pre">Finding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.description"><code class="docutils literal notranslate"><span class="pre">Finding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.severity"><code class="docutils literal notranslate"><span class="pre">Finding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.category"><code class="docutils literal notranslate"><span class="pre">Finding.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.confidence"><code class="docutils literal notranslate"><span class="pre">Finding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.location"><code class="docutils literal notranslate"><span class="pre">Finding.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.code_snippet"><code class="docutils literal notranslate"><span class="pre">Finding.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.recommendation"><code class="docutils literal notranslate"><span class="pre">Finding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.references"><code class="docutils literal notranslate"><span class="pre">Finding.references</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.cwe_id"><code class="docutils literal notranslate"><span class="pre">Finding.cwe_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.swc_id"><code class="docutils literal notranslate"><span class="pre">Finding.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.metadata"><code class="docutils literal notranslate"><span class="pre">Finding.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.to_dict"><code class="docutils literal notranslate"><span class="pre">Finding.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.Finding.__init__"><code class="docutils literal notranslate"><span class="pre">Finding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector"><code class="docutils literal notranslate"><span class="pre">BaseDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.name"><code class="docutils literal notranslate"><span class="pre">BaseDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.description"><code class="docutils literal notranslate"><span class="pre">BaseDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.version"><code class="docutils literal notranslate"><span class="pre">BaseDetector.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.author"><code class="docutils literal notranslate"><span class="pre">BaseDetector.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.category"><code class="docutils literal notranslate"><span class="pre">BaseDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.default_severity"><code class="docutils literal notranslate"><span class="pre">BaseDetector.default_severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.target_patterns"><code class="docutils literal notranslate"><span class="pre">BaseDetector.target_patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.__init__"><code class="docutils literal notranslate"><span class="pre">BaseDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.enabled"><code class="docutils literal notranslate"><span class="pre">BaseDetector.enabled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.configure"><code class="docutils literal notranslate"><span class="pre">BaseDetector.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.should_run"><code class="docutils literal notranslate"><span class="pre">BaseDetector.should_run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.analyze"><code class="docutils literal notranslate"><span class="pre">BaseDetector.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.analyze_file"><code class="docutils literal notranslate"><span class="pre">BaseDetector.analyze_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.create_finding"><code class="docutils literal notranslate"><span class="pre">BaseDetector.create_finding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.find_pattern"><code class="docutils literal notranslate"><span class="pre">BaseDetector.find_pattern()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.BaseDetector.find_multiline_pattern"><code class="docutils literal notranslate"><span class="pre">BaseDetector.find_multiline_pattern()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.PatternDetector"><code class="docutils literal notranslate"><span class="pre">PatternDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.PatternDetector.PATTERNS"><code class="docutils literal notranslate"><span class="pre">PatternDetector.PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.PatternDetector.analyze"><code class="docutils literal notranslate"><span class="pre">PatternDetector.analyze()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.detectors"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.detectors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.register"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.register_class"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.register_class()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.unregister"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.unregister()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.get"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.list_detectors"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.list_detectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.run_all"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.run_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.DetectorRegistry.get_summary"><code class="docutils literal notranslate"><span class="pre">DetectorRegistry.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.register_detector"><code class="docutils literal notranslate"><span class="pre">register_detector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.detector_api.get_registry"><code class="docutils literal notranslate"><span class="pre">get_registry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/detectors.html#defi-detectors">DeFi Detectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity"><code class="docutils literal notranslate"><span class="pre">Severity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity.CRITICAL"><code class="docutils literal notranslate"><span class="pre">Severity.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity.HIGH"><code class="docutils literal notranslate"><span class="pre">Severity.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity.MEDIUM"><code class="docutils literal notranslate"><span class="pre">Severity.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity.LOW"><code class="docutils literal notranslate"><span class="pre">Severity.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.Severity.INFO"><code class="docutils literal notranslate"><span class="pre">Severity.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory"><code class="docutils literal notranslate"><span class="pre">DeFiCategory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.FLASH_LOAN"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.FLASH_LOAN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.ORACLE_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.ORACLE_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.PRICE_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.PRICE_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.SANDWICH_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.SANDWICH_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.MEV_EXPOSURE"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.MEV_EXPOSURE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.SLIPPAGE"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.SLIPPAGE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiCategory.LIQUIDITY"><code class="docutils literal notranslate"><span class="pre">DeFiCategory.LIQUIDITY</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding"><code class="docutils literal notranslate"><span class="pre">DeFiFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.title"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.description"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.severity"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.category"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.line"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.code_snippet"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.recommendation"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.references"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.references</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.confidence"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiFinding.__init__"><code class="docutils literal notranslate"><span class="pre">DeFiFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetector"><code class="docutils literal notranslate"><span class="pre">DeFiDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetector.name"><code class="docutils literal notranslate"><span class="pre">DeFiDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetector.description"><code class="docutils literal notranslate"><span class="pre">DeFiDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetector.category"><code class="docutils literal notranslate"><span class="pre">DeFiDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetector.detect"><code class="docutils literal notranslate"><span class="pre">DeFiDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.name"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.description"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.category"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.CALLBACK_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.CALLBACK_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.DANGER_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.DANGER_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.FlashLoanDetector.detect"><code class="docutils literal notranslate"><span class="pre">FlashLoanDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.name"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.description"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.category"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.ORACLE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.ORACLE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.STALENESS_CHECK"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.STALENESS_CHECK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.DEVIATION_CHECK"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.DEVIATION_CHECK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.OracleManipulationDetector.detect"><code class="docutils literal notranslate"><span class="pre">OracleManipulationDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.name"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.description"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.category"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.SWAP_PATTERNS"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.SWAP_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.SLIPPAGE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.SLIPPAGE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.SandwichAttackDetector.detect"><code class="docutils literal notranslate"><span class="pre">SandwichAttackDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.name"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.description"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.category"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.MEV_PATTERNS"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.MEV_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.PROTECTION_PATTERNS"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.PROTECTION_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.MEVExposureDetector.detect"><code class="docutils literal notranslate"><span class="pre">MEVExposureDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.name"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.description"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.category"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.PRICE_CALC_PATTERNS"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.PRICE_CALC_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.SANITY_CHECK_PATTERNS"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.SANITY_CHECK_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.PriceManipulationDetector.detect"><code class="docutils literal notranslate"><span class="pre">PriceManipulationDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine.__init__"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine.detectors"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine.detectors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine.analyze"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine.analyze_file"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine.analyze_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.DeFiDetectorEngine.get_summary"><code class="docutils literal notranslate"><span class="pre">DeFiDetectorEngine.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.defi_detectors.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/detectors.html#advanced-detectors">Advanced Detectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity"><code class="docutils literal notranslate"><span class="pre">Severity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity.CRITICAL"><code class="docutils literal notranslate"><span class="pre">Severity.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity.HIGH"><code class="docutils literal notranslate"><span class="pre">Severity.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity.MEDIUM"><code class="docutils literal notranslate"><span class="pre">Severity.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity.LOW"><code class="docutils literal notranslate"><span class="pre">Severity.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.Severity.INFO"><code class="docutils literal notranslate"><span class="pre">Severity.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory"><code class="docutils literal notranslate"><span class="pre">AttackCategory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.RUG_PULL"><code class="docutils literal notranslate"><span class="pre">AttackCategory.RUG_PULL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.GOVERNANCE"><code class="docutils literal notranslate"><span class="pre">AttackCategory.GOVERNANCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.HONEYPOT"><code class="docutils literal notranslate"><span class="pre">AttackCategory.HONEYPOT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.TOKEN_SECURITY"><code class="docutils literal notranslate"><span class="pre">AttackCategory.TOKEN_SECURITY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.PROXY_UPGRADE"><code class="docutils literal notranslate"><span class="pre">AttackCategory.PROXY_UPGRADE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AttackCategory.CENTRALIZATION"><code class="docutils literal notranslate"><span class="pre">AttackCategory.CENTRALIZATION</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.title"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.description"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.severity"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.category"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.line"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.code_snippet"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.recommendation"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.references"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.references</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.confidence"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedFinding.__init__"><code class="docutils literal notranslate"><span class="pre">AdvancedFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector"><code class="docutils literal notranslate"><span class="pre">RugPullDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.name"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.description"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.category"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.OWNER_DRAIN_PATTERNS"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.OWNER_DRAIN_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.HIDDEN_MINT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.HIDDEN_MINT_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.BLACKLIST_PATTERNS"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.BLACKLIST_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.RugPullDetector.detect"><code class="docutils literal notranslate"><span class="pre">RugPullDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.name"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.description"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.category"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.FLASH_LOAN_VOTE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.FLASH_LOAN_VOTE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.TIMELOCK_PATTERNS"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.TIMELOCK_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.QUORUM_PATTERNS"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.QUORUM_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.GovernanceDetector.detect"><code class="docutils literal notranslate"><span class="pre">GovernanceDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.name"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.description"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.category"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.HONEYPOT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.HONEYPOT_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.HIDDEN_FEE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.HIDDEN_FEE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.MAX_TX_PATTERNS"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.MAX_TX_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.ANTIBOT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.ANTIBOT_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.TokenSecurityDetector.detect"><code class="docutils literal notranslate"><span class="pre">TokenSecurityDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.name"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.description"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.category"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.INIT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.INIT_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.STORAGE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.STORAGE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.UPGRADE_AUTH_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.UPGRADE_AUTH_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.DELEGATECALL_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.DELEGATECALL_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.ProxyUpgradeDetector.detect"><code class="docutils literal notranslate"><span class="pre">ProxyUpgradeDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector.name"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector.description"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector.category"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector.CENTRALIZATION_PATTERNS"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector.CENTRALIZATION_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.CentralizationDetector.detect"><code class="docutils literal notranslate"><span class="pre">CentralizationDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedDetectorEngine"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorEngine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedDetectorEngine.__init__"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorEngine.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedDetectorEngine.analyze"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorEngine.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedDetectorEngine.analyze_file"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorEngine.analyze_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.AdvancedDetectorEngine.get_summary"><code class="docutils literal notranslate"><span class="pre">AdvancedDetectorEngine.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.advanced_detectors.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/detectors.html#dependency-analyzer">Dependency Analyzer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk"><code class="docutils literal notranslate"><span class="pre">DependencyRisk</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk.CRITICAL"><code class="docutils literal notranslate"><span class="pre">DependencyRisk.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk.HIGH"><code class="docutils literal notranslate"><span class="pre">DependencyRisk.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk.MEDIUM"><code class="docutils literal notranslate"><span class="pre">DependencyRisk.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk.LOW"><code class="docutils literal notranslate"><span class="pre">DependencyRisk.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyRisk.INFO"><code class="docutils literal notranslate"><span class="pre">DependencyRisk.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding"><code class="docutils literal notranslate"><span class="pre">DependencyFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.title"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.description"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.severity"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.package"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.package</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.version"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.line"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.recommendation"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.cve"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.cve</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.references"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.references</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyFinding.__init__"><code class="docutils literal notranslate"><span class="pre">DependencyFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.name"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.layer"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.layer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.description"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.__init__"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.analyze"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.analyze_file"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.analyze_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.DependencyAnalyzer.get_summary"><code class="docutils literal notranslate"><span class="pre">DependencyAnalyzer.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.dependency_analyzer.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/detectors.html#smartbugs-detectors">SmartBugs Detectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity"><code class="docutils literal notranslate"><span class="pre">Severity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity.CRITICAL"><code class="docutils literal notranslate"><span class="pre">Severity.CRITICAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity.HIGH"><code class="docutils literal notranslate"><span class="pre">Severity.HIGH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity.MEDIUM"><code class="docutils literal notranslate"><span class="pre">Severity.MEDIUM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity.LOW"><code class="docutils literal notranslate"><span class="pre">Severity.LOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.Severity.INFO"><code class="docutils literal notranslate"><span class="pre">Severity.INFO</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.title"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.description"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.severity"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.category"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.line"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.code_snippet"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.swc_id"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.confidence"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsFinding.__init__"><code class="docutils literal notranslate"><span class="pre">SmartBugsFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.name"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.category"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.ARITHMETIC_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.ARITHMETIC_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.SAFEMATH_LINE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.SAFEMATH_LINE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ArithmeticDetector.detect"><code class="docutils literal notranslate"><span class="pre">ArithmeticDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.name"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.category"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.WEAK_RANDOMNESS_PATTERNS"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.WEAK_RANDOMNESS_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.RANDOMNESS_CONTEXT"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.RANDOMNESS_CONTEXT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.BadRandomnessDetector.detect"><code class="docutils literal notranslate"><span class="pre">BadRandomnessDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector.name"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector.category"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector.DOS_PATTERNS"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector.DOS_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.DenialOfServiceDetector.detect"><code class="docutils literal notranslate"><span class="pre">DenialOfServiceDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector.name"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector.category"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector.FRONT_RUNNING_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector.FRONT_RUNNING_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.FrontRunningDetector.detect"><code class="docutils literal notranslate"><span class="pre">FrontRunningDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector.name"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector.category"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector.VULNERABLE_FUNCTION_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector.VULNERABLE_FUNCTION_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ShortAddressDetector.detect"><code class="docutils literal notranslate"><span class="pre">ShortAddressDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.name"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.category"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.EXTERNAL_CALL_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.EXTERNAL_CALL_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.STATE_CHANGE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.STATE_CHANGE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.ReentrancyDetector.detect"><code class="docutils literal notranslate"><span class="pre">ReentrancyDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.name"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.category"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.CRITICAL_FUNCTIONS"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.CRITICAL_FUNCTIONS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.ACCESS_CONTROL_PATTERNS"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.ACCESS_CONTROL_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.AccessControlDetector.detect"><code class="docutils literal notranslate"><span class="pre">AccessControlDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector.name"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector.category"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector.LOW_LEVEL_CALLS"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector.LOW_LEVEL_CALLS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.UncheckedLowLevelCallsDetector.detect"><code class="docutils literal notranslate"><span class="pre">UncheckedLowLevelCallsDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector.name"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector.category"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector.swc_id"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector.TIME_PATTERNS"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector.TIME_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.TimeManipulationDetector.detect"><code class="docutils literal notranslate"><span class="pre">TimeManipulationDetector.detect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsDetectorEngine"><code class="docutils literal notranslate"><span class="pre">SmartBugsDetectorEngine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsDetectorEngine.__init__"><code class="docutils literal notranslate"><span class="pre">SmartBugsDetectorEngine.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsDetectorEngine.analyze"><code class="docutils literal notranslate"><span class="pre">SmartBugsDetectorEngine.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsDetectorEngine.analyze_file"><code class="docutils literal notranslate"><span class="pre">SmartBugsDetectorEngine.analyze_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.SmartBugsDetectorEngine.get_summary"><code class="docutils literal notranslate"><span class="pre">SmartBugsDetectorEngine.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/detectors.html#src.detectors.smartbugs_detectors.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/llm.html">LLM Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/llm.html#llm-orchestrator">LLM Orchestrator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMProvider"><code class="docutils literal notranslate"><span class="pre">LLMProvider</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMProvider.OLLAMA"><code class="docutils literal notranslate"><span class="pre">LLMProvider.OLLAMA</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMProvider.OPENAI"><code class="docutils literal notranslate"><span class="pre">LLMProvider.OPENAI</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMProvider.ANTHROPIC"><code class="docutils literal notranslate"><span class="pre">LLMProvider.ANTHROPIC</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMProvider.LOCAL"><code class="docutils literal notranslate"><span class="pre">LLMProvider.LOCAL</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig"><code class="docutils literal notranslate"><span class="pre">LLMConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.provider"><code class="docutils literal notranslate"><span class="pre">LLMConfig.provider</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.model"><code class="docutils literal notranslate"><span class="pre">LLMConfig.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.api_key"><code class="docutils literal notranslate"><span class="pre">LLMConfig.api_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.base_url"><code class="docutils literal notranslate"><span class="pre">LLMConfig.base_url</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.temperature"><code class="docutils literal notranslate"><span class="pre">LLMConfig.temperature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.max_tokens"><code class="docutils literal notranslate"><span class="pre">LLMConfig.max_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.timeout"><code class="docutils literal notranslate"><span class="pre">LLMConfig.timeout</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.retry_attempts"><code class="docutils literal notranslate"><span class="pre">LLMConfig.retry_attempts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.retry_delay"><code class="docutils literal notranslate"><span class="pre">LLMConfig.retry_delay</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMConfig.__init__"><code class="docutils literal notranslate"><span class="pre">LLMConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse"><code class="docutils literal notranslate"><span class="pre">LLMResponse</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.content"><code class="docutils literal notranslate"><span class="pre">LLMResponse.content</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.provider"><code class="docutils literal notranslate"><span class="pre">LLMResponse.provider</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.model"><code class="docutils literal notranslate"><span class="pre">LLMResponse.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.tokens_used"><code class="docutils literal notranslate"><span class="pre">LLMResponse.tokens_used</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.latency_ms"><code class="docutils literal notranslate"><span class="pre">LLMResponse.latency_ms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.cached"><code class="docutils literal notranslate"><span class="pre">LLMResponse.cached</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.metadata"><code class="docutils literal notranslate"><span class="pre">LLMResponse.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMResponse.__init__"><code class="docutils literal notranslate"><span class="pre">LLMResponse.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.vulnerabilities"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.vulnerabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.severity_assessment"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.severity_assessment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.recommendations"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.recommendations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.confidence_score"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.confidence_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.analysis_summary"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.analysis_summary</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.raw_response"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.raw_response</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.VulnerabilityAnalysis.__init__"><code class="docutils literal notranslate"><span class="pre">VulnerabilityAnalysis.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMBackend"><code class="docutils literal notranslate"><span class="pre">LLMBackend</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMBackend.__init__"><code class="docutils literal notranslate"><span class="pre">LLMBackend.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMBackend.analyze"><code class="docutils literal notranslate"><span class="pre">LLMBackend.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMBackend.health_check"><code class="docutils literal notranslate"><span class="pre">LLMBackend.health_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMBackend.get_system_prompt"><code class="docutils literal notranslate"><span class="pre">LLMBackend.get_system_prompt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OllamaBackend"><code class="docutils literal notranslate"><span class="pre">OllamaBackend</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OllamaBackend.__init__"><code class="docutils literal notranslate"><span class="pre">OllamaBackend.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OllamaBackend.health_check"><code class="docutils literal notranslate"><span class="pre">OllamaBackend.health_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OllamaBackend.analyze"><code class="docutils literal notranslate"><span class="pre">OllamaBackend.analyze()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OpenAIBackend"><code class="docutils literal notranslate"><span class="pre">OpenAIBackend</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OpenAIBackend.__init__"><code class="docutils literal notranslate"><span class="pre">OpenAIBackend.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OpenAIBackend.health_check"><code class="docutils literal notranslate"><span class="pre">OpenAIBackend.health_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.OpenAIBackend.analyze"><code class="docutils literal notranslate"><span class="pre">OpenAIBackend.analyze()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.AnthropicBackend"><code class="docutils literal notranslate"><span class="pre">AnthropicBackend</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.AnthropicBackend.__init__"><code class="docutils literal notranslate"><span class="pre">AnthropicBackend.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.AnthropicBackend.health_check"><code class="docutils literal notranslate"><span class="pre">AnthropicBackend.health_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.AnthropicBackend.analyze"><code class="docutils literal notranslate"><span class="pre">AnthropicBackend.analyze()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.__init__"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.backends"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.backends</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.primary_provider"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.primary_provider</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.cache"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.cache</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.cache_ttl"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.cache_ttl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.initialize"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.initialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.analyze_contract"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.analyze_contract()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.query"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.select_model_for_task"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.select_model_for_task()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.get_available_providers"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.get_available_providers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.LLMOrchestrator.clear_cache"><code class="docutils literal notranslate"><span class="pre">LLMOrchestrator.clear_cache()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.llm_orchestrator.analyze_solidity"><code class="docutils literal notranslate"><span class="pre">analyze_solidity()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/llm.html#embedding-rag">Embedding RAG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#embedding-based-rag-for-vulnerability-analysis-miesc-v5-1-0">Embedding-based RAG for Vulnerability Analysis - MIESC v5.1.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.id"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.swc_id"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.cwe_id"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.cwe_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.title"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.description"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.vulnerable_code"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.vulnerable_code</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.fixed_code"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.fixed_code</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.attack_scenario"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.attack_scenario</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.severity"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.category"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.category</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.real_exploit"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.real_exploit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.tags"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.tags</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.references"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.references</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.to_text"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.to_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.to_metadata"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.to_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.VulnerabilityDocument.__init__"><code class="docutils literal notranslate"><span class="pre">VulnerabilityDocument.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult"><code class="docutils literal notranslate"><span class="pre">RetrievalResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult.document"><code class="docutils literal notranslate"><span class="pre">RetrievalResult.document</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult.similarity_score"><code class="docutils literal notranslate"><span class="pre">RetrievalResult.similarity_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult.relevance_reason"><code class="docutils literal notranslate"><span class="pre">RetrievalResult.relevance_reason</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult.to_context"><code class="docutils literal notranslate"><span class="pre">RetrievalResult.to_context()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.RetrievalResult.__init__"><code class="docutils literal notranslate"><span class="pre">RetrievalResult.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.DEFAULT_MODEL"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.DEFAULT_MODEL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.COLLECTION_NAME"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.COLLECTION_NAME</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.CACHE_MAX_SIZE"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.CACHE_MAX_SIZE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.CACHE_TTL_SECONDS"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.CACHE_TTL_SECONDS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.__init__"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.get_cache_stats"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.get_cache_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.clear_cache"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.clear_cache()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.search"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.search()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.batch_search"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.batch_search()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.search_by_finding"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.search_by_finding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.get_context_for_llm"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.get_context_for_llm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.add_custom_vulnerability"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.add_custom_vulnerability()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.get_stats"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.get_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.EmbeddingRAG.reindex"><code class="docutils literal notranslate"><span class="pre">EmbeddingRAG.reindex()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.HybridRAG"><code class="docutils literal notranslate"><span class="pre">HybridRAG</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.HybridRAG.__init__"><code class="docutils literal notranslate"><span class="pre">HybridRAG.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.HybridRAG.search"><code class="docutils literal notranslate"><span class="pre">HybridRAG.search()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.get_rag"><code class="docutils literal notranslate"><span class="pre">get_rag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.search_vulnerabilities"><code class="docutils literal notranslate"><span class="pre">search_vulnerabilities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.get_context_for_finding"><code class="docutils literal notranslate"><span class="pre">get_context_for_finding()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#src.llm.embedding_rag.batch_get_context_for_findings"><code class="docutils literal notranslate"><span class="pre">batch_get_context_for_findings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/llm.html#architecture">Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#rag-components">RAG Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#supported-models">Supported Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/llm.html#configuration">Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/ml.html">ML Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#classic-patterns">Classic Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#classic-vulnerability-pattern-detector">Classic Vulnerability Pattern Detector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.REENTRANCY"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.REENTRANCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.ACCESS_CONTROL"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.ACCESS_CONTROL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.ARITHMETIC"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.ARITHMETIC</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.UNCHECKED_CALLS"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.UNCHECKED_CALLS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.UNCHECKED_SEND"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.UNCHECKED_SEND</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.TIMESTAMP"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.TIMESTAMP</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.BAD_RANDOMNESS"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.BAD_RANDOMNESS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.FRONT_RUNNING"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.FRONT_RUNNING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.DOS"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.DOS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.SHORT_ADDRESS"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.SHORT_ADDRESS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.VYPER_REENTRANCY"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.VYPER_REENTRANCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.PERMIT_FRONTRUN"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.PERMIT_FRONTRUN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.INTEGER_OVERFLOW"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.INTEGER_OVERFLOW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicVulnType.INTEGER_UNDERFLOW"><code class="docutils literal notranslate"><span class="pre">ClassicVulnType.INTEGER_UNDERFLOW</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch"><code class="docutils literal notranslate"><span class="pre">PatternMatch</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.vuln_type"><code class="docutils literal notranslate"><span class="pre">PatternMatch.vuln_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.line"><code class="docutils literal notranslate"><span class="pre">PatternMatch.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.code_snippet"><code class="docutils literal notranslate"><span class="pre">PatternMatch.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.pattern_matched"><code class="docutils literal notranslate"><span class="pre">PatternMatch.pattern_matched</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.confidence"><code class="docutils literal notranslate"><span class="pre">PatternMatch.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.severity"><code class="docutils literal notranslate"><span class="pre">PatternMatch.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.swc_id"><code class="docutils literal notranslate"><span class="pre">PatternMatch.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.description"><code class="docutils literal notranslate"><span class="pre">PatternMatch.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.recommendation"><code class="docutils literal notranslate"><span class="pre">PatternMatch.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternMatch.__init__"><code class="docutils literal notranslate"><span class="pre">PatternMatch.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig"><code class="docutils literal notranslate"><span class="pre">PatternConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.vuln_type"><code class="docutils literal notranslate"><span class="pre">PatternConfig.vuln_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.patterns"><code class="docutils literal notranslate"><span class="pre">PatternConfig.patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.anti_patterns"><code class="docutils literal notranslate"><span class="pre">PatternConfig.anti_patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.severity"><code class="docutils literal notranslate"><span class="pre">PatternConfig.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.swc_id"><code class="docutils literal notranslate"><span class="pre">PatternConfig.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.description"><code class="docutils literal notranslate"><span class="pre">PatternConfig.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.recommendation"><code class="docutils literal notranslate"><span class="pre">PatternConfig.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.context_validator"><code class="docutils literal notranslate"><span class="pre">PatternConfig.context_validator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.PatternConfig.__init__"><code class="docutils literal notranslate"><span class="pre">PatternConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicPatternDetector"><code class="docutils literal notranslate"><span class="pre">ClassicPatternDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicPatternDetector.__init__"><code class="docutils literal notranslate"><span class="pre">ClassicPatternDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicPatternDetector.detect"><code class="docutils literal notranslate"><span class="pre">ClassicPatternDetector.detect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.ClassicPatternDetector.detect_with_context"><code class="docutils literal notranslate"><span class="pre">ClassicPatternDetector.detect_with_context()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.detect_classic_vulnerabilities"><code class="docutils literal notranslate"><span class="pre">detect_classic_vulnerabilities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.vuln_type"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.vuln_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.severity"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.line"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.function"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.description"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.recommendation"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.confidence"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlFinding.__init__"><code class="docutils literal notranslate"><span class="pre">AccessControlFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.PRIVILEGED_OPERATIONS"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.PRIVILEGED_OPERATIONS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.ACCESS_CONTROL_MODIFIERS"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.ACCESS_CONTROL_MODIFIERS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.REQUIRE_ACCESS_PATTERNS"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.REQUIRE_ACCESS_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.__init__"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.analyze"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.AccessControlSemanticDetector.to_findings"><code class="docutils literal notranslate"><span class="pre">AccessControlSemanticDetector.to_findings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding"><code class="docutils literal notranslate"><span class="pre">DoSFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.vuln_type"><code class="docutils literal notranslate"><span class="pre">DoSFinding.vuln_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.severity"><code class="docutils literal notranslate"><span class="pre">DoSFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.line"><code class="docutils literal notranslate"><span class="pre">DoSFinding.line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.function"><code class="docutils literal notranslate"><span class="pre">DoSFinding.function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.description"><code class="docutils literal notranslate"><span class="pre">DoSFinding.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.recommendation"><code class="docutils literal notranslate"><span class="pre">DoSFinding.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.confidence"><code class="docutils literal notranslate"><span class="pre">DoSFinding.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSFinding.__init__"><code class="docutils literal notranslate"><span class="pre">DoSFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.UNBOUNDED_LOOP_PATTERNS"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.UNBOUNDED_LOOP_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.USER_GROWING_ARRAY_PATTERNS"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.USER_GROWING_ARRAY_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.PUSH_PAYMENT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.PUSH_PAYMENT_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.GAS_HEAVY_OPERATIONS"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.GAS_HEAVY_OPERATIONS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.__init__"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.analyze"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.DoSCrossFunctionDetector.to_findings"><code class="docutils literal notranslate"><span class="pre">DoSCrossFunctionDetector.to_findings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.classic_patterns.detect_semantic_vulnerabilities"><code class="docutils literal notranslate"><span class="pre">detect_semantic_vulnerabilities()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#defi-patterns">DeFi Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#defi-vulnerability-pattern-detector">DeFi Vulnerability Pattern Detector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.FLASH_LOAN_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.FLASH_LOAN_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.SANDWICH_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.SANDWICH_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.GOVERNANCE_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.GOVERNANCE_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.BRIDGE_VULNERABILITY"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.BRIDGE_VULNERABILITY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.ORACLE_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.ORACLE_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.LIQUIDITY_DRAIN"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.LIQUIDITY_DRAIN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.PRICE_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.PRICE_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.REWARD_MANIPULATION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.REWARD_MANIPULATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.FRONT_RUNNING"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.FRONT_RUNNING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.MEV_EXTRACTION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.MEV_EXTRACTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.DONATION_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.DONATION_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.INFLATION_ATTACK"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.INFLATION_ATTACK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.READ_ONLY_REENTRANCY"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.READ_ONLY_REENTRANCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.ERC4626_INFLATION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.ERC4626_INFLATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.ARBITRARY_EXTERNAL_CALL"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.ARBITRARY_EXTERNAL_CALL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.PRECISION_LOSS"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.PRECISION_LOSS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.CROSS_FUNCTION_REENTRANCY"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.CROSS_FUNCTION_REENTRANCY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.SIGNATURE_REPLAY"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.SIGNATURE_REPLAY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.FIRST_DEPOSITOR"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.FIRST_DEPOSITOR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnType.STORAGE_COLLISION"><code class="docutils literal notranslate"><span class="pre">DeFiVulnType.STORAGE_COLLISION</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.vuln_type"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.vuln_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.name"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.severity"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.indicators"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.indicators</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.anti_patterns"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.anti_patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.description"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.attack_example"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.attack_example</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.real_exploits"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.real_exploits</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.remediation"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.remediation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.swc_id"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.estimated_loss_usd"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.estimated_loss_usd</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiVulnerabilityPattern.__init__"><code class="docutils literal notranslate"><span class="pre">DeFiVulnerabilityPattern.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.pattern"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.pattern</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.matched_indicators"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.matched_indicators</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.matched_anti_patterns"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.matched_anti_patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.confidence"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.location"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.code_snippet"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.code_snippet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.is_vulnerable"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.is_vulnerable</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.recommendation"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.recommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternMatch.__init__"><code class="docutils literal notranslate"><span class="pre">DeFiPatternMatch.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternDetector"><code class="docutils literal notranslate"><span class="pre">DeFiPatternDetector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternDetector.__init__"><code class="docutils literal notranslate"><span class="pre">DeFiPatternDetector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternDetector.analyze_code"><code class="docutils literal notranslate"><span class="pre">DeFiPatternDetector.analyze_code()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternDetector.get_pattern_info"><code class="docutils literal notranslate"><span class="pre">DeFiPatternDetector.get_pattern_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.DeFiPatternDetector.get_all_patterns"><code class="docutils literal notranslate"><span class="pre">DeFiPatternDetector.get_all_patterns()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.defi_patterns.detect_defi_vulnerabilities"><code class="docutils literal notranslate"><span class="pre">detect_defi_vulnerabilities()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#false-positive-classifier">False Positive Classifier</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#false-positive-classifier-for-miesc-v4-7-0">False Positive Classifier for MIESC v4.7.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory"><code class="docutils literal notranslate"><span class="pre">FeatureCategory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory.FINDING_METADATA"><code class="docutils literal notranslate"><span class="pre">FeatureCategory.FINDING_METADATA</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory.CODE_CONTEXT"><code class="docutils literal notranslate"><span class="pre">FeatureCategory.CODE_CONTEXT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory.SEMANTIC_GUARDS"><code class="docutils literal notranslate"><span class="pre">FeatureCategory.SEMANTIC_GUARDS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory.SOLIDITY_VERSION"><code class="docutils literal notranslate"><span class="pre">FeatureCategory.SOLIDITY_VERSION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureCategory.CONTRACT_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FeatureCategory.CONTRACT_PATTERNS</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures"><code class="docutils literal notranslate"><span class="pre">FindingFeatures</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.confidence"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.severity_score"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.severity_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.tool_count"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.tool_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_swc_id"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.line_count"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.line_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.function_complexity"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.function_complexity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_external_call"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_external_call</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_state_change"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_state_change</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_ether_transfer"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_ether_transfer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_require_check"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_require_check</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_modifier"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_modifier</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_reentrancy_guard"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_reentrancy_guard</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_access_control"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_access_control</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.follows_cei_pattern"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.follows_cei_pattern</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.is_solidity_08_plus"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.is_solidity_08_plus</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.uses_safemath"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.uses_safemath</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.is_proxy_contract"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.is_proxy_contract</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.is_upgradeable"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.is_upgradeable</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.has_initializer"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.has_initializer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.to_vector"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.to_vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.feature_names"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.feature_names()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FindingFeatures.__init__"><code class="docutils literal notranslate"><span class="pre">FindingFeatures.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction"><code class="docutils literal notranslate"><span class="pre">FPPrediction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.is_false_positive"><code class="docutils literal notranslate"><span class="pre">FPPrediction.is_false_positive</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.fp_probability"><code class="docutils literal notranslate"><span class="pre">FPPrediction.fp_probability</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.confidence"><code class="docutils literal notranslate"><span class="pre">FPPrediction.confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.contributing_factors"><code class="docutils literal notranslate"><span class="pre">FPPrediction.contributing_factors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.adjusted_confidence"><code class="docutils literal notranslate"><span class="pre">FPPrediction.adjusted_confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPPrediction.__init__"><code class="docutils literal notranslate"><span class="pre">FPPrediction.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.REENTRANCY_GUARD_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.REENTRANCY_GUARD_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.ACCESS_CONTROL_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.ACCESS_CONTROL_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.CEI_VIOLATION_PATTERN"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.CEI_VIOLATION_PATTERN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.EXTERNAL_CALL_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.EXTERNAL_CALL_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.STATE_CHANGE_PATTERNS"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.STATE_CHANGE_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FeatureExtractor.extract_features"><code class="docutils literal notranslate"><span class="pre">FeatureExtractor.extract_features()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier"><code class="docutils literal notranslate"><span class="pre">FPClassifier</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier.FEATURE_WEIGHTS"><code class="docutils literal notranslate"><span class="pre">FPClassifier.FEATURE_WEIGHTS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier.VULN_TYPE_ADJUSTMENTS"><code class="docutils literal notranslate"><span class="pre">FPClassifier.VULN_TYPE_ADJUSTMENTS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier.__init__"><code class="docutils literal notranslate"><span class="pre">FPClassifier.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier.predict"><code class="docutils literal notranslate"><span class="pre">FPClassifier.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.FPClassifier.filter_findings"><code class="docutils literal notranslate"><span class="pre">FPClassifier.filter_findings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.classify_false_positives"><code class="docutils literal notranslate"><span class="pre">classify_false_positives()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.fp_classifier.filter_likely_fps"><code class="docutils literal notranslate"><span class="pre">filter_likely_fps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#correlation-engine">Correlation Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelationMethod"><code class="docutils literal notranslate"><span class="pre">CorrelationMethod</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelationMethod.EXACT"><code class="docutils literal notranslate"><span class="pre">CorrelationMethod.EXACT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelationMethod.SEMANTIC"><code class="docutils literal notranslate"><span class="pre">CorrelationMethod.SEMANTIC</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelationMethod.CONTEXTUAL"><code class="docutils literal notranslate"><span class="pre">CorrelationMethod.CONTEXTUAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelationMethod.EMBEDDING"><code class="docutils literal notranslate"><span class="pre">CorrelationMethod.EMBEDDING</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain"><code class="docutils literal notranslate"><span class="pre">ExploitChain</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.id"><code class="docutils literal notranslate"><span class="pre">ExploitChain.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.name"><code class="docutils literal notranslate"><span class="pre">ExploitChain.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.description"><code class="docutils literal notranslate"><span class="pre">ExploitChain.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.severity"><code class="docutils literal notranslate"><span class="pre">ExploitChain.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.base_cvss"><code class="docutils literal notranslate"><span class="pre">ExploitChain.base_cvss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.vulnerabilities"><code class="docutils literal notranslate"><span class="pre">ExploitChain.vulnerabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.vuln_types"><code class="docutils literal notranslate"><span class="pre">ExploitChain.vuln_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.attack_vector"><code class="docutils literal notranslate"><span class="pre">ExploitChain.attack_vector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.exploitability_score"><code class="docutils literal notranslate"><span class="pre">ExploitChain.exploitability_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.impact_score"><code class="docutils literal notranslate"><span class="pre">ExploitChain.impact_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.complexity"><code class="docutils literal notranslate"><span class="pre">ExploitChain.complexity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.source_files"><code class="docutils literal notranslate"><span class="pre">ExploitChain.source_files</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.affected_functions"><code class="docutils literal notranslate"><span class="pre">ExploitChain.affected_functions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.to_dict"><code class="docutils literal notranslate"><span class="pre">ExploitChain.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChain.__init__"><code class="docutils literal notranslate"><span class="pre">ExploitChain.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile"><code class="docutils literal notranslate"><span class="pre">ToolProfile</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.name"><code class="docutils literal notranslate"><span class="pre">ToolProfile.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.precision_history"><code class="docutils literal notranslate"><span class="pre">ToolProfile.precision_history</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.recall_history"><code class="docutils literal notranslate"><span class="pre">ToolProfile.recall_history</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.false_positive_rate"><code class="docutils literal notranslate"><span class="pre">ToolProfile.false_positive_rate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.specialty_categories"><code class="docutils literal notranslate"><span class="pre">ToolProfile.specialty_categories</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.weakness_categories"><code class="docutils literal notranslate"><span class="pre">ToolProfile.weakness_categories</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.total_findings"><code class="docutils literal notranslate"><span class="pre">ToolProfile.total_findings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.confirmed_findings"><code class="docutils literal notranslate"><span class="pre">ToolProfile.confirmed_findings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.reliability_score"><code class="docutils literal notranslate"><span class="pre">ToolProfile.reliability_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ToolProfile.__init__"><code class="docutils literal notranslate"><span class="pre">ToolProfile.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.id"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.canonical_type"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.canonical_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.severity"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.severity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.message"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.message</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.location"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.swc_id"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.swc_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.cwe_id"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.cwe_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.source_findings"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.source_findings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.confirming_tools"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.confirming_tools</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.correlation_method"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.correlation_method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.base_confidence"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.base_confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.tool_agreement_score"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.tool_agreement_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.context_score"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.context_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.ml_confidence"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.ml_confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.final_confidence"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.final_confidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.is_cross_validated"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.is_cross_validated</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.false_positive_probability"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.false_positive_probability</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.remediation_priority"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.remediation_priority</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.to_dict"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.CorrelatedFinding.__init__"><code class="docutils literal notranslate"><span class="pre">CorrelatedFinding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.TOOL_WEIGHTS"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.TOOL_WEIGHTS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.DEFAULT_TOOL_PROFILES"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.DEFAULT_TOOL_PROFILES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.TYPE_NORMALIZATION"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.TYPE_NORMALIZATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.SEVERITY_WEIGHTS"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.SEVERITY_WEIGHTS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.CROSS_VALIDATION_REQUIRED"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.CROSS_VALIDATION_REQUIRED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.SINGLE_TOOL_MAX_CONFIDENCE"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.SINGLE_TOOL_MAX_CONFIDENCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.__init__"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.tool_profiles"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.tool_profiles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.add_findings"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.add_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.correlate"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.correlate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.calculate_weighted_confidence"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.calculate_weighted_confidence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_tool_weight"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_tool_weight()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.requires_cross_validation"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.requires_cross_validation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.apply_cross_validation_penalty"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.apply_cross_validation_penalty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_high_confidence_findings"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_high_confidence_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_cross_validated_findings"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_cross_validated_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_likely_true_positives"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_likely_true_positives()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_statistics"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_statistics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.to_report"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.to_report()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.update_tool_profile"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.update_tool_profile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.clear"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.clear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.deduplicate_findings"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.deduplicate_findings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.SmartCorrelationEngine.get_deduplication_stats"><code class="docutils literal notranslate"><span class="pre">SmartCorrelationEngine.get_deduplication_stats()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.KNOWN_CHAINS"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.KNOWN_CHAINS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.__init__"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.analyze"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.analyze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.get_critical_chains"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.get_critical_chains()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.get_high_impact_chains"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.get_high_impact_chains()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.ExploitChainAnalyzer.get_summary"><code class="docutils literal notranslate"><span class="pre">ExploitChainAnalyzer.get_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#src.ml.correlation_engine.correlate_findings"><code class="docutils literal notranslate"><span class="pre">correlate_findings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#ml-pipeline">ML Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ml.html#fine-tuning">Fine-Tuning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#dataset-generator">Dataset Generator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.dataset_generator.VulnerabilityExample"><code class="docutils literal notranslate"><span class="pre">VulnerabilityExample</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.dataset_generator.TrainingExample"><code class="docutils literal notranslate"><span class="pre">TrainingExample</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.dataset_generator.SoliditySecurityDatasetGenerator"><code class="docutils literal notranslate"><span class="pre">SoliditySecurityDatasetGenerator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.dataset_generator.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ml.html#trainer">Trainer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.fine_tuning_trainer.TrainingConfig"><code class="docutils literal notranslate"><span class="pre">TrainingConfig</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.fine_tuning_trainer.SoliditySecurityTrainer"><code class="docutils literal notranslate"><span class="pre">SoliditySecurityTrainer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ml.html#src.ml.fine_tuning.fine_tuning_trainer.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Architecture</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/overview.html">Architecture Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/overview.html#system-architecture">System Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/overview.html#core-components">Core Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../architecture/overview.html#tool-adapters">Tool Adapters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../architecture/overview.html#agents">Agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../architecture/overview.html#orchestrator">Orchestrator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/overview.html#data-flow">Data Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/overview.html#finding-schema">Finding Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/overview.html#configuration">Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/layers.html">Security Layers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-overview">Layer Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-1-2-static-analysis">Layer 1-2: Static Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-3-symbolic-execution">Layer 3: Symbolic Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-4-fuzzing">Layer 4: Fuzzing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-5-formal-verification">Layer 5: Formal Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-6-ml-detection">Layer 6: ML Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-7-llm-analysis">Layer 7: LLM Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-8-defi-security">Layer 8: DeFi Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-9-advanced-detection">Layer 9: Advanced Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../architecture/layers.html#layer-selection">Layer Selection</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#development-workflow">Development Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#commit-convention">Commit Convention</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#code-style">Code Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#adding-a-new-adapter">Adding a New Adapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#testing">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#questions">Questions?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id1">[5.1.0] - 2026-02-10</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#added">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#changed">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id2">[5.1.0] - 2026-02-04</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id3">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#fixed">Fixed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id4">[5.0.0] - 2026-01-26</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id5">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id6">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id7">[4.2.0] - 2025-12-18</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id8">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id9">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id10">[4.0.0] - 2025-11-01</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id11">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id12">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id13">[3.0.0] - 2025-09-01</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id14">Added</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#initial-release">Initial Release</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MIESC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">src.adapters.gptlens_adapter</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for src.adapters.gptlens_adapter</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">GPTLens Adapter - Dual-Role LLM Vulnerability Detection (ICSE 2024)</span>
<span class="sd">====================================================================</span>

<span class="sd">Implements the GPTLens dual-role architecture for smart contract auditing:</span>
<span class="sd">  - Auditor LLM: Generates vulnerability findings from contract source</span>
<span class="sd">  - Critic LLM: Evaluates each finding to filter false positives</span>

<span class="sd">Based on: &quot;GPTLens: Employing LLMs for Smart Contract Vulnerability Detection</span>
<span class="sd">via Dual-Role Interaction&quot; (ICSE 2024)</span>

<span class="sd">The key insight from GPTLens is that using two separate LLM roles -</span>
<span class="sd">one to generate findings and another to critique them - significantly</span>
<span class="sd">reduces false positive rates compared to single-pass LLM analysis.</span>

<span class="sd">Architecture:</span>
<span class="sd">    Contract Source --&gt; [Auditor LLM] --&gt; Raw Findings</span>
<span class="sd">    Raw Findings --&gt; [Critic LLM] --&gt; Filtered Findings (FP removed)</span>

<span class="sd">Uses Ollama HTTP API for local LLM inference (DPGA-compliant, no API keys).</span>
<span class="sd">Auditor role uses deepseek-coder for code-level pattern detection.</span>
<span class="sd">Critic role uses codellama for logical reasoning and verification.</span>

<span class="sd">Author: Fernando Boiero &lt;fboiero@frvm.utn.edu.ar&gt;</span>
<span class="sd">License: AGPL-3.0</span>
<span class="sd">Date: January 2026</span>
<span class="sd">Version: 1.0.0</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">urllib.error</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">urllib.request</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">src.core.llm_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_ollama_host</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.core.tool_protocol</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">ToolAdapter</span><span class="p">,</span>
    <span class="n">ToolCapability</span><span class="p">,</span>
    <span class="n">ToolCategory</span><span class="p">,</span>
    <span class="n">ToolMetadata</span><span class="p">,</span>
    <span class="n">ToolStatus</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># Constants</span>
<span class="c1"># ============================================================================</span>

<span class="c1"># Ollama URL resolved at runtime via get_ollama_host()</span>
<span class="c1"># Supports OLLAMA_HOST env var and config/miesc.yaml</span>

<span class="c1"># Default models for each role</span>
<span class="n">DEFAULT_AUDITOR_MODEL</span> <span class="o">=</span> <span class="s2">&quot;deepseek-coder&quot;</span>
<span class="n">DEFAULT_CRITIC_MODEL</span> <span class="o">=</span> <span class="s2">&quot;codellama&quot;</span>

<span class="c1"># Timeouts (seconds)</span>
<span class="n">OLLAMA_HEALTH_TIMEOUT</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">AUDITOR_TIMEOUT</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">CRITIC_TIMEOUT</span> <span class="o">=</span> <span class="mi">120</span>

<span class="c1"># Maximum contract size before truncation (characters)</span>
<span class="n">MAX_CONTRACT_SIZE</span> <span class="o">=</span> <span class="mi">24000</span>

<span class="c1"># Cache TTL in seconds (24 hours)</span>
<span class="n">CACHE_TTL</span> <span class="o">=</span> <span class="mi">86400</span>

<span class="c1"># SWC mappings for vulnerability types</span>
<span class="n">VULNERABILITY_SWC_MAP</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;reentrancy&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;SWC-107&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-841&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC03&quot;</span><span class="p">},</span>
    <span class="s2">&quot;access_control&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;SWC-105&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-284&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC01&quot;</span><span class="p">},</span>
    <span class="s2">&quot;logic_error&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;SWC-110&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-670&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC04&quot;</span><span class="p">},</span>
    <span class="s2">&quot;oracle_manipulation&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;SWC-120&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-829&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC06&quot;</span><span class="p">},</span>
    <span class="s2">&quot;flash_loan&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-362&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC07&quot;</span><span class="p">},</span>
    <span class="s2">&quot;front_running&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;SWC-114&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-362&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC07&quot;</span><span class="p">},</span>
    <span class="s2">&quot;integer_overflow&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;SWC-101&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-190&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC02&quot;</span><span class="p">},</span>
    <span class="s2">&quot;unchecked_return&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;SWC-104&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-252&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC05&quot;</span><span class="p">},</span>
    <span class="s2">&quot;tx_origin&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;SWC-115&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-477&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC01&quot;</span><span class="p">},</span>
    <span class="s2">&quot;delegatecall&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;SWC-112&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-829&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC08&quot;</span><span class="p">},</span>
    <span class="s2">&quot;timestamp_dependence&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;SWC-116&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-330&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC09&quot;</span><span class="p">},</span>
    <span class="s2">&quot;precision_loss&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-682&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC04&quot;</span><span class="p">},</span>
    <span class="s2">&quot;zero_address&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-20&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC05&quot;</span><span class="p">},</span>
    <span class="s2">&quot;timelock&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-284&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC01&quot;</span><span class="p">},</span>
    <span class="s2">&quot;liquidation&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;swc&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;cwe&quot;</span><span class="p">:</span> <span class="s2">&quot;CWE-829&quot;</span><span class="p">,</span> <span class="s2">&quot;owasp&quot;</span><span class="p">:</span> <span class="s2">&quot;SC06&quot;</span><span class="p">},</span>
<span class="p">}</span>

<span class="c1"># Severity levels ordered by priority</span>
<span class="n">SEVERITY_ORDER</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Critical&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;High&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Low&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Info&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>

<span class="c1"># Pattern-based detection keywords for fallback analysis</span>
<span class="n">PATTERN_KEYWORDS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;reentrancy&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;.call{value:&quot;</span><span class="p">,</span>
        <span class="s2">&quot;.call(&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transfer(&quot;</span><span class="p">,</span>
        <span class="s2">&quot;send(&quot;</span><span class="p">,</span>
        <span class="s2">&quot;external call&quot;</span><span class="p">,</span>
        <span class="s2">&quot;re-entrancy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reentrant&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;access_control&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;onlyOwner&quot;</span><span class="p">,</span>
        <span class="s2">&quot;require(msg.sender&quot;</span><span class="p">,</span>
        <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
        <span class="s2">&quot;auth&quot;</span><span class="p">,</span>
        <span class="s2">&quot;modifier&quot;</span><span class="p">,</span>
        <span class="s2">&quot;role&quot;</span><span class="p">,</span>
        <span class="s2">&quot;permission&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;logic_error&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;logic&quot;</span><span class="p">,</span>
        <span class="s2">&quot;business logic&quot;</span><span class="p">,</span>
        <span class="s2">&quot;incorrect&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wrong calculation&quot;</span><span class="p">,</span>
        <span class="s2">&quot;invariant&quot;</span><span class="p">,</span>
        <span class="s2">&quot;assertion&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;oracle_manipulation&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;oracle&quot;</span><span class="p">,</span>
        <span class="s2">&quot;price feed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;chainlink&quot;</span><span class="p">,</span>
        <span class="s2">&quot;getPrice&quot;</span><span class="p">,</span>
        <span class="s2">&quot;latestRoundData&quot;</span><span class="p">,</span>
        <span class="s2">&quot;twap&quot;</span><span class="p">,</span>
        <span class="s2">&quot;getReserves&quot;</span><span class="p">,</span>
        <span class="s2">&quot;spot price&quot;</span><span class="p">,</span>
        <span class="s2">&quot;amm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;uniswap&quot;</span><span class="p">,</span>
        <span class="s2">&quot;manipulat&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;flash_loan&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;flash loan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;flashloan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;flash-loan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;same block&quot;</span><span class="p">,</span>
        <span class="s2">&quot;same-block&quot;</span><span class="p">,</span>
        <span class="s2">&quot;atomic&quot;</span><span class="p">,</span>
        <span class="s2">&quot;same transaction&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;front_running&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;front-run&quot;</span><span class="p">,</span>
        <span class="s2">&quot;frontrun&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sandwich&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;slippage&quot;</span><span class="p">,</span>
        <span class="s2">&quot;deadline&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;precision_loss&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;precision&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rounding&quot;</span><span class="p">,</span>
        <span class="s2">&quot;division before multiplication&quot;</span><span class="p">,</span>
        <span class="s2">&quot;truncat&quot;</span><span class="p">,</span>
        <span class="s2">&quot;decimal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;loss of precision&quot;</span><span class="p">,</span>
        <span class="s2">&quot;/ 1e18&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;zero_address&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;zero address&quot;</span><span class="p">,</span>
        <span class="s2">&quot;address(0)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;null address&quot;</span><span class="p">,</span>
        <span class="s2">&quot;empty address&quot;</span><span class="p">,</span>
        <span class="s2">&quot;missing validation&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;timelock&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;timelock&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time lock&quot;</span><span class="p">,</span>
        <span class="s2">&quot;delay&quot;</span><span class="p">,</span>
        <span class="s2">&quot;governance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;admin function&quot;</span><span class="p">,</span>
        <span class="s2">&quot;emergency&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;liquidation&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;liquidat&quot;</span><span class="p">,</span>
        <span class="s2">&quot;collateral&quot;</span><span class="p">,</span>
        <span class="s2">&quot;undercollateral&quot;</span><span class="p">,</span>
        <span class="s2">&quot;health factor&quot;</span><span class="p">,</span>
        <span class="s2">&quot;borrow&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;integer_overflow&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;overflow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;underflow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SafeMath&quot;</span><span class="p">,</span>
        <span class="s2">&quot;unchecked {&quot;</span><span class="p">,</span>
        <span class="s2">&quot;uint256&quot;</span><span class="p">,</span>
        <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;unchecked_return&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;unchecked&quot;</span><span class="p">,</span>
        <span class="s2">&quot;return value&quot;</span><span class="p">,</span>
        <span class="s2">&quot;low-level call&quot;</span><span class="p">,</span>
        <span class="s2">&quot;(bool success&quot;</span><span class="p">,</span>
        <span class="s2">&quot;require(success&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;tx_origin&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;tx.origin&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phishing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;origin&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;delegatecall&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;delegatecall&quot;</span><span class="p">,</span>
        <span class="s2">&quot;proxy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;storage collision&quot;</span><span class="p">,</span>
        <span class="s2">&quot;implementation&quot;</span><span class="p">,</span>
        <span class="s2">&quot;upgradeable&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;timestamp_dependence&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;block.timestamp&quot;</span><span class="p">,</span>
        <span class="s2">&quot;block.number&quot;</span><span class="p">,</span>
        <span class="s2">&quot;now&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time-dependent&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">}</span>

<span class="c1"># Default severity for vulnerability types</span>
<span class="n">DEFAULT_SEVERITY_MAP</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;reentrancy&quot;</span><span class="p">:</span> <span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
    <span class="s2">&quot;access_control&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
    <span class="s2">&quot;logic_error&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
    <span class="s2">&quot;oracle_manipulation&quot;</span><span class="p">:</span> <span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
    <span class="s2">&quot;flash_loan&quot;</span><span class="p">:</span> <span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
    <span class="s2">&quot;front_running&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
    <span class="s2">&quot;integer_overflow&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unchecked_return&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tx_origin&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delegatecall&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp_dependence&quot;</span><span class="p">:</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span>
    <span class="s2">&quot;precision_loss&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
    <span class="s2">&quot;zero_address&quot;</span><span class="p">:</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timelock&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
    <span class="s2">&quot;liquidation&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
<span class="p">}</span>


<span class="c1"># ============================================================================</span>
<span class="c1"># Auditor Prompt</span>
<span class="c1"># ============================================================================</span>

<span class="n">AUDITOR_PROMPT_TEMPLATE</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;You are an expert smart contract security auditor </span><span class="se">\</span>
<span class="s2">performing a comprehensive security review.</span>

<span class="s2">Your task is to analyze the following Solidity smart contract for security </span><span class="se">\</span>
<span class="s2">vulnerabilities with the depth and rigor of a professional audit firm.</span>

<span class="s2">VULNERABILITY CATEGORIES TO CHECK:</span>
<span class="s2">1. Reentrancy (SWC-107): External calls before state updates</span>
<span class="s2">2. Access Control (SWC-105): Missing or incorrect access restrictions</span>
<span class="s2">3. Logic Errors (SWC-110): Flawed business logic, incorrect calculations</span>
<span class="s2">4. Oracle Manipulation: Price feed manipulation, spot price vulnerabilities, AMM price dependencies</span>
<span class="s2">5. Flash Loan Attacks: Same-block manipulation, atomic transaction exploits</span>
<span class="s2">6. Front-Running (SWC-114): Transaction ordering dependence, MEV</span>
<span class="s2">7. Integer Overflow/Underflow (SWC-101): Arithmetic issues</span>
<span class="s2">8. Unchecked Return Values (SWC-104): Ignored call results</span>
<span class="s2">9. tx.origin Authentication (SWC-115): Phishing via tx.origin</span>
<span class="s2">10. Delegatecall Injection (SWC-112): Storage collision, proxy issues</span>
<span class="s2">11. Timestamp Dependence (SWC-116): Block timestamp manipulation</span>
<span class="s2">12. Precision Loss: Division before multiplication, rounding errors</span>
<span class="s2">13. Missing Input Validation: Zero address checks, parameter validation</span>
<span class="s2">14. Timelock Issues: Missing timelocks on admin/governance functions</span>
<span class="s2">15. Liquidation Vulnerabilities: Price-dependent liquidation, manipulatable thresholds</span>

<span class="s2">ANALYSIS METHODOLOGY:</span>
<span class="s2">- Trace each function&#39;s control flow carefully</span>
<span class="s2">- Identify all external calls and state modifications</span>
<span class="s2">- Check the ordering of effects (checks-effects-interactions)</span>
<span class="s2">- Verify access control on sensitive functions</span>
<span class="s2">- Analyze arithmetic operations for overflow potential</span>
<span class="s2">- Check for proper input validation</span>
<span class="s2">- Review event emissions and error handling</span>

<span class="s2">CONTRACT SOURCE CODE:</span>
<span class="s2">```solidity</span>
<span class="si">{contract_code}</span>
<span class="s2">```</span>

<span class="s2">OUTPUT FORMAT (strict JSON):</span>
<span class="s2">{{</span>
<span class="s2">    &quot;findings&quot;: [</span>
<span class="s2">        {{</span>
<span class="s2">            &quot;type&quot;: &quot;vulnerability_category&quot;,</span>
<span class="s2">            &quot;severity&quot;: &quot;Critical|High|Medium|Low&quot;,</span>
<span class="s2">            &quot;confidence&quot;: 0.85,</span>
<span class="s2">            &quot;title&quot;: &quot;Short descriptive title&quot;,</span>
<span class="s2">            &quot;description&quot;: &quot;Detailed technical description of the vulnerability&quot;,</span>
<span class="s2">            &quot;function&quot;: &quot;affectedFunction&quot;,</span>
<span class="s2">            &quot;line&quot;: 42,</span>
<span class="s2">            &quot;attack_scenario&quot;: &quot;Step-by-step exploitation scenario&quot;,</span>
<span class="s2">            &quot;impact&quot;: &quot;What an attacker could achieve&quot;,</span>
<span class="s2">            &quot;recommendation&quot;: &quot;Specific remediation guidance&quot;,</span>
<span class="s2">            &quot;swc_id&quot;: &quot;SWC-XXX&quot;</span>
<span class="s2">        }}</span>
<span class="s2">    ]</span>
<span class="s2">}}</span>

<span class="s2">IMPORTANT RULES:</span>
<span class="s2">- Report ONLY vulnerabilities that actually exist in THIS contract</span>
<span class="s2">- Do NOT report generic best practices that are not violated</span>
<span class="s2">- Include specific line numbers and function names when possible</span>
<span class="s2">- Assess confidence honestly (0.0 to 1.0)</span>
<span class="s2">- Respond with ONLY valid JSON, no additional text outside the JSON&quot;&quot;&quot;</span>


<span class="c1"># ============================================================================</span>
<span class="c1"># Critic Prompt</span>
<span class="c1"># ============================================================================</span>

<span class="n">CRITIC_PROMPT_TEMPLATE</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;You are an independent smart contract security </span><span class="se">\</span>
<span class="s2">reviewer acting as a Critic. Your job is to evaluate whether a reported </span><span class="se">\</span>
<span class="s2">vulnerability finding is a TRUE POSITIVE or a FALSE POSITIVE.</span>

<span class="s2">You must be rigorous and objective. Many automated tools produce false </span><span class="se">\</span>
<span class="s2">positives. Your role is to verify each finding against the actual code.</span>

<span class="s2">REPORTED FINDING:</span>
<span class="s2">- Type: </span><span class="si">{finding_type}</span>
<span class="s2">- Severity: </span><span class="si">{finding_severity}</span>
<span class="s2">- Title: </span><span class="si">{finding_title}</span>
<span class="s2">- Description: </span><span class="si">{finding_description}</span>
<span class="s2">- Function: </span><span class="si">{finding_function}</span>
<span class="s2">- Line: </span><span class="si">{finding_line}</span>
<span class="s2">- Attack Scenario: </span><span class="si">{finding_attack}</span>

<span class="s2">RELEVANT CONTRACT CODE:</span>
<span class="s2">```solidity</span>
<span class="si">{contract_code}</span>
<span class="s2">```</span>

<span class="s2">EVALUATION CRITERIA:</span>
<span class="s2">1. CODE EXISTENCE: Does the reported code pattern actually exist?</span>
<span class="s2">2. EXPLOITABILITY: Can the vulnerability actually be exploited?</span>
<span class="s2">3. MITIGATION CHECK: Are there existing guards/mitigations in the code?</span>
<span class="s2">4. CONTEXT ANALYSIS: Does the surrounding code prevent exploitation?</span>
<span class="s2">5. SEVERITY ACCURACY: Is the reported severity appropriate?</span>

<span class="s2">RESPOND WITH ONLY ONE OF:</span>
<span class="s2">- &quot;TRUE_POSITIVE&quot; if the finding is valid and exploitable</span>
<span class="s2">- &quot;FALSE_POSITIVE&quot; if the finding is incorrect or not exploitable</span>

<span class="s2">Then provide a brief explanation (1-2 sentences) of your reasoning.</span>

<span class="s2">Your verdict:&quot;&quot;&quot;</span>


<div class="viewcode-block" id="GPTLensAdapter">
<a class="viewcode-back" href="../../../api/adapters.html#src.adapters.gptlens_adapter.GPTLensAdapter">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">GPTLensAdapter</span><span class="p">(</span><span class="n">ToolAdapter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GPTLens dual-role LLM adapter for smart contract vulnerability detection.</span>

<span class="sd">    Implements the two-phase architecture from the ICSE 2024 paper:</span>
<span class="sd">    Phase 1 (Auditor): deepseek-coder scans contract for vulnerabilities</span>
<span class="sd">    Phase 2 (Critic): codellama reviews each finding to filter false positives</span>

<span class="sd">    This dual-role approach achieves significantly better precision than</span>
<span class="sd">    single-pass LLM analysis by leveraging adversarial verification.</span>

<span class="sd">    All inference runs locally via Ollama HTTP API. No external API keys</span>
<span class="sd">    or cloud services required (DPGA-compliant, sovereign execution).</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="GPTLensAdapter.__init__">
<a class="viewcode-back" href="../../../api/adapters.html#src.adapters.gptlens_adapter.GPTLensAdapter.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">auditor_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_AUDITOR_MODEL</span><span class="p">,</span>
        <span class="n">critic_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_CRITIC_MODEL</span><span class="p">,</span>
        <span class="n">ollama_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize GPTLens adapter.</span>

<span class="sd">        Args:</span>
<span class="sd">            auditor_model: Ollama model name for the Auditor role</span>
<span class="sd">            critic_model: Ollama model name for the Critic role</span>
<span class="sd">            ollama_url: Base URL for Ollama HTTP API</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auditor_model</span> <span class="o">=</span> <span class="n">auditor_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_critic_model</span> <span class="o">=</span> <span class="n">critic_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ollama_url</span> <span class="o">=</span> <span class="n">ollama_url</span> <span class="ow">or</span> <span class="n">get_ollama_host</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ollama_url</span><span class="si">}</span><span class="s2">/api/generate&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;.miesc&quot;</span> <span class="o">/</span> <span class="s2">&quot;gptlens_cache&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_retry_delay</span> <span class="o">=</span> <span class="mi">2</span></div>


    <span class="c1"># ========================================================================</span>
    <span class="c1"># ToolAdapter Interface Implementation</span>
    <span class="c1"># ========================================================================</span>

<div class="viewcode-block" id="GPTLensAdapter.get_metadata">
<a class="viewcode-back" href="../../../api/adapters.html#src.adapters.gptlens_adapter.GPTLensAdapter.get_metadata">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolMetadata</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return GPTLens tool metadata.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ToolMetadata</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;gptlens&quot;</span><span class="p">,</span>
            <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">ToolCategory</span><span class="o">.</span><span class="n">AI_ANALYSIS</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="s2">&quot;Fernando Boiero &lt;fboiero@frvm.utn.edu.ar&gt;&quot;</span><span class="p">,</span>
            <span class="n">license</span><span class="o">=</span><span class="s2">&quot;AGPL-3.0&quot;</span><span class="p">,</span>
            <span class="n">homepage</span><span class="o">=</span><span class="s2">&quot;https://arxiv.org/abs/2310.01152&quot;</span><span class="p">,</span>
            <span class="n">repository</span><span class="o">=</span><span class="s2">&quot;https://github.com/GPTLens/GPTLens&quot;</span><span class="p">,</span>
            <span class="n">documentation</span><span class="o">=</span><span class="s2">&quot;https://arxiv.org/abs/2310.01152&quot;</span><span class="p">,</span>
            <span class="n">installation_cmd</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;curl -fsSL https://ollama.com/install.sh | sh &amp;&amp; &quot;</span>
                <span class="s2">&quot;ollama pull deepseek-coder &amp;&amp; &quot;</span>
                <span class="s2">&quot;ollama pull codellama&quot;</span>
            <span class="p">),</span>
            <span class="n">capabilities</span><span class="o">=</span><span class="p">[</span>
                <span class="n">ToolCapability</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;dual_role_analysis&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                        <span class="s2">&quot;Dual-role LLM vulnerability detection with &quot;</span>
                        <span class="s2">&quot;Auditor-Critic architecture for FP reduction&quot;</span>
                    <span class="p">),</span>
                    <span class="n">supported_languages</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;solidity&quot;</span><span class="p">],</span>
                    <span class="n">detection_types</span><span class="o">=</span><span class="p">[</span>
                        <span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;access_control&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;logic_error&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;oracle_manipulation&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;front_running&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;integer_overflow&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;unchecked_return&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;tx_origin&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;delegatecall&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;timestamp_dependence&quot;</span><span class="p">,</span>
                    <span class="p">],</span>
                <span class="p">),</span>
                <span class="n">ToolCapability</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;false_positive_filtering&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                        <span class="s2">&quot;Critic LLM evaluates each finding to reduce &quot;</span>
                        <span class="s2">&quot;false positive rate via adversarial verification&quot;</span>
                    <span class="p">),</span>
                    <span class="n">supported_languages</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;solidity&quot;</span><span class="p">],</span>
                    <span class="n">detection_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;false_positive_reduction&quot;</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">],</span>
            <span class="n">cost</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">requires_api_key</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">is_optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GPTLensAdapter.is_available">
<a class="viewcode-back" href="../../../api/adapters.html#src.adapters.gptlens_adapter.GPTLensAdapter.is_available">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolStatus</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if Ollama is running and accessible at localhost:11434.</span>

<span class="sd">        Performs an HTTP GET to the Ollama health endpoint to verify</span>
<span class="sd">        the service is up and responsive.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ToolStatus indicating availability</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ollama_url</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">OLLAMA_HEALTH_TIMEOUT</span><span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GPTLens: Ollama is available at </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ollama_url</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">ToolStatus</span><span class="o">.</span><span class="n">AVAILABLE</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;GPTLens: Ollama returned status </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">ToolStatus</span><span class="o">.</span><span class="n">CONFIGURATION_ERROR</span>
        <span class="k">except</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GPTLens: Ollama not reachable at </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ollama_url</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ToolStatus</span><span class="o">.</span><span class="n">NOT_INSTALLED</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GPTLens: Error checking Ollama availability: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ToolStatus</span><span class="o">.</span><span class="n">CONFIGURATION_ERROR</span></div>


<div class="viewcode-block" id="GPTLensAdapter.analyze">
<a class="viewcode-back" href="../../../api/adapters.html#src.adapters.gptlens_adapter.GPTLensAdapter.analyze">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute GPTLens dual-role analysis on a Solidity contract.</span>

<span class="sd">        Phase 1 (Auditor): Sends contract to deepseek-coder with a detailed</span>
<span class="sd">        security audit prompt. Parses structured JSON findings.</span>

<span class="sd">        Phase 2 (Critic): For each finding from the Auditor, sends it to</span>
<span class="sd">        codellama asking for true positive / false positive classification.</span>
<span class="sd">        Findings confirmed as TP get a confidence boost; FPs are filtered out.</span>

<span class="sd">        Falls back to pattern-based analysis if LLM calls fail.</span>

<span class="sd">        Args:</span>
<span class="sd">            contract_path: Path to the Solidity contract file</span>
<span class="sd">            **kwargs: Optional overrides:</span>
<span class="sd">                - auditor_model: Override auditor model name</span>
<span class="sd">                - critic_model: Override critic model name</span>
<span class="sd">                - skip_critic: If True, skip Phase 2 (default: False)</span>
<span class="sd">                - timeout: Override default timeout</span>

<span class="sd">        Returns:</span>
<span class="sd">            Normalized analysis results dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">tool_name</span> <span class="o">=</span> <span class="s2">&quot;gptlens&quot;</span>
        <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;1.0.0&quot;</span>

        <span class="c1"># Check tool availability</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="n">ToolStatus</span><span class="o">.</span><span class="n">AVAILABLE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_result</span><span class="p">(</span>
                <span class="n">tool_name</span><span class="p">,</span>
                <span class="n">version</span><span class="p">,</span>
                <span class="s2">&quot;error&quot;</span><span class="p">,</span>
                <span class="p">[],</span>
                <span class="n">start_time</span><span class="p">,</span>
                <span class="n">error</span><span class="o">=</span><span class="p">(</span>
                    <span class="s2">&quot;Ollama not available. Install from https://ollama.com &quot;</span>
                    <span class="s2">&quot;and ensure it is running. Then pull models: &quot;</span>
                    <span class="s2">&quot;ollama pull deepseek-coder &amp;&amp; ollama pull codellama&quot;</span>
                <span class="p">),</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Read contract source code</span>
            <span class="n">contract_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_contract</span><span class="p">(</span><span class="n">contract_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">contract_code</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_result</span><span class="p">(</span>
                    <span class="n">tool_name</span><span class="p">,</span>
                    <span class="n">version</span><span class="p">,</span>
                    <span class="s2">&quot;error&quot;</span><span class="p">,</span>
                    <span class="p">[],</span>
                    <span class="n">start_time</span><span class="p">,</span>
                    <span class="n">error</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Could not read contract file: </span><span class="si">{</span><span class="n">contract_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="c1"># Check cache</span>
            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">contract_code</span><span class="p">)</span>
            <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_result</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GPTLens: Using cached result for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">)</span>
                <span class="n">cached</span><span class="p">[</span><span class="s2">&quot;from_cache&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">cached</span><span class="p">[</span><span class="s2">&quot;execution_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
                <span class="k">return</span> <span class="n">cached</span>

            <span class="c1"># Truncate long contracts to fit context window</span>
            <span class="n">contract_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_code</span><span class="p">(</span><span class="n">contract_code</span><span class="p">)</span>

            <span class="c1"># Get model overrides from kwargs</span>
            <span class="n">auditor_model</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;auditor_model&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auditor_model</span><span class="p">)</span>
            <span class="n">critic_model</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;critic_model&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_critic_model</span><span class="p">)</span>
            <span class="n">skip_critic</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;skip_critic&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

            <span class="c1"># ==============================================================</span>
            <span class="c1"># PHASE 1: Auditor - Generate vulnerability findings</span>
            <span class="c1"># ==============================================================</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;GPTLens Phase 1/2: Auditor (</span><span class="si">%s</span><span class="s2">) scanning </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">auditor_model</span><span class="p">,</span>
                <span class="n">contract_path</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># Step 1: Run pattern-based analysis first (fast, reliable)</span>
            <span class="n">pattern_findings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pattern_based_analysis</span><span class="p">(</span>
                <span class="n">contract_code</span><span class="p">,</span>
                <span class="n">contract_path</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;GPTLens Auditor: Pattern analysis found </span><span class="si">%d</span><span class="s2"> potential issues&quot;</span><span class="p">,</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">pattern_findings</span><span class="p">),</span>
            <span class="p">)</span>

            <span class="c1"># Step 2: Run LLM analysis</span>
            <span class="n">auditor_prompt</span> <span class="o">=</span> <span class="n">AUDITOR_PROMPT_TEMPLATE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">contract_code</span><span class="o">=</span><span class="n">contract_code</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">auditor_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_ollama</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">auditor_model</span><span class="p">,</span>
                <span class="n">prompt</span><span class="o">=</span><span class="n">auditor_prompt</span><span class="p">,</span>
                <span class="n">timeout</span><span class="o">=</span><span class="n">AUDITOR_TIMEOUT</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Parse auditor findings</span>
            <span class="n">llm_findings</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">auditor_response</span><span class="p">:</span>
                <span class="n">llm_findings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_auditor_response</span><span class="p">(</span>
                    <span class="n">auditor_response</span><span class="p">,</span>
                    <span class="n">contract_path</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;GPTLens Auditor: LLM analysis found </span><span class="si">%d</span><span class="s2"> findings&quot;</span><span class="p">,</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">llm_findings</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;GPTLens: Auditor LLM returned no response&quot;</span><span class="p">)</span>

            <span class="c1"># Step 3: Merge findings (LLM takes priority, add unique pattern findings)</span>
            <span class="n">raw_findings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_merge_findings</span><span class="p">(</span><span class="n">llm_findings</span><span class="p">,</span> <span class="n">pattern_findings</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;GPTLens Phase 1 complete: </span><span class="si">%d</span><span class="s2"> raw findings from Auditor&quot;</span><span class="p">,</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">raw_findings</span><span class="p">),</span>
            <span class="p">)</span>

            <span class="c1"># ==============================================================</span>
            <span class="c1"># PHASE 2: Critic - Filter false positives</span>
            <span class="c1"># ==============================================================</span>
            <span class="k">if</span> <span class="n">skip_critic</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">raw_findings</span><span class="p">:</span>
                <span class="n">final_findings</span> <span class="o">=</span> <span class="n">raw_findings</span>
                <span class="n">critic_stats</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;skipped&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="s2">&quot;skip_critic flag&quot;</span> <span class="k">if</span> <span class="n">skip_critic</span> <span class="k">else</span> <span class="s2">&quot;no findings&quot;</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;GPTLens Phase 2/2: Critic (</span><span class="si">%s</span><span class="s2">) evaluating </span><span class="si">%d</span><span class="s2"> findings&quot;</span><span class="p">,</span>
                    <span class="n">critic_model</span><span class="p">,</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">raw_findings</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="n">final_findings</span><span class="p">,</span> <span class="n">critic_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_critic_evaluate</span><span class="p">(</span>
                    <span class="n">contract_code</span><span class="o">=</span><span class="n">contract_code</span><span class="p">,</span>
                    <span class="n">findings</span><span class="o">=</span><span class="n">raw_findings</span><span class="p">,</span>
                    <span class="n">critic_model</span><span class="o">=</span><span class="n">critic_model</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;GPTLens Phase 2 complete: </span><span class="si">%d</span><span class="s2">/</span><span class="si">%d</span><span class="s2"> findings confirmed as TP&quot;</span><span class="p">,</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">final_findings</span><span class="p">),</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">raw_findings</span><span class="p">),</span>
                <span class="p">)</span>

            <span class="c1"># Sort findings by severity then confidence</span>
            <span class="n">final_findings</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span>
                <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="p">(</span>
                    <span class="n">SEVERITY_ORDER</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">,</span> <span class="s2">&quot;Info&quot;</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span>
                    <span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># Assign sequential IDs</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">finding</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">final_findings</span><span class="p">):</span>
                <span class="n">finding</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;gptlens-</span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="c1"># Build result</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_result</span><span class="p">(</span>
                <span class="n">tool_name</span><span class="p">,</span>
                <span class="n">version</span><span class="p">,</span>
                <span class="s2">&quot;success&quot;</span><span class="p">,</span>
                <span class="n">final_findings</span><span class="p">,</span>
                <span class="n">start_time</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;auditor_model&quot;</span><span class="p">:</span> <span class="n">auditor_model</span><span class="p">,</span>
                    <span class="s2">&quot;critic_model&quot;</span><span class="p">:</span> <span class="n">critic_model</span><span class="p">,</span>
                    <span class="s2">&quot;backend&quot;</span><span class="p">:</span> <span class="s2">&quot;ollama&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ollama_url&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ollama_url</span><span class="p">,</span>
                    <span class="s2">&quot;raw_findings_count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_findings</span><span class="p">),</span>
                    <span class="s2">&quot;confirmed_findings_count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_findings</span><span class="p">),</span>
                    <span class="s2">&quot;false_positives_removed&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_findings</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_findings</span><span class="p">),</span>
                    <span class="s2">&quot;critic_stats&quot;</span><span class="p">:</span> <span class="n">critic_stats</span><span class="p">,</span>
                    <span class="s2">&quot;sovereign&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;dpga_compliant&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">)</span>

            <span class="c1"># Cache result</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache_result</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">result</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GPTLens analysis error: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_result</span><span class="p">(</span>
                <span class="n">tool_name</span><span class="p">,</span>
                <span class="n">version</span><span class="p">,</span>
                <span class="s2">&quot;error&quot;</span><span class="p">,</span>
                <span class="p">[],</span>
                <span class="n">start_time</span><span class="p">,</span>
                <span class="n">error</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="GPTLensAdapter.normalize_findings">
<a class="viewcode-back" href="../../../api/adapters.html#src.adapters.gptlens_adapter.GPTLensAdapter.normalize_findings">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">normalize_findings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_output</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalize findings from raw output to MIESC format.</span>

<span class="sd">        Findings are already normalized during analyze(), so this method</span>
<span class="sd">        extracts the findings list from the result dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            raw_output: Raw output from analyze()</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of normalized finding dictionaries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_output</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">raw_output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;findings&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">return</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="GPTLensAdapter.can_analyze">
<a class="viewcode-back" href="../../../api/adapters.html#src.adapters.gptlens_adapter.GPTLensAdapter.can_analyze">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if adapter can analyze the given contract file.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">contract_path</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.sol&quot;</span></div>


<div class="viewcode-block" id="GPTLensAdapter.get_default_config">
<a class="viewcode-back" href="../../../api/adapters.html#src.adapters.gptlens_adapter.GPTLensAdapter.get_default_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return default configuration for GPTLens adapter.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;auditor_model&quot;</span><span class="p">:</span> <span class="n">DEFAULT_AUDITOR_MODEL</span><span class="p">,</span>
            <span class="s2">&quot;critic_model&quot;</span><span class="p">:</span> <span class="n">DEFAULT_CRITIC_MODEL</span><span class="p">,</span>
            <span class="s2">&quot;ollama_url&quot;</span><span class="p">:</span> <span class="n">get_ollama_host</span><span class="p">(),</span>
            <span class="s2">&quot;auditor_timeout&quot;</span><span class="p">:</span> <span class="n">AUDITOR_TIMEOUT</span><span class="p">,</span>
            <span class="s2">&quot;critic_timeout&quot;</span><span class="p">:</span> <span class="n">CRITIC_TIMEOUT</span><span class="p">,</span>
            <span class="s2">&quot;skip_critic&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;max_retries&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;cache_ttl&quot;</span><span class="p">:</span> <span class="n">CACHE_TTL</span><span class="p">,</span>
        <span class="p">}</span></div>


    <span class="c1"># ========================================================================</span>
    <span class="c1"># Phase 1: Auditor Methods</span>
    <span class="c1"># ========================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_auditor_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse the Auditor LLM response into structured findings.</span>

<span class="sd">        Attempts multiple JSON extraction strategies:</span>
<span class="sd">        1. Direct JSON block extraction (```json ... ```)</span>
<span class="sd">        2. Find JSON starting with {&quot;findings&quot;</span>
<span class="sd">        3. Simple first-{ to last-} extraction</span>
<span class="sd">        4. Regex-based finding extraction</span>
<span class="sd">        5. Fallback to text keyword analysis</span>

<span class="sd">        Args:</span>
<span class="sd">            response: Raw text response from the Auditor LLM</span>
<span class="sd">            contract_path: Path to the analyzed contract</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of normalized finding dictionaries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Strategy 1: Extract JSON from code block</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_json_from_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">parsed</span> <span class="ow">and</span> <span class="s2">&quot;findings&quot;</span> <span class="ow">in</span> <span class="n">parsed</span><span class="p">:</span>
            <span class="n">raw_findings</span> <span class="o">=</span> <span class="n">parsed</span><span class="p">[</span><span class="s2">&quot;findings&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_findings</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raw_findings</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="n">finding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_auditor_finding</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">finding</span><span class="p">:</span>
                        <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>

        <span class="c1"># Strategy 2: If no JSON found, try regex extraction</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">findings</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;GPTLens Auditor: JSON parsing failed, trying regex extraction&quot;</span><span class="p">)</span>
            <span class="n">findings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_findings_from_text</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">)</span>

        <span class="c1"># Strategy 3: If still nothing, use keyword-based text analysis</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">findings</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;GPTLens Auditor: Regex extraction failed, using text analysis&quot;</span><span class="p">)</span>
            <span class="n">findings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_findings_from_keywords</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GPTLens Auditor: Extracted </span><span class="si">%d</span><span class="s2"> findings&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">findings</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">findings</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_normalize_auditor_finding</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">contract_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalize a single finding from the Auditor LLM response.</span>

<span class="sd">        Maps the LLM output fields to the MIESC normalized format,</span>
<span class="sd">        including SWC/CWE/OWASP identifiers where applicable.</span>

<span class="sd">        Args:</span>
<span class="sd">            raw: Raw finding dictionary from the Auditor</span>
<span class="sd">            contract_path: Path to the analyzed contract</span>

<span class="sd">        Returns:</span>
<span class="sd">            Normalized finding dictionary or None if invalid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vuln_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_classify_vulnerability_type</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
        <span class="n">severity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_severity</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">))</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>

        <span class="c1"># Clamp confidence to valid range</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">confidence</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">confidence</span> <span class="o">=</span> <span class="mf">0.75</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">confidence</span><span class="p">)))</span>

        <span class="c1"># Get SWC/CWE/OWASP mappings</span>
        <span class="n">swc_info</span> <span class="o">=</span> <span class="n">VULNERABILITY_SWC_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">swc_id</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;swc_id&quot;</span><span class="p">,</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;swc&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="n">cwe_id</span> <span class="o">=</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cwe&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">owasp_category</span> <span class="o">=</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owasp&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vuln_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> Vulnerability&quot;</span><span class="p">)</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">function_name</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;function&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">line_number</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Validate line number</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line_number</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">line_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line_number</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="n">line_number</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">recommendation</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;recommendation&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Review and address the </span><span class="si">{</span><span class="n">vuln_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> vulnerability.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">finding</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># Assigned later after critic filtering</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">vuln_type</span><span class="p">,</span>
            <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">severity</span><span class="p">,</span>
            <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="n">confidence</span><span class="p">,</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">contract_path</span><span class="p">,</span>
                <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="n">line_number</span><span class="p">,</span>
                <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="n">function_name</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;recommendation&quot;</span><span class="p">:</span> <span class="n">recommendation</span><span class="p">,</span>
            <span class="s2">&quot;swc_id&quot;</span><span class="p">:</span> <span class="n">swc_id</span><span class="p">,</span>
            <span class="s2">&quot;cwe_id&quot;</span><span class="p">:</span> <span class="n">cwe_id</span><span class="p">,</span>
            <span class="s2">&quot;owasp_category&quot;</span><span class="p">:</span> <span class="n">owasp_category</span><span class="p">,</span>
            <span class="s2">&quot;attack_scenario&quot;</span><span class="p">:</span> <span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attack_scenario&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;impact&quot;</span><span class="p">:</span> <span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;impact&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;gptlens_auditor&quot;</span><span class="p">,</span>
            <span class="s2">&quot;critic_verdict&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Filled in Phase 2</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">finding</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_classify_vulnerability_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Classify the vulnerability type from a raw finding.</span>

<span class="sd">        Examines the &#39;type&#39;, &#39;title&#39;, and &#39;description&#39; fields to match</span>
<span class="sd">        against known vulnerability categories.</span>

<span class="sd">        Args:</span>
<span class="sd">            raw: Raw finding dictionary</span>

<span class="sd">        Returns:</span>
<span class="sd">            Normalized vulnerability type string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">combined_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">vuln_type</span><span class="p">,</span> <span class="n">keywords</span> <span class="ow">in</span> <span class="n">PATTERN_KEYWORDS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">combined_text</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">vuln_type</span>

        <span class="k">return</span> <span class="n">raw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;logic_error&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_normalize_severity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalize severity string to MIESC standard format.</span>

<span class="sd">        Args:</span>
<span class="sd">            severity: Raw severity string (case-insensitive)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Normalized severity: &quot;Critical&quot;, &quot;High&quot;, &quot;Medium&quot;, &quot;Low&quot;, or &quot;Info&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">severity_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;critical&quot;</span><span class="p">:</span> <span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
            <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
            <span class="s2">&quot;medium&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
            <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span>
            <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="s2">&quot;Info&quot;</span><span class="p">,</span>
            <span class="s2">&quot;informational&quot;</span><span class="p">:</span> <span class="s2">&quot;Info&quot;</span><span class="p">,</span>
            <span class="s2">&quot;warning&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
            <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">severity_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="s2">&quot;Medium&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_merge_findings</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">llm_findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">pattern_findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merge LLM and pattern-based findings, avoiding duplicates.</span>

<span class="sd">        LLM findings take priority. Pattern findings are added if they</span>
<span class="sd">        detect a vulnerability type not found by the LLM.</span>

<span class="sd">        Args:</span>
<span class="sd">            llm_findings: Findings from LLM analysis</span>
<span class="sd">            pattern_findings: Findings from pattern-based analysis</span>

<span class="sd">        Returns:</span>
<span class="sd">            Merged list of unique findings</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">merged</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">llm_findings</span><span class="p">)</span>  <span class="c1"># Start with LLM findings</span>

        <span class="c1"># Track which vulnerability types are already covered</span>
        <span class="n">covered_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">llm_findings</span><span class="p">:</span>
            <span class="n">vuln_type</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">covered_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">)</span>
            <span class="c1"># Also add normalized version</span>
            <span class="n">covered_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vuln_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="n">covered_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vuln_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">))</span>

        <span class="c1"># Add pattern findings for types not covered by LLM</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">pattern_findings</span><span class="p">:</span>
            <span class="n">pf_type</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">pf_type_normalized</span> <span class="o">=</span> <span class="n">pf_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">pf_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">covered_types</span> <span class="ow">and</span> <span class="n">pf_type_normalized</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">covered_types</span><span class="p">:</span>
                <span class="c1"># Mark as pattern-based for transparency</span>
                <span class="n">pf</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pattern_detection&quot;</span>
                <span class="n">merged</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
                <span class="n">covered_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pf_type</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;Added pattern finding: </span><span class="si">%s</span><span class="s2"> (not covered by LLM)&quot;</span><span class="p">,</span>
                    <span class="n">pf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">pf_type</span><span class="p">),</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">merged</span>

    <span class="c1"># ========================================================================</span>
    <span class="c1"># Phase 2: Critic Methods</span>
    <span class="c1"># ========================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_critic_evaluate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">contract_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="n">critic_model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluate findings using the Critic LLM role.</span>

<span class="sd">        For each finding, sends the finding details and relevant contract</span>
<span class="sd">        code to the Critic LLM, asking it to classify the finding as</span>
<span class="sd">        TRUE_POSITIVE or FALSE_POSITIVE.</span>

<span class="sd">        True positives get a confidence boost (+0.10, capped at 0.95).</span>
<span class="sd">        False positives are removed from the final results.</span>
<span class="sd">        On Critic failure, findings are kept conservatively.</span>

<span class="sd">        Args:</span>
<span class="sd">            contract_code: The full contract source code</span>
<span class="sd">            findings: List of findings from the Auditor phase</span>
<span class="sd">            critic_model: Model name for the Critic role</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of (filtered_findings, critic_statistics)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">confirmed</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rejected_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">error_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">verdicts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
            <span class="n">verdict</span><span class="p">,</span> <span class="n">explanation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_critic_judge_finding</span><span class="p">(</span>
                <span class="n">contract_code</span><span class="o">=</span><span class="n">contract_code</span><span class="p">,</span>
                <span class="n">finding</span><span class="o">=</span><span class="n">finding</span><span class="p">,</span>
                <span class="n">critic_model</span><span class="o">=</span><span class="n">critic_model</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Check if this is a DeFi-related or high-severity finding</span>
            <span class="n">severity</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="n">is_critical</span> <span class="o">=</span> <span class="n">severity</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;CRITICAL&quot;</span><span class="p">,</span> <span class="s2">&quot;HIGH&quot;</span><span class="p">)</span>
            <span class="n">finding_type</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">finding_title</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">finding_desc</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">combined_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">finding_type</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">finding_title</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">finding_desc</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">is_defi_vuln</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">kw</span> <span class="ow">in</span> <span class="n">combined_text</span>
                <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="s2">&quot;oracle&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;price&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;flash loan&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;flashloan&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;manipulation&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;precision&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;liquidat&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;collateral&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;timelock&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;zero address&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;address(0)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;same block&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;same-block&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;getreserves&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;spot&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;amm&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;uniswap&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">verdict</span> <span class="o">==</span> <span class="s2">&quot;TRUE_POSITIVE&quot;</span><span class="p">:</span>
                <span class="c1"># Confirmed: boost confidence</span>
                <span class="n">finding</span><span class="p">[</span><span class="s2">&quot;critic_verdict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true_positive&quot;</span>
                <span class="n">finding</span><span class="p">[</span><span class="s2">&quot;critic_explanation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">explanation</span>
                <span class="n">original_conf</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
                <span class="n">finding</span><span class="p">[</span><span class="s2">&quot;confidence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">original_conf</span> <span class="o">+</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">)</span>
                <span class="n">confirmed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
                <span class="n">verdicts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">),</span> <span class="s2">&quot;verdict&quot;</span><span class="p">:</span> <span class="s2">&quot;TP&quot;</span><span class="p">})</span>

            <span class="k">elif</span> <span class="n">verdict</span> <span class="o">==</span> <span class="s2">&quot;FALSE_POSITIVE&quot;</span><span class="p">:</span>
                <span class="c1"># For DeFi or critical findings, keep with lower confidence</span>
                <span class="k">if</span> <span class="n">is_defi_vuln</span> <span class="ow">or</span> <span class="n">is_critical</span><span class="p">:</span>
                    <span class="n">reason</span> <span class="o">=</span> <span class="s2">&quot;DeFi pattern&quot;</span> <span class="k">if</span> <span class="n">is_defi_vuln</span> <span class="k">else</span> <span class="s2">&quot;severity&quot;</span>
                    <span class="n">finding</span><span class="p">[</span><span class="s2">&quot;critic_verdict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;false_positive_kept&quot;</span>
                    <span class="n">finding</span><span class="p">[</span><span class="s2">&quot;critic_explanation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Kept despite FP due to </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">explanation</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="n">original_conf</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
                    <span class="n">finding</span><span class="p">[</span><span class="s2">&quot;confidence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">original_conf</span> <span class="o">-</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">)</span>
                    <span class="n">confirmed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
                    <span class="n">verdicts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">),</span> <span class="s2">&quot;verdict&quot;</span><span class="p">:</span> <span class="s2">&quot;FP-kept&quot;</span><span class="p">})</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;GPTLens Critic: Keeping FP (</span><span class="si">%s</span><span class="s2">) - </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">reason</span><span class="p">,</span>
                        <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Non-critical, non-DeFi: filter out</span>
                    <span class="n">rejected_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">verdicts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">),</span> <span class="s2">&quot;verdict&quot;</span><span class="p">:</span> <span class="s2">&quot;FP&quot;</span><span class="p">})</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="s2">&quot;GPTLens Critic: Filtered FP - </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                        <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
                        <span class="n">explanation</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span> <span class="k">if</span> <span class="n">explanation</span> <span class="k">else</span> <span class="s2">&quot;no explanation&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Uncertain or error: keep conservatively with slight penalty</span>
                <span class="n">finding</span><span class="p">[</span><span class="s2">&quot;critic_verdict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;uncertain&quot;</span>
                <span class="n">finding</span><span class="p">[</span><span class="s2">&quot;critic_explanation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">explanation</span> <span class="ow">or</span> <span class="s2">&quot;Critic evaluation failed&quot;</span>
                <span class="n">original_conf</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
                <span class="n">finding</span><span class="p">[</span><span class="s2">&quot;confidence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">original_conf</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">)</span>
                <span class="n">confirmed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
                <span class="n">error_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">verdicts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">),</span> <span class="s2">&quot;verdict&quot;</span><span class="p">:</span> <span class="s2">&quot;uncertain&quot;</span><span class="p">})</span>

        <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;total_evaluated&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">findings</span><span class="p">),</span>
            <span class="s2">&quot;true_positives&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">findings</span><span class="p">)</span> <span class="o">-</span> <span class="n">rejected_count</span> <span class="o">-</span> <span class="n">error_count</span><span class="p">,</span>
            <span class="s2">&quot;false_positives&quot;</span><span class="p">:</span> <span class="n">rejected_count</span><span class="p">,</span>
            <span class="s2">&quot;uncertain&quot;</span><span class="p">:</span> <span class="n">error_count</span><span class="p">,</span>
            <span class="s2">&quot;verdicts&quot;</span><span class="p">:</span> <span class="n">verdicts</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">confirmed</span><span class="p">,</span> <span class="n">stats</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_critic_judge_finding</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">contract_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">finding</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">critic_model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ask the Critic LLM to judge a single finding.</span>

<span class="sd">        Sends the finding details and contract code to the Critic with</span>
<span class="sd">        a structured evaluation prompt. Parses the response for</span>
<span class="sd">        TRUE_POSITIVE or FALSE_POSITIVE verdict.</span>

<span class="sd">        Args:</span>
<span class="sd">            contract_code: Contract source code</span>
<span class="sd">            finding: Finding to evaluate</span>
<span class="sd">            critic_model: Ollama model for the Critic role</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of (verdict, explanation) where verdict is one of:</span>
<span class="sd">            &quot;TRUE_POSITIVE&quot;, &quot;FALSE_POSITIVE&quot;, or &quot;UNCERTAIN&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Build the critic prompt</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="n">CRITIC_PROMPT_TEMPLATE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">finding_type</span><span class="o">=</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
            <span class="n">finding_severity</span><span class="o">=</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">),</span>
            <span class="n">finding_title</span><span class="o">=</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown vulnerability&quot;</span><span class="p">),</span>
            <span class="n">finding_description</span><span class="o">=</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;No description&quot;</span><span class="p">),</span>
            <span class="n">finding_function</span><span class="o">=</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;function&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">),</span>
            <span class="n">finding_line</span><span class="o">=</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">),</span>
            <span class="n">finding_attack</span><span class="o">=</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attack_scenario&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">),</span>
            <span class="n">contract_code</span><span class="o">=</span><span class="n">contract_code</span><span class="p">[:</span><span class="mi">6000</span><span class="p">],</span>  <span class="c1"># Limit code for critic context</span>
        <span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_ollama</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">critic_model</span><span class="p">,</span>
            <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="n">CRITIC_TIMEOUT</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;GPTLens Critic: No response for finding &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span>
                <span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;UNCERTAIN&quot;</span><span class="p">,</span> <span class="s2">&quot;Critic LLM did not respond&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_critic_verdict</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_critic_verdict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse the Critic LLM response to extract verdict and explanation.</span>

<span class="sd">        Looks for TRUE_POSITIVE or FALSE_POSITIVE markers in the response.</span>
<span class="sd">        Extracts the reasoning that follows the verdict marker.</span>

<span class="sd">        Args:</span>
<span class="sd">            response: Raw text response from the Critic LLM</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of (verdict, explanation)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response_upper</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">response_clean</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="c1"># Check for explicit markers</span>
        <span class="k">if</span> <span class="s2">&quot;TRUE_POSITIVE&quot;</span> <span class="ow">in</span> <span class="n">response_upper</span> <span class="ow">or</span> <span class="s2">&quot;TRUE POSITIVE&quot;</span> <span class="ow">in</span> <span class="n">response_upper</span><span class="p">:</span>
            <span class="c1"># Extract explanation after the verdict</span>
            <span class="n">explanation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_explanation</span><span class="p">(</span><span class="n">response_clean</span><span class="p">,</span> <span class="s2">&quot;TRUE_POSITIVE&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">explanation</span><span class="p">:</span>
                <span class="n">explanation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_explanation</span><span class="p">(</span><span class="n">response_clean</span><span class="p">,</span> <span class="s2">&quot;TRUE POSITIVE&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;TRUE_POSITIVE&quot;</span><span class="p">,</span> <span class="n">explanation</span> <span class="ow">or</span> <span class="s2">&quot;Confirmed by Critic LLM&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;FALSE_POSITIVE&quot;</span> <span class="ow">in</span> <span class="n">response_upper</span> <span class="ow">or</span> <span class="s2">&quot;FALSE POSITIVE&quot;</span> <span class="ow">in</span> <span class="n">response_upper</span><span class="p">:</span>
            <span class="n">explanation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_explanation</span><span class="p">(</span><span class="n">response_clean</span><span class="p">,</span> <span class="s2">&quot;FALSE_POSITIVE&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">explanation</span><span class="p">:</span>
                <span class="n">explanation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_explanation</span><span class="p">(</span><span class="n">response_clean</span><span class="p">,</span> <span class="s2">&quot;FALSE POSITIVE&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;FALSE_POSITIVE&quot;</span><span class="p">,</span> <span class="n">explanation</span> <span class="ow">or</span> <span class="s2">&quot;Rejected by Critic LLM&quot;</span>

        <span class="c1"># Secondary heuristics</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">word</span> <span class="ow">in</span> <span class="n">response_upper</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;VALID&quot;</span><span class="p">,</span> <span class="s2">&quot;CONFIRMED&quot;</span><span class="p">,</span> <span class="s2">&quot;EXPLOITABLE&quot;</span><span class="p">]):</span>
            <span class="k">return</span> <span class="s2">&quot;TRUE_POSITIVE&quot;</span><span class="p">,</span> <span class="n">response_clean</span><span class="p">[:</span><span class="mi">300</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">word</span> <span class="ow">in</span> <span class="n">response_upper</span>
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;INVALID&quot;</span><span class="p">,</span> <span class="s2">&quot;NOT EXPLOITABLE&quot;</span><span class="p">,</span> <span class="s2">&quot;NOT VULNERABLE&quot;</span><span class="p">,</span> <span class="s2">&quot;NO VULNERABILITY&quot;</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;FALSE_POSITIVE&quot;</span><span class="p">,</span> <span class="n">response_clean</span><span class="p">[:</span><span class="mi">300</span><span class="p">]</span>

        <span class="c1"># Ambiguous response</span>
        <span class="k">return</span> <span class="s2">&quot;UNCERTAIN&quot;</span><span class="p">,</span> <span class="n">response_clean</span><span class="p">[:</span><span class="mi">300</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_explanation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract explanation text following a verdict marker.</span>

<span class="sd">        Args:</span>
<span class="sd">            response: Full critic response text</span>
<span class="sd">            marker: The verdict marker string to search for</span>

<span class="sd">        Returns:</span>
<span class="sd">            Explanation text or empty string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Case-insensitive search</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">marker</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>

        <span class="n">after_marker</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="c1"># Remove common separators</span>
        <span class="k">for</span> <span class="n">sep</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">after_marker</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">sep</span><span class="p">):</span>
                <span class="n">after_marker</span> <span class="o">=</span> <span class="n">after_marker</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="c1"># Take first meaningful chunk (up to 500 chars or first double newline)</span>
        <span class="n">double_newline</span> <span class="o">=</span> <span class="n">after_marker</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">double_newline</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">after_marker</span> <span class="o">=</span> <span class="n">after_marker</span><span class="p">[:</span><span class="n">double_newline</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">after_marker</span><span class="p">[:</span><span class="mi">500</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="c1"># ========================================================================</span>
    <span class="c1"># Ollama HTTP API Methods</span>
    <span class="c1"># ========================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_call_ollama</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call the Ollama HTTP API /api/generate endpoint.</span>

<span class="sd">        Sends a POST request with the model name and prompt, then</span>
<span class="sd">        collects the streamed response tokens. Uses urllib.request</span>
<span class="sd">        to avoid external dependencies.</span>

<span class="sd">        Implements retry logic with configurable attempts and delay.</span>

<span class="sd">        Args:</span>
<span class="sd">            model: Ollama model name (e.g., &quot;deepseek-coder&quot;)</span>
<span class="sd">            prompt: The prompt text to send</span>
<span class="sd">            timeout: Request timeout in seconds</span>

<span class="sd">        Returns:</span>
<span class="sd">            Complete response text or None on failure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
                <span class="s2">&quot;prompt&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">,</span>
                <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                    <span class="s2">&quot;num_ctx&quot;</span><span class="p">:</span> <span class="mi">8192</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">}</span>
        <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;GPTLens: Calling Ollama </span><span class="si">%s</span><span class="s2"> (attempt </span><span class="si">%d</span><span class="s2">/</span><span class="si">%d</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="n">model</span><span class="p">,</span>
                    <span class="n">attempt</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">req</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_generate_url</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
                    <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">},</span>
                    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
                        <span class="n">body</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                        <span class="n">parsed</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
                        <span class="n">response_text</span> <span class="o">=</span> <span class="n">parsed</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;response&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">response_text</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                                <span class="s2">&quot;GPTLens: Got response from </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%d</span><span class="s2"> chars)&quot;</span><span class="p">,</span>
                                <span class="n">model</span><span class="p">,</span>
                                <span class="nb">len</span><span class="p">(</span><span class="n">response_text</span><span class="p">),</span>
                            <span class="p">)</span>
                            <span class="k">return</span> <span class="n">response_text</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;GPTLens: Empty response from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                            <span class="s2">&quot;GPTLens: Ollama returned status </span><span class="si">%d</span><span class="s2"> for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
                            <span class="n">model</span><span class="p">,</span>
                        <span class="p">)</span>

            <span class="k">except</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;GPTLens: HTTP error </span><span class="si">%d</span><span class="s2"> from Ollama for </span><span class="si">%s</span><span class="s2"> (attempt </span><span class="si">%d</span><span class="s2">): </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">e</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                    <span class="n">model</span><span class="p">,</span>
                    <span class="n">attempt</span><span class="p">,</span>
                    <span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;GPTLens: URL error calling Ollama for </span><span class="si">%s</span><span class="s2"> (attempt </span><span class="si">%d</span><span class="s2">): </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">model</span><span class="p">,</span>
                    <span class="n">attempt</span><span class="p">,</span>
                    <span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;GPTLens: Invalid JSON from Ollama for </span><span class="si">%s</span><span class="s2"> (attempt </span><span class="si">%d</span><span class="s2">): </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">model</span><span class="p">,</span>
                    <span class="n">attempt</span><span class="p">,</span>
                    <span class="n">e</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;GPTLens: Unexpected error calling Ollama for </span><span class="si">%s</span><span class="s2"> (attempt </span><span class="si">%d</span><span class="s2">): </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">model</span><span class="p">,</span>
                    <span class="n">attempt</span><span class="p">,</span>
                    <span class="n">e</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="c1"># Wait before retry</span>
            <span class="k">if</span> <span class="n">attempt</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_retry_delay</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="s2">&quot;GPTLens: All </span><span class="si">%d</span><span class="s2"> attempts failed for model </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span><span class="p">,</span>
            <span class="n">model</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># ========================================================================</span>
    <span class="c1"># JSON Parsing Utilities</span>
    <span class="c1"># ========================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_json_from_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract JSON object from an LLM response using multiple strategies.</span>

<span class="sd">        Strategy 1: Look for ```json ... ``` code blocks</span>
<span class="sd">        Strategy 2: Find JSON starting with {&quot;findings&quot;</span>
<span class="sd">        Strategy 3: Find first { to last } and parse</span>
<span class="sd">        Strategy 4: Attempt JSON repair (trailing commas, etc.)</span>

<span class="sd">        Args:</span>
<span class="sd">            response: Raw LLM response text</span>

<span class="sd">        Returns:</span>
<span class="sd">            Parsed JSON dictionary or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Strategy 1: JSON code block</span>
        <span class="n">json_block</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;```(?:json)?\s*(\{.*?\})\s*```&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">json_block</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_block</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># Strategy 2: Find {&quot;findings&quot;</span>
        <span class="n">findings_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\{\s*&quot;findings&quot;\s*:&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">findings_match</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">findings_match</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">depth</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="n">start</span><span class="p">:]):</span>
                <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&quot;{&quot;</span><span class="p">:</span>
                    <span class="n">depth</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&quot;}&quot;</span><span class="p">:</span>
                    <span class="n">depth</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">start</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
                        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
                            <span class="k">break</span>

        <span class="c1"># Strategy 3: First { to last }</span>
        <span class="n">json_start</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span>
        <span class="n">json_end</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">json_start</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">json_end</span> <span class="o">&gt;</span> <span class="n">json_start</span><span class="p">:</span>
            <span class="n">json_str</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="n">json_start</span><span class="p">:</span><span class="n">json_end</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="c1"># Strategy 4: Repair common issues</span>
            <span class="n">repaired</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repair_json</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">repaired</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">repaired</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_repair_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Attempt to repair common JSON issues in LLM output.</span>

<span class="sd">        Fixes:</span>
<span class="sd">        - Trailing commas before ] or }</span>
<span class="sd">        - Unescaped newlines in string values</span>
<span class="sd">        - Single quotes instead of double quotes</span>

<span class="sd">        Args:</span>
<span class="sd">            json_str: Malformed JSON string</span>

<span class="sd">        Returns:</span>
<span class="sd">            Repaired JSON string or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Remove trailing commas</span>
        <span class="n">repaired</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;,\s*([}\]])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\1&quot;</span><span class="p">,</span> <span class="n">json_str</span><span class="p">)</span>

        <span class="c1"># Replace single quotes with double quotes (simple heuristic)</span>
        <span class="c1"># Only if the string doesn&#39;t already use double quotes properly</span>
        <span class="k">if</span> <span class="s1">&#39;&quot;findings&quot;&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">repaired</span> <span class="ow">and</span> <span class="s2">&quot;&#39;findings&#39;&quot;</span> <span class="ow">in</span> <span class="n">repaired</span><span class="p">:</span>
            <span class="n">repaired</span> <span class="o">=</span> <span class="n">repaired</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>

        <span class="c1"># Replace actual newlines inside string values with \n</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">repaired</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">fixed_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">in_string</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">quote_count</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">line</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">in_string</span><span class="p">:</span>
                <span class="n">buffer</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span> <span class="o">+</span> <span class="n">line</span>
                <span class="k">if</span> <span class="n">quote_count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">fixed_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
                    <span class="n">buffer</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">in_string</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">quote_count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">in_string</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">buffer</span> <span class="o">=</span> <span class="n">line</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fixed_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">buffer</span><span class="p">:</span>
            <span class="n">fixed_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fixed_lines</span><span class="p">)</span>

    <span class="c1"># ========================================================================</span>
    <span class="c1"># Fallback Analysis Methods</span>
    <span class="c1"># ========================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_findings_from_text</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract findings from unstructured text response using regex patterns.</span>

<span class="sd">        Looks for patterns like &quot;CRITICAL: Reentrancy vulnerability...&quot; or</span>
<span class="sd">        &quot;SWC-107: ...&quot; in the LLM response text.</span>

<span class="sd">        Args:</span>
<span class="sd">            response: Raw text response from the LLM</span>
<span class="sd">            contract_path: Path to the analyzed contract</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of extracted findings</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">seen_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># Regex patterns for common vulnerability mentions</span>
        <span class="n">regex_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:CRITICAL|HIGH)\s*[:\-]?\s*([Rr]eentrancy[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;Critical&quot;</span><span class="p">,</span> <span class="s2">&quot;reentrancy&quot;</span><span class="p">),</span>
            <span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;(?:CRITICAL|HIGH)\s*[:\-]?\s*([Aa]ccess\s+[Cc]ontrol[^\n]{10,})&quot;</span><span class="p">,</span>
                <span class="s2">&quot;High&quot;</span><span class="p">,</span>
                <span class="s2">&quot;access_control&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:HIGH|MEDIUM)\s*[:\-]?\s*([Ll]ogic\s+[Ee]rror[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span> <span class="s2">&quot;logic_error&quot;</span><span class="p">),</span>
            <span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;(?:CRITICAL|HIGH)\s*[:\-]?\s*([Oo]racle[^\n]{10,})&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
                <span class="s2">&quot;oracle_manipulation&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;(?:CRITICAL|HIGH)\s*[:\-]?\s*([Pp]rice\s+[Mm]anipulat[^\n]{10,})&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
                <span class="s2">&quot;oracle_manipulation&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;(?:CRITICAL|HIGH)\s*[:\-]?\s*([Ff]lash\s*[Ll]oan[^\n]{10,})&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
                <span class="s2">&quot;flash_loan&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;(?:CRITICAL|HIGH)\s*[:\-]?\s*([Ss]ame[\s-]*[Bb]lock[^\n]{10,})&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
                <span class="s2">&quot;flash_loan&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;(?:MEDIUM)\s*[:\-]?\s*([Ff]ront[\s-]*[Rr]unning[^\n]{10,})&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
                <span class="s2">&quot;front_running&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;(?:HIGH|MEDIUM)\s*[:\-]?\s*([Ii]nteger\s+[Oo]verflow[^\n]{10,})&quot;</span><span class="p">,</span>
                <span class="s2">&quot;High&quot;</span><span class="p">,</span>
                <span class="s2">&quot;integer_overflow&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:MEDIUM)\s*[:\-]?\s*([Uu]nchecked[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;unchecked_return&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:MEDIUM)\s*[:\-]?\s*([Tt]x\.origin[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;tx_origin&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:HIGH)\s*[:\-]?\s*([Dd]elegatecall[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span> <span class="s2">&quot;delegatecall&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:LOW|MEDIUM)\s*[:\-]?\s*([Tt]imestamp[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp_dependence&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:MEDIUM|HIGH)\s*[:\-]?\s*([Pp]recision[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;precision_loss&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:MEDIUM)\s*[:\-]?\s*([Dd]ivision\s+before[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;precision_loss&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:LOW|MEDIUM)\s*[:\-]?\s*([Zz]ero\s+[Aa]ddress[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span> <span class="s2">&quot;zero_address&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:LOW|MEDIUM)\s*[:\-]?\s*([Aa]ddress\(0\)[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span> <span class="s2">&quot;zero_address&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:MEDIUM)\s*[:\-]?\s*([Tt]imelock[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;timelock&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:HIGH)\s*[:\-]?\s*([Ll]iquidat[^\n]{10,})&quot;</span><span class="p">,</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span> <span class="s2">&quot;liquidation&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SWC-107[:\s]+([^\n]+)&quot;</span><span class="p">,</span> <span class="s2">&quot;Critical&quot;</span><span class="p">,</span> <span class="s2">&quot;reentrancy&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SWC-105[:\s]+([^\n]+)&quot;</span><span class="p">,</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span> <span class="s2">&quot;access_control&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SWC-101[:\s]+([^\n]+)&quot;</span><span class="p">,</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span> <span class="s2">&quot;integer_overflow&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SWC-104[:\s]+([^\n]+)&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;unchecked_return&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SWC-115[:\s]+([^\n]+)&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;tx_origin&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SWC-112[:\s]+([^\n]+)&quot;</span><span class="p">,</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span> <span class="s2">&quot;delegatecall&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SWC-116[:\s]+([^\n]+)&quot;</span><span class="p">,</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp_dependence&quot;</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">severity</span><span class="p">,</span> <span class="n">vuln_type</span> <span class="ow">in</span> <span class="n">regex_patterns</span><span class="p">:</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">vuln_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen_types</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                    <span class="n">swc_info</span> <span class="o">=</span> <span class="n">VULNERABILITY_SWC_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">vuln_type</span><span class="p">,</span>
                            <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">severity</span><span class="p">,</span>
                            <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="mf">0.60</span><span class="p">,</span>
                            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vuln_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> Vulnerability&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">match</span><span class="o">.</span><span class="n">strip</span><span class="p">()[:</span><span class="mi">500</span><span class="p">],</span>
                            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">contract_path</span><span class="p">,</span>
                                <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">match</span><span class="o">.</span><span class="n">strip</span><span class="p">()[:</span><span class="mi">500</span><span class="p">],</span>
                            <span class="s2">&quot;recommendation&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Review </span><span class="si">{</span><span class="n">vuln_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> issue.&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;swc_id&quot;</span><span class="p">:</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;swc&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;cwe_id&quot;</span><span class="p">:</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cwe&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;owasp_category&quot;</span><span class="p">:</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owasp&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;gptlens_auditor_text&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;critic_verdict&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
                    <span class="n">seen_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">findings</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_findings_from_keywords</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract findings using simple keyword matching as last-resort fallback.</span>

<span class="sd">        Scans the response text for known vulnerability keywords and creates</span>
<span class="sd">        low-confidence findings for each detected category.</span>

<span class="sd">        Args:</span>
<span class="sd">            response: Raw text response from the LLM</span>
<span class="sd">            contract_path: Path to the analyzed contract</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of keyword-matched findings</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">response_lower</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">vuln_type</span><span class="p">,</span> <span class="n">keywords</span> <span class="ow">in</span> <span class="n">PATTERN_KEYWORDS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">response_lower</span><span class="p">:</span>
                    <span class="n">swc_info</span> <span class="o">=</span> <span class="n">VULNERABILITY_SWC_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="n">severity</span> <span class="o">=</span> <span class="n">DEFAULT_SEVERITY_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">)</span>
                    <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">vuln_type</span><span class="p">,</span>
                            <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">severity</span><span class="p">,</span>
                            <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">,</span>
                            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Potential </span><span class="si">{</span><span class="n">vuln_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;LLM analysis mentions &#39;</span><span class="si">{</span><span class="n">keyword</span><span class="si">}</span><span class="s2">&#39; pattern. &quot;</span>
                                <span class="sa">f</span><span class="s2">&quot;Manual review recommended.&quot;</span>
                            <span class="p">),</span>
                            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">contract_path</span><span class="p">,</span>
                                <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Keyword &#39;</span><span class="si">{</span><span class="n">keyword</span><span class="si">}</span><span class="s2">&#39; detected in LLM analysis output.&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;recommendation&quot;</span><span class="p">:</span> <span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;Review contract for </span><span class="si">{</span><span class="n">vuln_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
                                <span class="sa">f</span><span class="s2">&quot;vulnerability patterns.&quot;</span>
                            <span class="p">),</span>
                            <span class="s2">&quot;swc_id&quot;</span><span class="p">:</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;swc&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;cwe_id&quot;</span><span class="p">:</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cwe&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;owasp_category&quot;</span><span class="p">:</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owasp&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;gptlens_keyword_fallback&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;critic_verdict&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
                    <span class="k">break</span>  <span class="c1"># One finding per vulnerability type</span>

        <span class="k">return</span> <span class="n">findings</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_pattern_based_analysis</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">contract_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform pattern-based static analysis as fallback when LLM is unavailable.</span>

<span class="sd">        Scans the contract source code directly for known vulnerability patterns</span>
<span class="sd">        using regex and keyword matching. This provides basic coverage when the</span>
<span class="sd">        Ollama LLM calls fail.</span>

<span class="sd">        Detection covers all 10 vulnerability categories with pattern-specific</span>
<span class="sd">        regex rules.</span>

<span class="sd">        Args:</span>
<span class="sd">            contract_code: Solidity source code</span>
<span class="sd">            contract_path: Path to the contract file</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of pattern-matched findings</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">contract_code</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">contract_code</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Pattern detectors - each returns a finding or None</span>
        <span class="n">pattern_checks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_reentrancy_pattern</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_access_control_pattern</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_integer_overflow_pattern</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_unchecked_return_pattern</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_tx_origin_pattern</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_delegatecall_pattern</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_timestamp_pattern</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_oracle_pattern</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_front_running_pattern</span><span class="p">,</span>
            <span class="c1"># DeFi-specific patterns</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_amm_price_pattern</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_precision_loss_pattern</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_zero_address_pattern</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_detect_timelock_pattern</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">pattern_checks</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">check</span><span class="p">(</span><span class="n">contract_code</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
                <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;GPTLens: Pattern-based fallback found </span><span class="si">%d</span><span class="s2"> potential issues&quot;</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">findings</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">findings</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_reentrancy_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect reentrancy patterns: external calls before state updates.&quot;&quot;&quot;</span>
        <span class="c1"># Look for .call{value: or .call( patterns</span>
        <span class="n">call_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\.call\{?\s*value\s*:&quot;</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">call_match</span><span class="p">:</span>
            <span class="n">call_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\.call\(&quot;</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">call_match</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">call_pos</span> <span class="o">=</span> <span class="n">call_match</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">after_call</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">call_pos</span><span class="p">:]</span>

        <span class="c1"># Check if state update happens after the call</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:balances|_balances)\[.*\]\s*[-+]=&quot;</span><span class="p">,</span> <span class="n">after_call</span><span class="p">):</span>
            <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span><span class="n">call_pos</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_enclosing_function</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">call_pos</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;reentrancy&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Reentrancy: State Update After External Call&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                    <span class="s2">&quot;An external call is made before updating contract state. &quot;</span>
                    <span class="s2">&quot;An attacker could re-enter the function before the state &quot;</span>
                    <span class="s2">&quot;update completes, potentially draining funds.&quot;</span>
                <span class="p">),</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                <span class="n">confidence</span><span class="o">=</span><span class="mf">0.70</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_access_control_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect missing access control on sensitive functions.&quot;&quot;&quot;</span>
        <span class="c1"># Find functions that transfer funds or change ownership without modifiers</span>
        <span class="n">sensitive_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;function\s+(\w*[Ww]ithdraw\w*)\s*\([^)]*\)\s*(?:public|external)(?!\s+only)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Withdrawal function without access control modifier&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;function\s+(\w*[Ss]elfdestruct\w*)\s*\([^)]*\)\s*(?:public|external)(?!\s+only)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Self-destruct function without access control modifier&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;function\s+(\w*[Ss]et[Oo]wner\w*)\s*\([^)]*\)\s*(?:public|external)(?!\s+only)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Owner change function without access control modifier&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">sensitive_patterns</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">func_name</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                    <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;access_control&quot;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Missing Access Control on </span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                    <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                    <span class="n">confidence</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_integer_overflow_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect potential integer overflow in pre-0.8.0 contracts.&quot;&quot;&quot;</span>
        <span class="c1"># Check Solidity version</span>
        <span class="n">version_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;pragma solidity\s*[\^~]?\s*(\d+\.\d+)&quot;</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">version_match</span><span class="p">:</span>
            <span class="n">version</span> <span class="o">=</span> <span class="n">version_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">major</span><span class="p">,</span> <span class="n">minor</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">minor</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Solidity &gt;= 0.8.0 has built-in overflow checks</span>

        <span class="c1"># Look for unchecked arithmetic on uint types</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;uint\d*\s+\w+\s*=\s*\w+\s*[+\-*]\s*\w+&quot;</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;SafeMath&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">code</span> <span class="ow">and</span> <span class="s2">&quot;unchecked&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">code</span><span class="p">:</span>
                <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;uint\d*\s+\w+\s*=\s*\w+\s*[+\-*]&quot;</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                    <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_enclosing_function</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">())</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                        <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;integer_overflow&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Potential Integer Overflow/Underflow&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;Arithmetic operation without SafeMath or Solidity &gt;= 0.8.0 &quot;</span>
                            <span class="s2">&quot;overflow protection. May allow integer overflow/underflow.&quot;</span>
                        <span class="p">),</span>
                        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                        <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                        <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                        <span class="n">confidence</span><span class="o">=</span><span class="mf">0.60</span><span class="p">,</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_unchecked_return_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect unchecked return values from low-level calls.&quot;&quot;&quot;</span>
        <span class="c1"># Look for .call( without checking the return value</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;(?:address\([^)]+\)|[a-zA-Z_]\w*)\.call\{?[^}]*\}?\([^)]*\)\s*;&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="c1"># Verify return value is not captured</span>
            <span class="n">before_call</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="p">:</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span>
            <span class="k">if</span> <span class="s2">&quot;bool&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">before_call</span> <span class="ow">and</span> <span class="s2">&quot;(&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">before_call</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_enclosing_function</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">())</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                    <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;unchecked_return&quot;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Unchecked Return Value from Low-Level Call&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                        <span class="s2">&quot;Return value from a low-level .call() is not checked. &quot;</span>
                        <span class="s2">&quot;The call may silently fail without reverting the transaction.&quot;</span>
                    <span class="p">),</span>
                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                    <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                    <span class="n">confidence</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_tx_origin_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect tx.origin usage for authentication.&quot;&quot;&quot;</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;require\s*\(\s*tx\.origin\s*==&quot;</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;if\s*\(\s*tx\.origin\s*==&quot;</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_enclosing_function</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">())</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;tx_origin&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Authentication via tx.origin&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                    <span class="s2">&quot;tx.origin is used for authentication. This is vulnerable to &quot;</span>
                    <span class="s2">&quot;phishing attacks where a malicious contract tricks a user into &quot;</span>
                    <span class="s2">&quot;calling it, inheriting the user&#39;s tx.origin.&quot;</span>
                <span class="p">),</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                <span class="n">confidence</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_delegatecall_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect potentially unsafe delegatecall usage.&quot;&quot;&quot;</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\.delegatecall\(&quot;</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_enclosing_function</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">())</span>
            <span class="c1"># Check if the target is user-controlled</span>
            <span class="n">before</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="o">-</span> <span class="mi">200</span><span class="p">)</span> <span class="p">:</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span>
            <span class="k">if</span> <span class="s2">&quot;function&quot;</span> <span class="ow">in</span> <span class="n">before</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;address&quot;</span> <span class="ow">in</span> <span class="n">before</span> <span class="ow">or</span> <span class="s2">&quot;bytes&quot;</span> <span class="ow">in</span> <span class="n">before</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                    <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;delegatecall&quot;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Potentially Unsafe Delegatecall&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                        <span class="s2">&quot;delegatecall is used with a potentially user-controlled &quot;</span>
                        <span class="s2">&quot;target address. This could allow an attacker to execute &quot;</span>
                        <span class="s2">&quot;arbitrary code in the context of the calling contract, &quot;</span>
                        <span class="s2">&quot;modifying its storage.&quot;</span>
                    <span class="p">),</span>
                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                    <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                    <span class="n">confidence</span><span class="o">=</span><span class="mf">0.60</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_timestamp_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect timestamp dependence in critical operations.&quot;&quot;&quot;</span>
        <span class="c1"># Look for block.timestamp in conditions or assignments</span>
        <span class="n">timestamp_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">r</span><span class="s2">&quot;require\s*\([^)]*block\.timestamp&quot;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s2">&quot;if\s*\([^)]*block\.timestamp&quot;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s2">&quot;block\.timestamp\s*[&lt;&gt;=!]+&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">pat</span> <span class="ow">in</span> <span class="n">timestamp_patterns</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_enclosing_function</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">())</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                    <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;timestamp_dependence&quot;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Block Timestamp Dependence&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                        <span class="s2">&quot;Contract logic depends on block.timestamp which can be &quot;</span>
                        <span class="s2">&quot;manipulated by miners within a ~15 second window. This &quot;</span>
                        <span class="s2">&quot;should not be used for critical timing or randomness.&quot;</span>
                    <span class="p">),</span>
                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                    <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                    <span class="n">confidence</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_oracle_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect oracle manipulation risks.&quot;&quot;&quot;</span>
        <span class="n">oracle_indicators</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">r</span><span class="s2">&quot;latestRoundData\s*\(&quot;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s2">&quot;getPrice\s*\(&quot;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s2">&quot;IChainlink&quot;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s2">&quot;AggregatorV3Interface&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">pat</span> <span class="ow">in</span> <span class="n">oracle_indicators</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="c1"># Check if staleness check exists</span>
                <span class="n">has_staleness</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span>
                    <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                        <span class="sa">r</span><span class="s2">&quot;updatedAt|answeredInRound|staleness|stale&quot;</span><span class="p">,</span>
                        <span class="n">code</span><span class="p">,</span>
                        <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">has_staleness</span><span class="p">:</span>
                    <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_enclosing_function</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">())</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                        <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;oracle_manipulation&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Oracle Price Feed Without Staleness Check&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;Oracle price feed is consumed without checking data &quot;</span>
                            <span class="s2">&quot;freshness. Stale or manipulated prices could lead to &quot;</span>
                            <span class="s2">&quot;incorrect calculations and potential fund loss.&quot;</span>
                        <span class="p">),</span>
                        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                        <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                        <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                        <span class="n">confidence</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_front_running_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect front-running vulnerabilities.&quot;&quot;&quot;</span>
        <span class="c1"># Look for swap/trade functions without slippage protection</span>
        <span class="n">swap_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;function\s+(\w*[Ss]wap\w*)\s*\(&quot;</span><span class="p">,</span>
            <span class="n">code</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">swap_match</span><span class="p">:</span>
            <span class="n">func_name</span> <span class="o">=</span> <span class="n">swap_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">func_body_start</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="n">swap_match</span><span class="o">.</span><span class="n">end</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">func_body_start</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Find closing brace of function</span>
                <span class="n">depth</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">func_body_start</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">code</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;{&quot;</span><span class="p">:</span>
                        <span class="n">depth</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">code</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;}&quot;</span><span class="p">:</span>
                        <span class="n">depth</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">func_body</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">func_body_start</span><span class="p">:</span><span class="n">pos</span><span class="p">]</span>

                <span class="k">if</span> <span class="s2">&quot;deadline&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">func_body</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">&quot;slippage&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">func_body</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span> <span class="n">swap_match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                        <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;front_running&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Front-Running Risk in </span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;Swap/trade function lacks deadline and slippage &quot;</span>
                            <span class="s2">&quot;protection parameters. Transactions may be vulnerable &quot;</span>
                            <span class="s2">&quot;to sandwich attacks by MEV bots.&quot;</span>
                        <span class="p">),</span>
                        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                        <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                        <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                        <span class="n">confidence</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_amm_price_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect AMM spot price manipulation vulnerabilities.&quot;&quot;&quot;</span>
        <span class="c1"># Look for getReserves() usage (Uniswap V2 style)</span>
        <span class="n">reserves_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;getReserves\s*\(\s*\)&quot;</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reserves_match</span><span class="p">:</span>
            <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span> <span class="n">reserves_match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_enclosing_function</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">reserves_match</span><span class="o">.</span><span class="n">start</span><span class="p">())</span>

            <span class="c1"># Check if there&#39;s TWAP or time-based averaging</span>
            <span class="n">has_twap</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span>
                <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                    <span class="sa">r</span><span class="s2">&quot;twap|timeWeight|cumulative|observe\s*\(|consult\s*\(&quot;</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">has_twap</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                    <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;oracle_manipulation&quot;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;AMM Spot Price Manipulation Risk&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                        <span class="s2">&quot;Uses getReserves() for price calculation without TWAP. &quot;</span>
                        <span class="s2">&quot;Spot prices can be manipulated within a single transaction &quot;</span>
                        <span class="s2">&quot;using flash loans, leading to price oracle attacks.&quot;</span>
                    <span class="p">),</span>
                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                    <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                    <span class="n">confidence</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_precision_loss_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect precision loss from division before multiplication.&quot;&quot;&quot;</span>
        <span class="c1"># Pattern: (a / b) * c  or  variable / 1e18 (then used in multiplication)</span>
        <span class="n">precision_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\(\s*\w+\s*/\s*1e18\s*\)\s*\*&quot;</span><span class="p">,</span> <span class="s2">&quot;Division by 1e18 before multiplication&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\(\s*\w+\s*/\s*10\*\*18\s*\)\s*\*&quot;</span><span class="p">,</span> <span class="s2">&quot;Division by 10**18 before multiplication&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\w+)\s*/\s*1e18\s*\)\s*\*\s*(\w+)&quot;</span><span class="p">,</span> <span class="s2">&quot;Division before multiplication pattern&quot;</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">precision_patterns</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_enclosing_function</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">())</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                    <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;precision_loss&quot;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Precision Loss: Division Before Multiplication&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="s2">. This causes precision loss due to integer division &quot;</span>
                        <span class="s2">&quot;truncation. Multiply first, then divide to preserve precision.&quot;</span>
                    <span class="p">),</span>
                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                    <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                    <span class="n">confidence</span><span class="o">=</span><span class="mf">0.70</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_zero_address_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect missing zero address validation.&quot;&quot;&quot;</span>
        <span class="c1"># Find setOwner/setAdmin type functions</span>
        <span class="n">setter_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;function\s+(set\w*[Oo]wner|set\w*[Aa]dmin|transfer[Oo]wnership)\s*\(\s*address\s+(\w+)&quot;</span><span class="p">,</span>
            <span class="n">code</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">setter_pattern</span><span class="p">:</span>
            <span class="n">func_name</span> <span class="o">=</span> <span class="n">setter_pattern</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">param_name</span> <span class="o">=</span> <span class="n">setter_pattern</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">func_start</span> <span class="o">=</span> <span class="n">setter_pattern</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="c1"># Find the function body</span>
            <span class="n">brace_start</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="n">func_start</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">brace_start</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Check next 200 chars for zero address check</span>
                <span class="n">func_snippet</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">brace_start</span> <span class="p">:</span> <span class="n">brace_start</span> <span class="o">+</span> <span class="mi">300</span><span class="p">]</span>
                <span class="n">has_check</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span>
                    <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                        <span class="sa">rf</span><span class="s2">&quot;require\s*\(\s*</span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s2">\s*!=\s*address\s*\(\s*0\s*\)|&quot;</span>
                        <span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s2">\s*!=\s*address\s*\(\s*0\s*\)|&quot;</span>
                        <span class="sa">r</span><span class="s2">&quot;!= address\(0\)&quot;</span><span class="p">,</span>
                        <span class="n">func_snippet</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">has_check</span><span class="p">:</span>
                    <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span><span class="n">func_start</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                        <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;zero_address&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Missing Zero Address Check in </span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Function </span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2"> accepts an address parameter without &quot;</span>
                            <span class="s2">&quot;validating it is not the zero address. This could lead to &quot;</span>
                            <span class="s2">&quot;loss of admin access or locked funds.&quot;</span>
                        <span class="p">),</span>
                        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                        <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                        <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                        <span class="n">confidence</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_timelock_pattern</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect admin functions without timelock protection.&quot;&quot;&quot;</span>
        <span class="c1"># Find emergency/admin withdrawal functions</span>
        <span class="n">admin_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;function\s+(emergency\w*)\s*\(&quot;</span><span class="p">,</span> <span class="s2">&quot;Emergency function&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;function\s+(\w*[Ww]ithdraw\w*)\s*\([^)]*\)\s*[^{]*only[Oo]wner&quot;</span><span class="p">,</span> <span class="s2">&quot;Owner withdrawal&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;function\s+(pause|unpause)\s*\(&quot;</span><span class="p">,</span> <span class="s2">&quot;Pause function&quot;</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">admin_patterns</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">func_name</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">func_start</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                <span class="c1"># Check if there&#39;s timelock</span>
                <span class="n">has_timelock</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span>
                    <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                        <span class="sa">r</span><span class="s2">&quot;timelock|TimeLock|delay|DELAY|MIN_DELAY|governance&quot;</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">has_timelock</span><span class="p">:</span>
                    <span class="n">line_num</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span><span class="n">func_start</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pattern_finding</span><span class="p">(</span>
                        <span class="n">vuln_type</span><span class="o">=</span><span class="s2">&quot;timelock&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;No Timelock on </span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="s2"> &#39;</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">&#39; lacks timelock protection. &quot;</span>
                            <span class="s2">&quot;Admin actions should have a delay to give users time &quot;</span>
                            <span class="s2">&quot;to react to potentially malicious changes.&quot;</span>
                        <span class="p">),</span>
                        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                        <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                        <span class="n">function</span><span class="o">=</span><span class="n">func_name</span><span class="p">,</span>
                        <span class="n">confidence</span><span class="o">=</span><span class="mf">0.60</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_pattern_finding</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">vuln_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">line</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">function</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a standardized finding from pattern-based detection.</span>

<span class="sd">        Args:</span>
<span class="sd">            vuln_type: Vulnerability type identifier</span>
<span class="sd">            title: Short descriptive title</span>
<span class="sd">            description: Detailed description</span>
<span class="sd">            path: Contract file path</span>
<span class="sd">            line: Line number</span>
<span class="sd">            function: Function name</span>
<span class="sd">            confidence: Confidence score (0.0-1.0)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Normalized finding dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">swc_info</span> <span class="o">=</span> <span class="n">VULNERABILITY_SWC_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">severity</span> <span class="o">=</span> <span class="n">DEFAULT_SEVERITY_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">)</span>

        <span class="n">finding_data</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vuln_type</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">function</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">finding_id</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">finding_data</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()[:</span><span class="mi">12</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;gptlens-pat-</span><span class="si">{</span><span class="n">finding_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">vuln_type</span><span class="p">,</span>
            <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">severity</span><span class="p">,</span>
            <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="n">confidence</span><span class="p">,</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
                <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">,</span>
                <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="n">function</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;recommendation&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Review and address the </span><span class="si">{</span><span class="n">vuln_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;vulnerability. Refer to </span><span class="si">{</span><span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;swc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SWC Registry&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;for mitigation guidance.&quot;</span>
            <span class="p">),</span>
            <span class="s2">&quot;swc_id&quot;</span><span class="p">:</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;swc&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;cwe_id&quot;</span><span class="p">:</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cwe&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;owasp_category&quot;</span><span class="p">:</span> <span class="n">swc_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owasp&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;gptlens_pattern_fallback&quot;</span><span class="p">,</span>
            <span class="s2">&quot;critic_verdict&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="c1"># ========================================================================</span>
    <span class="c1"># Utility Methods</span>
    <span class="c1"># ========================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_enclosing_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the name of the function enclosing a given position in code.</span>

<span class="sd">        Searches backward from the position to find the nearest</span>
<span class="sd">        &#39;function &lt;name&gt;&#39; declaration.</span>

<span class="sd">        Args:</span>
<span class="sd">            code: Full source code</span>
<span class="sd">            position: Character position to search from</span>

<span class="sd">        Returns:</span>
<span class="sd">            Function name or empty string if not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">before</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span><span class="n">position</span><span class="p">]</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;function\s+(\w+)&quot;</span><span class="p">,</span> <span class="n">before</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">match</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_read_contract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read contract file content with UTF-8 encoding.</span>

<span class="sd">        Args:</span>
<span class="sd">            contract_path: Path to the Solidity contract file</span>

<span class="sd">        Returns:</span>
<span class="sd">            File content as string or None on error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">contract_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GPTLens: Contract file not found: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GPTLens: Permission denied reading: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GPTLens: Error reading contract </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">contract_path</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_truncate_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Truncate contract code to fit within LLM context window.</span>

<span class="sd">        Args:</span>
<span class="sd">            code: Original contract source code</span>

<span class="sd">        Returns:</span>
<span class="sd">            Truncated code (with marker) or original if within limits</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">MAX_CONTRACT_SIZE</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">code</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;GPTLens: Contract truncated from </span><span class="si">%d</span><span class="s2"> to </span><span class="si">%d</span><span class="s2"> chars&quot;</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">code</span><span class="p">),</span>
            <span class="n">MAX_CONTRACT_SIZE</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">code</span><span class="p">[:</span><span class="n">MAX_CONTRACT_SIZE</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">// ... (truncated for analysis)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_result</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">status</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">error</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build a standardized result dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool: Tool name</span>
<span class="sd">            version: Tool version</span>
<span class="sd">            status: &quot;success&quot;, &quot;error&quot;, or &quot;timeout&quot;</span>
<span class="sd">            findings: List of findings</span>
<span class="sd">            start_time: Analysis start timestamp</span>
<span class="sd">            error: Error message if applicable</span>
<span class="sd">            metadata: Additional metadata</span>

<span class="sd">        Returns:</span>
<span class="sd">            Standardized result dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;tool&quot;</span><span class="p">:</span> <span class="n">tool</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">status</span><span class="p">,</span>
            <span class="s2">&quot;findings&quot;</span><span class="p">:</span> <span class="n">findings</span><span class="p">,</span>
            <span class="s2">&quot;execution_time&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span>
            <span class="s2">&quot;from_cache&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">error</span>

        <span class="k">if</span> <span class="n">metadata</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="c1"># ========================================================================</span>
    <span class="c1"># Cache Methods</span>
    <span class="c1"># ========================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a deterministic cache key from contract code and model config.</span>

<span class="sd">        Includes model names in the key so cache is invalidated when</span>
<span class="sd">        models change.</span>

<span class="sd">        Args:</span>
<span class="sd">            contract_code: Contract source code</span>

<span class="sd">        Returns:</span>
<span class="sd">            SHA-256 hex digest as cache key</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key_data</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">contract_code</span><span class="si">}</span><span class="s2">:&quot;</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_auditor_model</span><span class="si">}</span><span class="s2">:&quot;</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_critic_model</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">key_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_cached_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve a cached analysis result if available and fresh.</span>

<span class="sd">        Cache entries older than CACHE_TTL (24 hours) are considered stale</span>
<span class="sd">        and automatically deleted.</span>

<span class="sd">        Args:</span>
<span class="sd">            cache_key: SHA-256 cache key</span>

<span class="sd">        Returns:</span>
<span class="sd">            Cached result dictionary or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cache_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cache_key</span><span class="si">}</span><span class="s2">.json&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">cache_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">age_seconds</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">cache_file</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span>
            <span class="k">if</span> <span class="n">age_seconds</span> <span class="o">&gt;</span> <span class="n">CACHE_TTL</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GPTLens: Cache expired for key </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cache_key</span><span class="p">[:</span><span class="mi">16</span><span class="p">])</span>
                <span class="n">cache_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">cache_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;GPTLens: Corrupted cache file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cache_file</span><span class="p">)</span>
            <span class="n">cache_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">missing_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GPTLens: Error reading cache: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_cache_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cache an analysis result for future use.</span>

<span class="sd">        Args:</span>
<span class="sd">            cache_key: SHA-256 cache key</span>
<span class="sd">            result: Analysis result dictionary to cache</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cache_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cache_key</span><span class="si">}</span><span class="s2">.json&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">cache_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GPTLens: Cached result for key </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cache_key</span><span class="p">[:</span><span class="mi">16</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GPTLens: Error writing cache: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>



<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;GPTLensAdapter&quot;</span><span class="p">]</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Fernando Boiero.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>