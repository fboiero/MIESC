# Technical Security Analysis Report

**Contract:** {{ contract_name }}
**Commit:** {{ commit_hash }}
**Analyzed:** {{ audit_date }}

---

## Analysis Configuration

```yaml
profile: {{ profile }}
layers: {{ layers }}
timeout: {{ timeout }}s
parallel_workers: {{ parallel }}
```

## Tool Execution Summary

| Tool | Layer | Status | Duration | Findings |
|------|-------|--------|----------|----------|
{% for tool in tools %}
| {{ tool.name }} | {{ tool.layer }} | {{ tool.status }} | {{ tool.duration }} | {{ tool.findings }} |
{% endfor %}

**Total Execution Time:** {{ total_duration }}

---

## Findings by Category

### Reentrancy (SWC-107)

{% if reentrancy_findings %}
{% for finding in reentrancy_findings %}
#### {{ finding.id }}. {{ finding.title }}

**Location:** `{{ finding.location }}`
**Severity:** {{ finding.severity }}
**Detected by:** {{ finding.tools | join(", ") }}

```solidity
{{ finding.code_snippet }}
```

**Analysis:**
{{ finding.analysis }}

**Fix:**
```solidity
{{ finding.fix }}
```

---
{% endfor %}
{% else %}
No reentrancy vulnerabilities detected.
{% endif %}

### Access Control (SWC-105, SWC-106)

{% if access_control_findings %}
{% for finding in access_control_findings %}
#### {{ finding.id }}. {{ finding.title }}

**Location:** `{{ finding.location }}`
**Severity:** {{ finding.severity }}

{{ finding.description }}

---
{% endfor %}
{% else %}
No access control issues detected.
{% endif %}

### Integer Overflow/Underflow (SWC-101)

{% if integer_findings %}
{% for finding in integer_findings %}
#### {{ finding.id }}. {{ finding.title }}

**Location:** `{{ finding.location }}`
**Severity:** {{ finding.severity }}

{{ finding.description }}

---
{% endfor %}
{% else %}
No integer overflow/underflow issues detected.
{% endif %}

### Unchecked External Calls (SWC-104)

{% if unchecked_call_findings %}
{% for finding in unchecked_call_findings %}
#### {{ finding.id }}. {{ finding.title }}

**Location:** `{{ finding.location }}`
**Severity:** {{ finding.severity }}

{{ finding.description }}

---
{% endfor %}
{% else %}
No unchecked external call issues detected.
{% endif %}

### Other Findings

{% for finding in other_findings %}
#### {{ finding.id }}. {{ finding.title }}

| Property | Value |
|----------|-------|
| Category | {{ finding.category }} |
| Severity | {{ finding.severity }} |
| Location | {{ finding.location }} |
| SWC | {{ finding.swc }} |
| Tool | {{ finding.tool }} |

{{ finding.description }}

{% if finding.recommendation %}
**Recommendation:** {{ finding.recommendation }}
{% endif %}

---
{% endfor %}

## Code Metrics

| Metric | Value |
|--------|-------|
| Total Lines | {{ total_lines }} |
| Solidity Lines | {{ solidity_lines }} |
| Comment Lines | {{ comment_lines }} |
| Blank Lines | {{ blank_lines }} |
| Functions | {{ function_count }} |
| Contracts | {{ contract_count }} |
| External Calls | {{ external_calls }} |
| State Variables | {{ state_variables }} |

## Dependency Analysis

| Dependency | Version | Known Vulnerabilities |
|------------|---------|----------------------|
{% for dep in dependencies %}
| {{ dep.name }} | {{ dep.version }} | {{ dep.vulnerabilities }} |
{% endfor %}

## Gas Analysis

| Function | Gas Cost | Optimization Potential |
|----------|----------|------------------------|
{% for func in gas_analysis %}
| {{ func.name }} | {{ func.gas }} | {{ func.optimization }} |
{% endfor %}

---

## Raw Tool Outputs

<details>
<summary>Slither Output</summary>

```
{{ slither_output }}
```

</details>

<details>
<summary>Mythril Output</summary>

```
{{ mythril_output }}
```

</details>

<details>
<summary>Aderyn Output</summary>

```
{{ aderyn_output }}
```

</details>

---

**Generated by [MIESC](https://github.com/fboiero/MIESC) v{{ miesc_version }}**
