<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 450" font-family="Arial, Helvetica, sans-serif">
  <!-- Background -->
  <rect width="850" height="450" fill="#ffffff"/>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#333"/>
    </marker>
  </defs>
  
  <!-- Level 1: Root - Dark box -->
  <rect x="325" y="20" width="200" height="55" fill="#3d4f5f" rx="6"/>
  <text x="425" y="45" text-anchor="middle" font-size="14" font-weight="bold" fill="white">Amenazas a</text>
  <text x="425" y="63" text-anchor="middle" font-size="14" font-weight="bold" fill="white">Smart Contracts</text>
  
  <!-- Lines from root to category boxes -->
  <line x1="375" y1="75" x2="210" y2="115" stroke="#333" stroke-width="1.5"/>
  <line x1="475" y1="75" x2="640" y2="115" stroke="#333" stroke-width="1.5"/>
  
  <!-- Group: Amenazas Externas (red border) -->
  <rect x="40" y="105" width="340" height="175" fill="#fff9f9" stroke="#c0392b" stroke-width="2.5" rx="12"/>
  <text x="210" y="130" text-anchor="middle" font-size="15" font-weight="bold" fill="#c0392b">Amenazas Externas</text>
  
  <!-- Group: Amenazas Internas (orange border) -->
  <rect x="470" y="105" width="340" height="175" fill="#fffbf5" stroke="#e67e22" stroke-width="2.5" rx="12"/>
  <text x="640" y="130" text-anchor="middle" font-size="15" font-weight="bold" fill="#e67e22">Amenazas Internas</text>
  
  <!-- External threats boxes (pink) - evenly spaced -->
  <rect x="60" y="150" width="95" height="55" fill="#f5b7b1" rx="5" stroke="#d98880" stroke-width="1"/>
  <text x="107" y="173" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">Actores</text>
  <text x="107" y="188" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">Estatales (APT)</text>
  
  <rect x="165" y="150" width="95" height="55" fill="#f5b7b1" rx="5" stroke="#d98880" stroke-width="1"/>
  <text x="212" y="173" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">Crimen</text>
  <text x="212" y="188" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">Organizado</text>
  
  <rect x="270" y="150" width="95" height="55" fill="#f5b7b1" rx="5" stroke="#d98880" stroke-width="1"/>
  <text x="317" y="178" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">Hacktivistas</text>
  
  <!-- Internal threats boxes (orange/peach) - evenly spaced -->
  <rect x="490" y="150" width="95" height="55" fill="#fad7a0" rx="5" stroke="#f0c987" stroke-width="1"/>
  <text x="537" y="173" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">Desarrollador</text>
  <text x="537" y="188" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">Malicioso</text>
  
  <rect x="595" y="150" width="95" height="55" fill="#fad7a0" rx="5" stroke="#f0c987" stroke-width="1"/>
  <text x="642" y="173" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">Errores de</text>
  <text x="642" y="188" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">Desarrollo</text>
  
  <rect x="700" y="150" width="95" height="55" fill="#fad7a0" rx="5" stroke="#f0c987" stroke-width="1"/>
  <text x="747" y="173" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">Configuración</text>
  <text x="747" y="188" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">Errónea</text>
  
  <!-- Lines from boxes to examples -->
  <line x1="107" y1="205" x2="107" y2="235" stroke="#333" stroke-width="1.5" stroke-dasharray="4,3"/>
  <line x1="107" y1="245" x2="107" y2="295" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <line x1="212" y1="205" x2="212" y2="295" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <line x1="317" y1="205" x2="317" y2="295" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <line x1="537" y1="205" x2="537" y2="295" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <line x1="642" y1="205" x2="642" y2="295" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <line x1="747" y1="205" x2="747" y2="295" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <!-- Examples row (ellipses) - aligned with boxes above -->
  <ellipse cx="107" cy="335" rx="70" ry="28" fill="#ffffff" stroke="#333" stroke-width="1.5"/>
  <text x="107" y="332" text-anchor="middle" font-size="10" fill="#333">Espionaje</text>
  <text x="107" y="346" text-anchor="middle" font-size="10" fill="#333">económico</text>
  
  <ellipse cx="212" cy="335" rx="55" ry="28" fill="#ffffff" stroke="#333" stroke-width="1.5"/>
  <text x="212" y="340" text-anchor="middle" font-size="10" fill="#333">Sabotaje</text>
  
  <ellipse cx="317" cy="335" rx="65" ry="28" fill="#ffffff" stroke="#333" stroke-width="1.5"/>
  <text x="317" y="340" text-anchor="middle" font-size="10" fill="#333">Robo de fondos</text>
  
  <ellipse cx="537" cy="335" rx="55" ry="28" fill="#ffffff" stroke="#333" stroke-width="1.5"/>
  <text x="537" y="340" text-anchor="middle" font-size="10" fill="#333">Rug pulls</text>
  
  <ellipse cx="642" cy="335" rx="70" ry="28" fill="#ffffff" stroke="#333" stroke-width="1.5"/>
  <text x="642" y="340" text-anchor="middle" font-size="10" fill="#333">Vulnerabilidades</text>
  
  <ellipse cx="747" cy="335" rx="70" ry="28" fill="#ffffff" stroke="#333" stroke-width="1.5"/>
  <text x="747" y="332" text-anchor="middle" font-size="10" fill="#333">Permisos</text>
  <text x="747" y="346" text-anchor="middle" font-size="10" fill="#333">excesivos</text>
  
  <!-- Caption -->
  <text x="425" y="420" text-anchor="middle" font-size="14" font-weight="bold" fill="#2c3e50">
    Figura 2: Taxonomía de Amenazas a Smart Contracts
  </text>
</svg>
