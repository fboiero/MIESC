# MIESC Security Audit Report
## DeFi Vulnerable Contracts Analysis

**Date**: $(date +%Y-%m-%d)
**Tool**: MIESC v4.3.5
**Docker Image**: ghcr.io/fboiero/miesc:4.3.5

---

## Executive Summary

This report contains the security analysis of 4 smart contracts with intentional vulnerabilities,
demonstrating MIESC's detection capabilities.

| Contract | Slither | Aderyn | Mythril | Total Findings |
|----------|---------|--------|---------|----------------|
| VulnerableBank.sol | 3 | 5 | 0 | 8 |
| UnsafeToken.sol | 5 | 5 | 0 | 10 |
| FlashLoanVault.sol | 5 | 5 | 0 | 10 |
| AccessControl.sol | - | - | 0 | 0* |

*AccessControl.sol uses Solidity 0.8.18+ features (block.prevrandao) not fully supported by all tools.

---


## Detailed Findings

### AccessControl

# MIESC Security Audit Report

**Contract**: `/contracts/AccessControl.sol`
**Date**: 2026-01-19 18:54:57
**MIESC Version**: 4.3.4

## Executive Summary

| Severity | Count |
|----------|-------|
| Critical | 0 |
| High | 0 |
| Medium | 0 |
| Low | 0 |
| Info | 0 |
| **Total** | **0** |

### Tools Executed

- **Successful**: mythril
- **Failed/Unavailable**: slither, aderyn, solhint

## Detailed Findings


## Appendix

### Tool Execution Details

| Tool | Status | Time (s) | Findings |
|------|--------|----------|----------|
| slither | error | 2.9 | 0 |
| aderyn | error | 0.1 | 0 |
| solhint | not_available | 0.0 | 0 |
| mythril | success | 8.3 | 0 |

---

*Generated by MIESC v4.3.4*

---

### FlashLoanVault

# MIESC Security Audit Report

**Contract**: `/contracts/FlashLoanVault.sol`
**Date**: 2026-01-19 18:55:10
**MIESC Version**: 4.3.4

## Executive Summary

| Severity | Count |
|----------|-------|
| Critical | 0 |
| High | 6 |
| Medium | 0 |
| Low | 4 |
| Info | 0 |
| **Total** | **10** |

### Tools Executed

- **Successful**: slither, aderyn, mythril
- **Failed/Unavailable**: solhint

## Detailed Findings

### SLITHER

**[High]** reentrancy-balance

Reentrancy in [FlashLoanVault.flashLoan(uint256)](../contracts/FlashLoanVault.sol#L32-L44):
	External call allowing reentrancy:
	- [token.transfer(msg.sender,amount)](../contracts/FlashLoanVault.sol#L36)
	Balance read before the call:
	- [balanceBefore = token.balanceOf(address(this))](../contracts/FlashLoanVault.sol#L33)
	Possible stale balance used after the call in a condition:
	- [require(bool,string)(balanceAfter >= balanceBefore + fee,Flash loan not repaid)](../contracts/FlashLoanVault.sol#L43)
		- stale variable `balanceBefore`


- **Location**: `FlashLoanVault.sol:32`
- **Recommendation**: Review and fix the vulnerability
- **SWC**: SWC-107

---

**[High]** reentrancy-balance

Reentrancy in [FlashLoanVault.flashLoan(uint256)](../contracts/FlashLoanVault.sol#L32-L44):
	External call allowing reentrancy:
	- [IFlashLoanReceiver(msg.sender).executeOperation(amount,fee)](../contracts/FlashLoanVault.sol#L39)
	Balance read before the call:
	- [balanceBefore = token.balanceOf(address(this))](../contracts/FlashLoanVault.sol#L33)
	Possible stale balance used after the call in a condition:
	- [require(bool,string)(balanceAfter >= balanceBefore + fee,Flash loan not repaid)](../contracts/FlashLoanVault.sol#L43)
		- stale variable `balanceBefore`


- **Location**: `FlashLoanVault.sol:32`
- **Recommendation**: Review and fix the vulnerability
- **SWC**: SWC-107

---

**[High]** unchecked-transfer

[FlashLoanVault.flashLoan(uint256)](../contracts/FlashLoanVault.sol#L32-L44) ignores return value by [token.transfer(msg.sender,amount)](../contracts/FlashLoanVault.sol#L36)


- **Location**: `FlashLoanVault.sol:32`
- **Recommendation**: Review and fix the vulnerability

---

**[High]** unchecked-transfer

[FlashLoanVault.deposit(uint256)](../contracts/FlashLoanVault.sol#L25-L29) ignores return value by [token.transferFrom(msg.sender,address(this),amount)](../contracts/FlashLoanVault.sol#L26)


- **Location**: `FlashLoanVault.sol:25`
- **Recommendation**: Review and fix the vulnerability

---

**[Low]** reentrancy-benign

Reentrancy in [FlashLoanVault.deposit(uint256)](../contracts/FlashLoanVault.sol#L25-L29):
	External calls:
	- [token.transferFrom(msg.sender,address(this),amount)](../contracts/FlashLoanVault.sol#L26)
	State variables written after the call(s):
	- [deposits[msg.sender] += amount](../contracts/FlashLoanVault.sol#L27)
	- [poolBalance += amount](../contracts/FlashLoanVault.sol#L28)


- **Location**: `FlashLoanVault.sol:25`
- **Recommendation**: Review and fix the vulnerability
- **SWC**: SWC-107

---

### ADERYN

**[High]** unchecked-return

Function returns a value but it is ignored.

- **Location**: `FlashLoanVault.sol:26`
- **Recommendation**: Review and fix the issue

---

**[High]** unchecked-return

Function returns a value but it is ignored.

- **Location**: `FlashLoanVault.sol:36`
- **Recommendation**: Review and fix the issue

---

**[Low]** unsafe-erc20-functions

ERC20 functions may not behave as expected. For example: return values are not always meaningful. It is recommended to use OpenZeppelin's SafeERC20 library.

- **Location**: `FlashLoanVault.sol:26`
- **Recommendation**: Review and fix the issue

---

**[Low]** unsafe-erc20-functions

ERC20 functions may not behave as expected. For example: return values are not always meaningful. It is recommended to use OpenZeppelin's SafeERC20 library.

- **Location**: `FlashLoanVault.sol:36`
- **Recommendation**: Review and fix the issue

---

**[Low]** unspecific-solidity-pragma

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

- **Location**: `FlashLoanVault.sol:2`
- **Recommendation**: Review and fix the issue

---


## Appendix

### Tool Execution Details

| Tool | Status | Time (s) | Findings |
|------|--------|----------|----------|
| slither | success | 2.3 | 5 |
| aderyn | success | 0.6 | 5 |
| solhint | not_available | 0.0 | 0 |
| mythril | success | 5.3 | 0 |

---

*Generated by MIESC v4.3.4*

---

### UnsafeToken

# MIESC Security Audit Report

**Contract**: `/contracts/UnsafeToken.sol`
**Date**: 2026-01-19 18:55:21
**MIESC Version**: 4.3.4

## Executive Summary

| Severity | Count |
|----------|-------|
| Critical | 0 |
| High | 1 |
| Medium | 1 |
| Low | 5 |
| Info | 3 |
| **Total** | **10** |

### Tools Executed

- **Successful**: slither, aderyn, mythril
- **Failed/Unavailable**: solhint

## Detailed Findings

### SLITHER

**[Medium]** tx-origin

[UnsafeToken.transferOwnership(address)](../contracts/UnsafeToken.sol#L22-L25) uses tx.origin for authorization: [require(bool,string)(tx.origin == owner,Not owner)](../contracts/UnsafeToken.sol#L23)


- **Location**: `UnsafeToken.sol:22`
- **Recommendation**: Use msg.sender instead of tx.origin for authentication
- **SWC**: SWC-115

---

**[Low]** missing-zero-check

[UnsafeToken.transferOwnership(address).newOwner](../contracts/UnsafeToken.sol#L22) lacks a zero-check on :
		- [owner = newOwner](../contracts/UnsafeToken.sol#L24)


- **Location**: `UnsafeToken.sol:22`
- **Recommendation**: Review and fix the vulnerability

---

**[Info]** solc-version

Version constraint ^0.8.0 contains known severe issues (https://solidity.readthedocs.io/en/latest/bugs.html)
	- FullInlinerNonExpressionSplitArgumentEvaluationOrder
	- MissingSideEffectsOnSelectorAccess
	- AbiReencodingHeadOverflowWithStaticArrayCleanup
	- DirtyBytesArrayToStorage
	- DataLocationChangeInInternalOverride
	- NestedCalldataArrayAbiReencodingSizeValidation
	- SignedImmutables
	- ABIDecodeTwoDimensionalArrayMemory
	- KeccakCaching.
It is used by:
	- [^0.8.0](../contracts/UnsafeToken.sol#L2)


- **Location**: `UnsafeToken.sol:2`
- **Recommendation**: Review and fix the vulnerability

---

**[Info]** too-many-digits

[UnsafeToken.constructor()](../contracts/UnsafeToken.sol#L15-L19) uses literals with too many digits:
	- [totalSupply = 1000000 * 10 ** decimals](../contracts/UnsafeToken.sol#L17)


- **Location**: `UnsafeToken.sol:15`
- **Recommendation**: Review and fix the vulnerability

---

**[Info]** constable-states

[UnsafeToken.name](../contracts/UnsafeToken.sol#L5) should be constant 


- **Location**: `UnsafeToken.sol:5`
- **Recommendation**: Review and fix the vulnerability

---

### ADERYN

**[High]** tx-origin-used-for-auth

Using `tx.origin` may lead to problems when users are interacting via smart contract with your protocol. It is recommended to use `msg.sender` for authentication.

- **Location**: `UnsafeToken.sol:23`
- **Recommendation**: Review and fix the issue
- **SWC**: SWC-115

---

**[Low]** unspecific-solidity-pragma

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

- **Location**: `UnsafeToken.sol:2`
- **Recommendation**: Review and fix the issue

---

**[Low]** zero-address-check

Check for `address(0)` when assigning values to address state variables.

- **Location**: `UnsafeToken.sol:24`
- **Recommendation**: Review and fix the issue

---

**[Low]** useless-public-function

Instead of marking a function as `public`, consider marking it as `external` if it is not used internally.

- **Location**: `UnsafeToken.sol:22`
- **Recommendation**: Review and fix the issue

---

**[Low]** useless-public-function

Instead of marking a function as `public`, consider marking it as `external` if it is not used internally.

- **Location**: `UnsafeToken.sol:28`
- **Recommendation**: Review and fix the issue

---


## Appendix

### Tool Execution Details

| Tool | Status | Time (s) | Findings |
|------|--------|----------|----------|
| slither | success | 1.9 | 5 |
| aderyn | success | 0.3 | 5 |
| solhint | not_available | 0.0 | 0 |
| mythril | success | 4.9 | 0 |

---

*Generated by MIESC v4.3.4*

---

### VulnerableBank

# MIESC Security Audit Report

**Contract**: `/contracts/VulnerableBank.sol`
**Date**: 2026-01-19 18:55:34
**MIESC Version**: 4.3.4

## Executive Summary

| Severity | Count |
|----------|-------|
| Critical | 0 |
| High | 2 |
| Medium | 0 |
| Low | 4 |
| Info | 2 |
| **Total** | **8** |

### Tools Executed

- **Successful**: slither, aderyn, mythril
- **Failed/Unavailable**: solhint

## Detailed Findings

### SLITHER

**[High]** reentrancy-eth

Reentrancy in [VulnerableBank.withdraw()](../contracts/VulnerableBank.sol#L12-L20):
	External calls:
	- [(success,None) = msg.sender.call{value: balance}()](../contracts/VulnerableBank.sol#L16)
	State variables written after the call(s):
	- [balances[msg.sender] = 0](../contracts/VulnerableBank.sol#L19)
	[VulnerableBank.balances](../contracts/VulnerableBank.sol#L5) can be used in cross function reentrancies:
	- [VulnerableBank.balances](../contracts/VulnerableBank.sol#L5)
	- [VulnerableBank.deposit()](../contracts/VulnerableBank.sol#L7-L9)
	- [VulnerableBank.withdraw()](../contracts/VulnerableBank.sol#L12-L20)


- **Location**: `VulnerableBank.sol:12`
- **Recommendation**: Review and fix the vulnerability
- **SWC**: SWC-107

---

**[Info]** solc-version

Version constraint ^0.8.0 contains known severe issues (https://solidity.readthedocs.io/en/latest/bugs.html)
	- FullInlinerNonExpressionSplitArgumentEvaluationOrder
	- MissingSideEffectsOnSelectorAccess
	- AbiReencodingHeadOverflowWithStaticArrayCleanup
	- DirtyBytesArrayToStorage
	- DataLocationChangeInInternalOverride
	- NestedCalldataArrayAbiReencodingSizeValidation
	- SignedImmutables
	- ABIDecodeTwoDimensionalArrayMemory
	- KeccakCaching.
It is used by:
	- [^0.8.0](../contracts/VulnerableBank.sol#L2)


- **Location**: `VulnerableBank.sol:2`
- **Recommendation**: Review and fix the vulnerability

---

**[Info]** low-level-calls

Low level call in [VulnerableBank.withdraw()](../contracts/VulnerableBank.sol#L12-L20):
	- [(success,None) = msg.sender.call{value: balance}()](../contracts/VulnerableBank.sol#L16)


- **Location**: `VulnerableBank.sol:12`
- **Recommendation**: Review and fix the vulnerability

---

### ADERYN

**[High]** send-ether-no-checks

Introduce checks for `msg.sender` in the function

- **Location**: `VulnerableBank.sol:12`
- **Recommendation**: Review and fix the issue
- **SWC**: SWC-105

---

**[Low]** unspecific-solidity-pragma

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

- **Location**: `VulnerableBank.sol:2`
- **Recommendation**: Review and fix the issue

---

**[Low]** useless-public-function

Instead of marking a function as `public`, consider marking it as `external` if it is not used internally.

- **Location**: `VulnerableBank.sol:7`
- **Recommendation**: Review and fix the issue

---

**[Low]** useless-public-function

Instead of marking a function as `public`, consider marking it as `external` if it is not used internally.

- **Location**: `VulnerableBank.sol:12`
- **Recommendation**: Review and fix the issue

---

**[Low]** useless-public-function

Instead of marking a function as `public`, consider marking it as `external` if it is not used internally.

- **Location**: `VulnerableBank.sol:22`
- **Recommendation**: Review and fix the issue

---


## Appendix

### Tool Execution Details

| Tool | Status | Time (s) | Findings |
|------|--------|----------|----------|
| slither | success | 2.2 | 3 |
| aderyn | success | 0.3 | 5 |
| solhint | not_available | 0.0 | 0 |
| mythril | success | 5.1 | 0 |

---

*Generated by MIESC v4.3.4*

---

