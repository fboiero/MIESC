{"sources": {"/Users/fboiero/Documents/GitHub/MIESC/contracts/audit/VulnerableBank.sol": {"AST": {"absolutePath": "contracts/audit/VulnerableBank.sol", "id": 253, "exportedSymbols": {"ReentrancyAttacker": [252], "VulnerableBank": [168]}, "nodeType": "SourceUnit", "src": "32:2789:0", "nodes": [{"id": 1, "nodeType": "PragmaDirective", "src": "32:24:0", "nodes": [], "literals": ["solidity", "^", "0.8", ".19"]}, {"id": 168, "nodeType": "ContractDefinition", "src": "248:1815:0", "nodes": [{"id": 6, "nodeType": "VariableDeclaration", "src": "278:43:0", "nodes": [], "constant": false, "functionSelector": "27e235e3", "mutability": "mutable", "name": "balances", "nameLocation": "313:8:0", "scope": 168, "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "typeName": {"id": 5, "keyName": "", "keyNameLocation": "-1:-1:-1", "keyType": {"id": 3, "name": "address", "nodeType": "ElementaryTypeName", "src": "286:7:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Mapping", "src": "278:27:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "valueName": "", "valueNameLocation": "-1:-1:-1", "valueType": {"id": 4, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "297:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}}, "visibility": "public"}, {"id": 8, "nodeType": "VariableDeclaration", "src": "327:28:0", "nodes": [], "constant": false, "functionSelector": "7d882097", "mutability": "mutable", "name": "totalDeposits", "nameLocation": "342:13:0", "scope": 168, "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 7, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "327:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "public"}, {"id": 14, "nodeType": "EventDefinition", "src": "362:52:0", "nodes": [], "anonymous": false, "eventSelector": "e1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c", "name": "Deposit", "nameLocation": "368:7:0", "parameters": {"id": 13, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 10, "indexed": true, "mutability": "mutable", "name": "user", "nameLocation": "392:4:0", "nodeType": "VariableDeclaration", "scope": 14, "src": "376:20:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 9, "name": "address", "nodeType": "ElementaryTypeName", "src": "376:7:0", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}, {"constant": false, "id": 12, "indexed": false, "mutability": "mutable", "name": "amount", "nameLocation": "406:6:0", "nodeType": "VariableDeclaration", "scope": 14, "src": "398:14:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 11, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "398:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "375:38:0"}}, {"id": 20, "nodeType": "EventDefinition", "src": "419:55:0", "nodes": [], "anonymous": false, "eventSelector": "7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65", "name": "Withdrawal", "nameLocation": "425:10:0", "parameters": {"id": 19, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 16, "indexed": true, "mutability": "mutable", "name": "user", "nameLocation": "452:4:0", "nodeType": "VariableDeclaration", "scope": 20, "src": "436:20:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 15, "name": "address", "nodeType": "ElementaryTypeName", "src": "436:7:0", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}, {"constant": false, "id": 18, "indexed": false, "mutability": "mutable", "name": "amount", "nameLocation": "466:6:0", "nodeType": "VariableDeclaration", "scope": 20, "src": "458:14:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 17, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "458:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "435:38:0"}}, {"id": 53, "nodeType": "FunctionDefinition", "src": "537:231:0", "nodes": [], "body": {"id": 52, "nodeType": "Block", "src": "571:197:0", "nodes": [], "statements": [{"expression": {"arguments": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 28, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"expression": {"id": 25, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "589:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 26, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "593:5:0", "memberName": "value", "nodeType": "MemberAccess", "src": "589:9:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": {"hexValue": "30", "id": 27, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "601:1:0", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "src": "589:13:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, {"hexValue": "4465706f736974206d7573742062652067726561746572207468616e2030", "id": 29, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "604:32:0", "typeDescriptions": {"typeIdentifier": "t_stringliteral_a1dfecb3fad5bb2f2ca889220182a9615a266b067f8af9c425f7eb8e6c61aaa0", "typeString": "literal_string \"Deposit must be greater than 0\""}, "value": "Deposit must be greater than 0"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}, {"typeIdentifier": "t_stringliteral_a1dfecb3fad5bb2f2ca889220182a9615a266b067f8af9c425f7eb8e6c61aaa0", "typeString": "literal_string \"Deposit must be greater than 0\""}], "id": 24, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "581:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$", "typeString": "function (bool,string memory) pure"}}, "id": 30, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "581:56:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 31, "nodeType": "ExpressionStatement", "src": "581:56:0"}, {"expression": {"id": 38, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 32, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "647:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 35, "indexExpression": {"expression": {"id": 33, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "656:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 34, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "660:6:0", "memberName": "sender", "nodeType": "MemberAccess", "src": "656:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "647:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "+=", "rightHandSide": {"expression": {"id": 36, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "671:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 37, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "675:5:0", "memberName": "value", "nodeType": "MemberAccess", "src": "671:9:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "647:33:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 39, "nodeType": "ExpressionStatement", "src": "647:33:0"}, {"expression": {"id": 43, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 40, "name": "totalDeposits", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 8, "src": "690:13:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "+=", "rightHandSide": {"expression": {"id": 41, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "707:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 42, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "711:5:0", "memberName": "value", "nodeType": "MemberAccess", "src": "707:9:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "690:26:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 44, "nodeType": "ExpressionStatement", "src": "690:26:0"}, {"eventCall": {"arguments": [{"expression": {"id": 46, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "739:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 47, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "743:6:0", "memberName": "sender", "nodeType": "MemberAccess", "src": "739:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, {"expression": {"id": 48, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "751:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 49, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "755:5:0", "memberName": "value", "nodeType": "MemberAccess", "src": "751:9:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}], "id": 45, "name": "Deposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14, "src": "731:7:0", "typeDescriptions": {"typeIdentifier": "t_function_event_nonpayable$_t_address_$_t_uint256_$returns$__$", "typeString": "function (address,uint256)"}}, "id": 50, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "731:30:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 51, "nodeType": "EmitStatement", "src": "726:35:0"}]}, "documentation": {"id": 21, "nodeType": "StructuredDocumentation", "src": "480:52:0", "text": " @notice Deposit ETH into the bank"}, "functionSelector": "d0e30db0", "implemented": true, "kind": "function", "modifiers": [], "name": "deposit", "nameLocation": "546:7:0", "parameters": {"id": 22, "nodeType": "ParameterList", "parameters": [], "src": "553:2:0"}, "returnParameters": {"id": 23, "nodeType": "ParameterList", "parameters": [], "src": "571:0:0"}, "scope": 168, "stateMutability": "payable", "virtual": false, "visibility": "public"}, {"id": 104, "nodeType": "FunctionDefinition", "src": "913:497:0", "nodes": [], "body": {"id": 103, "nodeType": "Block", "src": "940:470:0", "nodes": [], "statements": [{"assignments": [58], "declarations": [{"constant": false, "id": 58, "mutability": "mutable", "name": "balance", "nameLocation": "958:7:0", "nodeType": "VariableDeclaration", "scope": 103, "src": "950:15:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 57, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "950:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 63, "initialValue": {"baseExpression": {"id": 59, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "968:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 62, "indexExpression": {"expression": {"id": 60, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "977:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 61, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "981:6:0", "memberName": "sender", "nodeType": "MemberAccess", "src": "977:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "968:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "950:38:0"}, {"expression": {"arguments": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 67, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 65, "name": "balance", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 58, "src": "1006:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": {"hexValue": "30", "id": 66, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1016:1:0", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "src": "1006:11:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, {"hexValue": "4e6f2062616c616e636520746f207769746864726177", "id": 68, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "1019:24:0", "typeDescriptions": {"typeIdentifier": "t_stringliteral_af08831b689a6e21ff2a1d61127eae3e817b5eace5682b882b19cef960f308a5", "typeString": "literal_string \"No balance to withdraw\""}, "value": "No balance to withdraw"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}, {"typeIdentifier": "t_stringliteral_af08831b689a6e21ff2a1d61127eae3e817b5eace5682b882b19cef960f308a5", "typeString": "literal_string \"No balance to withdraw\""}], "id": 64, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "998:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$", "typeString": "function (bool,string memory) pure"}}, "id": 69, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "998:46:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 70, "nodeType": "ExpressionStatement", "src": "998:46:0"}, {"assignments": [72, null], "declarations": [{"constant": false, "id": 72, "mutability": "mutable", "name": "success", "nameLocation": "1121:7:0", "nodeType": "VariableDeclaration", "scope": 103, "src": "1116:12:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 71, "name": "bool", "nodeType": "ElementaryTypeName", "src": "1116:4:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}, null], "id": 80, "initialValue": {"arguments": [{"hexValue": "", "id": 78, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "1166:2:0", "typeDescriptions": {"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}, "value": ""}], "expression": {"argumentTypes": [{"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}], "expression": {"argumentTypes": [{"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}], "expression": {"expression": {"id": 73, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1134:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 74, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1138:6:0", "memberName": "sender", "nodeType": "MemberAccess", "src": "1134:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "id": 75, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1145:4:0", "memberName": "call", "nodeType": "MemberAccess", "src": "1134:15:0", "typeDescriptions": {"typeIdentifier": "t_function_barecall_payable$_t_bytes_memory_ptr_$returns$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "function (bytes memory) payable returns (bool,bytes memory)"}}, "id": 77, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 76, "name": "balance", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 58, "src": "1157:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "1134:31:0", "typeDescriptions": {"typeIdentifier": "t_function_barecall_payable$_t_bytes_memory_ptr_$returns$_t_bool_$_t_bytes_memory_ptr_$value", "typeString": "function (bytes memory) payable returns (bool,bytes memory)"}}, "id": 79, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1134:35:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "tuple(bool,bytes memory)"}}, "nodeType": "VariableDeclarationStatement", "src": "1115:54:0"}, {"expression": {"arguments": [{"id": 82, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 72, "src": "1187:7:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, {"hexValue": "5472616e73666572206661696c6564", "id": 83, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "1196:17:0", "typeDescriptions": {"typeIdentifier": "t_stringliteral_25adaa6d082ce15f901e0d8a3d393e7462ef9edf2e6bc8321fa14d1615b6fc51", "typeString": "literal_string \"Transfer failed\""}, "value": "Transfer failed"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}, {"typeIdentifier": "t_stringliteral_25adaa6d082ce15f901e0d8a3d393e7462ef9edf2e6bc8321fa14d1615b6fc51", "typeString": "literal_string \"Transfer failed\""}], "id": 81, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "1179:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$", "typeString": "function (bool,string memory) pure"}}, "id": 84, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1179:35:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 85, "nodeType": "ExpressionStatement", "src": "1179:35:0"}, {"expression": {"id": 91, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 86, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "1298:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 89, "indexExpression": {"expression": {"id": 87, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1307:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 88, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1311:6:0", "memberName": "sender", "nodeType": "MemberAccess", "src": "1307:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "1298:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"hexValue": "30", "id": 90, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1321:1:0", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "src": "1298:24:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 92, "nodeType": "ExpressionStatement", "src": "1298:24:0"}, {"expression": {"id": 95, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 93, "name": "totalDeposits", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 8, "src": "1332:13:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "-=", "rightHandSide": {"id": 94, "name": "balance", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 58, "src": "1349:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1332:24:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 96, "nodeType": "ExpressionStatement", "src": "1332:24:0"}, {"eventCall": {"arguments": [{"expression": {"id": 98, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1383:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 99, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1387:6:0", "memberName": "sender", "nodeType": "MemberAccess", "src": "1383:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, {"id": 100, "name": "balance", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 58, "src": "1395:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}], "id": 97, "name": "Withdrawal", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20, "src": "1372:10:0", "typeDescriptions": {"typeIdentifier": "t_function_event_nonpayable$_t_address_$_t_uint256_$returns$__$", "typeString": "function (address,uint256)"}}, "id": 101, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1372:31:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 102, "nodeType": "EmitStatement", "src": "1367:36:0"}]}, "documentation": {"id": 54, "nodeType": "StructuredDocumentation", "src": "774:134:0", "text": " @notice Withdraw all funds - VULNERABLE TO REENTRANCY\n @dev The external call happens BEFORE the state update"}, "functionSelector": "3ccfd60b", "implemented": true, "kind": "function", "modifiers": [], "name": "withdraw", "nameLocation": "922:8:0", "parameters": {"id": 55, "nodeType": "ParameterList", "parameters": [], "src": "930:2:0"}, "returnParameters": {"id": 56, "nodeType": "ParameterList", "parameters": [], "src": "940:0:0"}, "scope": 168, "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"id": 147, "nodeType": "FunctionDefinition", "src": "1490:349:0", "nodes": [], "body": {"id": 146, "nodeType": "Block", "src": "1537:302:0", "nodes": [], "statements": [{"expression": {"arguments": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 116, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"baseExpression": {"id": 111, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "1555:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 114, "indexExpression": {"expression": {"id": 112, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1564:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 113, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1568:6:0", "memberName": "sender", "nodeType": "MemberAccess", "src": "1564:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "1555:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": {"id": 115, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 107, "src": "1579:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1555:30:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, {"hexValue": "496e73756666696369656e742062616c616e6365", "id": 117, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "1587:22:0", "typeDescriptions": {"typeIdentifier": "t_stringliteral_47533c3652efd02135ecc34b3fac8efc7b14bf0618b9392fd6e044a3d8a6eef5", "typeString": "literal_string \"Insufficient balance\""}, "value": "Insufficient balance"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}, {"typeIdentifier": "t_stringliteral_47533c3652efd02135ecc34b3fac8efc7b14bf0618b9392fd6e044a3d8a6eef5", "typeString": "literal_string \"Insufficient balance\""}], "id": 110, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "1547:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$", "typeString": "function (bool,string memory) pure"}}, "id": 118, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1547:63:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 119, "nodeType": "ExpressionStatement", "src": "1547:63:0"}, {"assignments": [121, null], "declarations": [{"constant": false, "id": 121, "mutability": "mutable", "name": "success", "nameLocation": "1666:7:0", "nodeType": "VariableDeclaration", "scope": 146, "src": "1661:12:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 120, "name": "bool", "nodeType": "ElementaryTypeName", "src": "1661:4:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}, null], "id": 129, "initialValue": {"arguments": [{"hexValue": "", "id": 127, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "1710:2:0", "typeDescriptions": {"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}, "value": ""}], "expression": {"argumentTypes": [{"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}], "expression": {"argumentTypes": [{"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}], "expression": {"expression": {"id": 122, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1679:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 123, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1683:6:0", "memberName": "sender", "nodeType": "MemberAccess", "src": "1679:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "id": 124, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1690:4:0", "memberName": "call", "nodeType": "MemberAccess", "src": "1679:15:0", "typeDescriptions": {"typeIdentifier": "t_function_barecall_payable$_t_bytes_memory_ptr_$returns$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "function (bytes memory) payable returns (bool,bytes memory)"}}, "id": 126, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 125, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 107, "src": "1702:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "1679:30:0", "typeDescriptions": {"typeIdentifier": "t_function_barecall_payable$_t_bytes_memory_ptr_$returns$_t_bool_$_t_bytes_memory_ptr_$value", "typeString": "function (bytes memory) payable returns (bool,bytes memory)"}}, "id": 128, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1679:34:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "tuple(bool,bytes memory)"}}, "nodeType": "VariableDeclarationStatement", "src": "1660:53:0"}, {"expression": {"arguments": [{"id": 131, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 121, "src": "1731:7:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, {"hexValue": "5472616e73666572206661696c6564", "id": 132, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "1740:17:0", "typeDescriptions": {"typeIdentifier": "t_stringliteral_25adaa6d082ce15f901e0d8a3d393e7462ef9edf2e6bc8321fa14d1615b6fc51", "typeString": "literal_string \"Transfer failed\""}, "value": "Transfer failed"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}, {"typeIdentifier": "t_stringliteral_25adaa6d082ce15f901e0d8a3d393e7462ef9edf2e6bc8321fa14d1615b6fc51", "typeString": "literal_string \"Transfer failed\""}], "id": 130, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "1723:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$", "typeString": "function (bool,string memory) pure"}}, "id": 133, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1723:35:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 134, "nodeType": "ExpressionStatement", "src": "1723:35:0"}, {"expression": {"id": 140, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 135, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "1769:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 138, "indexExpression": {"expression": {"id": 136, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1778:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 137, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1782:6:0", "memberName": "sender", "nodeType": "MemberAccess", "src": "1778:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "1769:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "-=", "rightHandSide": {"id": 139, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 107, "src": "1793:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1769:30:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 141, "nodeType": "ExpressionStatement", "src": "1769:30:0"}, {"expression": {"id": 144, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 142, "name": "totalDeposits", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 8, "src": "1809:13:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "-=", "rightHandSide": {"id": 143, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 107, "src": "1826:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1809:23:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 145, "nodeType": "ExpressionStatement", "src": "1809:23:0"}]}, "documentation": {"id": 105, "nodeType": "StructuredDocumentation", "src": "1416:69:0", "text": " @notice Withdraw specific amount - also vulnerable"}, "functionSelector": "0562b9f7", "implemented": true, "kind": "function", "modifiers": [], "name": "withdrawAmount", "nameLocation": "1499:14:0", "parameters": {"id": 108, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 107, "mutability": "mutable", "name": "amount", "nameLocation": "1522:6:0", "nodeType": "VariableDeclaration", "scope": 147, "src": "1514:14:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 106, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1514:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "1513:16:0"}, "returnParameters": {"id": 109, "nodeType": "ParameterList", "parameters": [], "src": "1537:0:0"}, "scope": 168, "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"id": 160, "nodeType": "FunctionDefinition", "src": "1897:105:0", "nodes": [], "body": {"id": 159, "nodeType": "Block", "src": "1957:45:0", "nodes": [], "statements": [{"expression": {"expression": {"arguments": [{"id": 155, "name": "this", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -28, "src": "1982:4:0", "typeDescriptions": {"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}], "id": 154, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "1974:7:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_address_$", "typeString": "type(address)"}, "typeName": {"id": 153, "name": "address", "nodeType": "ElementaryTypeName", "src": "1974:7:0", "typeDescriptions": {}}}, "id": 156, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1974:13:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "id": 157, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1988:7:0", "memberName": "balance", "nodeType": "MemberAccess", "src": "1974:21:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "functionReturnParameters": 152, "id": 158, "nodeType": "Return", "src": "1967:28:0"}]}, "documentation": {"id": 148, "nodeType": "StructuredDocumentation", "src": "1845:47:0", "text": " @notice Get contract balance"}, "functionSelector": "6f9fb98a", "implemented": true, "kind": "function", "modifiers": [], "name": "getContractBalance", "nameLocation": "1906:18:0", "parameters": {"id": 149, "nodeType": "ParameterList", "parameters": [], "src": "1924:2:0"}, "returnParameters": {"id": 152, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 151, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 160, "src": "1948:7:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 150, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1948:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "1947:9:0"}, "scope": 168, "stateMutability": "view", "virtual": false, "visibility": "public"}, {"id": 167, "nodeType": "FunctionDefinition", "src": "2008:53:0", "nodes": [], "body": {"id": 166, "nodeType": "Block", "src": "2035:26:0", "nodes": [], "statements": [{"expression": {"arguments": [], "expression": {"argumentTypes": [], "id": 163, "name": "deposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 53, "src": "2045:7:0", "typeDescriptions": {"typeIdentifier": "t_function_internal_nonpayable$__$returns$__$", "typeString": "function ()"}}, "id": 164, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2045:9:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 165, "nodeType": "ExpressionStatement", "src": "2045:9:0"}]}, "implemented": true, "kind": "receive", "modifiers": [], "name": "", "nameLocation": "-1:-1:-1", "parameters": {"id": 161, "nodeType": "ParameterList", "parameters": [], "src": "2015:2:0"}, "returnParameters": {"id": 162, "nodeType": "ParameterList", "parameters": [], "src": "2035:0:0"}, "scope": 168, "stateMutability": "payable", "virtual": false, "visibility": "external"}], "abstract": false, "baseContracts": [], "canonicalName": "VulnerableBank", "contractDependencies": [], "contractKind": "contract", "documentation": {"id": 2, "nodeType": "StructuredDocumentation", "src": "58:189:0", "text": " @title VulnerableBank\n @notice Contract with REENTRANCY vulnerability for security audit testing\n @dev Contains classic reentrancy pattern - external call before state update"}, "fullyImplemented": true, "linearizedBaseContracts": [168], "name": "VulnerableBank", "nameLocation": "257:14:0", "scope": 253, "usedErrors": [], "usedEvents": [14, 20]}, {"id": 252, "nodeType": "ContractDefinition", "src": "2168:652:0", "nodes": [{"id": 172, "nodeType": "VariableDeclaration", "src": "2202:28:0", "nodes": [], "constant": false, "functionSelector": "d4b83992", "mutability": "mutable", "name": "target", "nameLocation": "2224:6:0", "scope": 252, "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}, "typeName": {"id": 171, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 170, "name": "VulnerableBank", "nameLocations": ["2202:14:0"], "nodeType": "IdentifierPath", "referencedDeclaration": 168, "src": "2202:14:0"}, "referencedDeclaration": 168, "src": "2202:14:0", "typeDescriptions": {"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}}, "visibility": "public"}, {"id": 174, "nodeType": "VariableDeclaration", "src": "2236:26:0", "nodes": [], "constant": false, "functionSelector": "407c2821", "mutability": "mutable", "name": "attackCount", "nameLocation": "2251:11:0", "scope": 252, "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 173, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2236:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "public"}, {"id": 189, "nodeType": "FunctionDefinition", "src": "2269:87:0", "nodes": [], "body": {"id": 188, "nodeType": "Block", "src": "2298:58:0", "nodes": [], "statements": [{"expression": {"id": 186, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 179, "name": "target", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 172, "src": "2308:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"arguments": [{"id": 183, "name": "_target", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 176, "src": "2340:7:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 182, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "2332:8:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_address_payable_$", "typeString": "type(address payable)"}, "typeName": {"id": 181, "name": "address", "nodeType": "ElementaryTypeName", "src": "2332:8:0", "stateMutability": "payable", "typeDescriptions": {}}}, "id": 184, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2332:16:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address_payable", "typeString": "address payable"}], "id": 180, "name": "VulnerableBank", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 168, "src": "2317:14:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_VulnerableBank_$168_$", "typeString": "type(contract VulnerableBank)"}}, "id": 185, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2317:32:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}}, "src": "2308:41:0", "typeDescriptions": {"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}}, "id": 187, "nodeType": "ExpressionStatement", "src": "2308:41:0"}]}, "implemented": true, "kind": "constructor", "modifiers": [], "name": "", "nameLocation": "-1:-1:-1", "parameters": {"id": 177, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 176, "mutability": "mutable", "name": "_target", "nameLocation": "2289:7:0", "nodeType": "VariableDeclaration", "scope": 189, "src": "2281:15:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 175, "name": "address", "nodeType": "ElementaryTypeName", "src": "2281:7:0", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}], "src": "2280:17:0"}, "returnParameters": {"id": 178, "nodeType": "ParameterList", "parameters": [], "src": "2298:0:0"}, "scope": 252, "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"id": 214, "nodeType": "FunctionDefinition", "src": "2362:175:0", "nodes": [], "body": {"id": 213, "nodeType": "Block", "src": "2397:140:0", "nodes": [], "statements": [{"expression": {"arguments": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 196, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"expression": {"id": 193, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "2415:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 194, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2419:5:0", "memberName": "value", "nodeType": "MemberAccess", "src": "2415:9:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": {"hexValue": "31", "id": 195, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "2428:7:0", "subdenomination": "ether", "typeDescriptions": {"typeIdentifier": "t_rational_1000000000000000000_by_1", "typeString": "int_const 1000000000000000000"}, "value": "1"}, "src": "2415:20:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, {"hexValue": "4e656564206174206c65617374203120455448", "id": 197, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "2437:21:0", "typeDescriptions": {"typeIdentifier": "t_stringliteral_8a38e7c48852441a08c5974052e23d1e7d34e8a157a48698abbef654e98e5ce2", "typeString": "literal_string \"Need at least 1 ETH\""}, "value": "Need at least 1 ETH"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}, {"typeIdentifier": "t_stringliteral_8a38e7c48852441a08c5974052e23d1e7d34e8a157a48698abbef654e98e5ce2", "typeString": "literal_string \"Need at least 1 ETH\""}], "id": 192, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "2407:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$", "typeString": "function (bool,string memory) pure"}}, "id": 198, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2407:52:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 199, "nodeType": "ExpressionStatement", "src": "2407:52:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"argumentTypes": [], "expression": {"id": 200, "name": "target", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 172, "src": "2469:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}}, "id": 202, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2476:7:0", "memberName": "deposit", "nodeType": "MemberAccess", "referencedDeclaration": 53, "src": "2469:14:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$", "typeString": "function () payable external"}}, "id": 205, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"expression": {"id": 203, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "2491:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 204, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2495:5:0", "memberName": "value", "nodeType": "MemberAccess", "src": "2491:9:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "2469:32:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$value", "typeString": "function () payable external"}}, "id": 206, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2469:34:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 207, "nodeType": "ExpressionStatement", "src": "2469:34:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 208, "name": "target", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 172, "src": "2513:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}}, "id": 210, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2520:8:0", "memberName": "withdraw", "nodeType": "MemberAccess", "referencedDeclaration": 104, "src": "2513:15:0", "typeDescriptions": {"typeIdentifier": "t_function_external_nonpayable$__$returns$__$", "typeString": "function () external"}}, "id": 211, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2513:17:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 212, "nodeType": "ExpressionStatement", "src": "2513:17:0"}]}, "functionSelector": "9e5faafc", "implemented": true, "kind": "function", "modifiers": [], "name": "attack", "nameLocation": "2371:6:0", "parameters": {"id": 190, "nodeType": "ParameterList", "parameters": [], "src": "2377:2:0"}, "returnParameters": {"id": 191, "nodeType": "ParameterList", "parameters": [], "src": "2397:0:0"}, "scope": 252, "stateMutability": "payable", "virtual": false, "visibility": "external"}, {"id": 239, "nodeType": "FunctionDefinition", "src": "2543:172:0", "nodes": [], "body": {"id": 238, "nodeType": "Block", "src": "2570:145:0", "nodes": [], "statements": [{"condition": {"commonType": {"typeIdentifier": "t_bool", "typeString": "bool"}, "id": 227, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 223, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"expression": {"arguments": [{"id": 219, "name": "target", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 172, "src": "2592:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}], "id": 218, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "2584:7:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_address_$", "typeString": "type(address)"}, "typeName": {"id": 217, "name": "address", "nodeType": "ElementaryTypeName", "src": "2584:7:0", "typeDescriptions": {}}}, "id": 220, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2584:15:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "id": 221, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2600:7:0", "memberName": "balance", "nodeType": "MemberAccess", "src": "2584:23:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": {"hexValue": "31", "id": 222, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "2611:7:0", "subdenomination": "ether", "typeDescriptions": {"typeIdentifier": "t_rational_1000000000000000000_by_1", "typeString": "int_const 1000000000000000000"}, "value": "1"}, "src": "2584:34:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "nodeType": "BinaryOperation", "operator": "&&", "rightExpression": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 226, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 224, "name": "attackCount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 174, "src": "2622:11:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": {"hexValue": "3130", "id": 225, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "2636:2:0", "typeDescriptions": {"typeIdentifier": "t_rational_10_by_1", "typeString": "int_const 10"}, "value": "10"}, "src": "2622:16:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "src": "2584:54:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 237, "nodeType": "IfStatement", "src": "2580:129:0", "trueBody": {"id": 236, "nodeType": "Block", "src": "2640:69:0", "statements": [{"expression": {"id": 229, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "++", "prefix": false, "src": "2654:13:0", "subExpression": {"id": 228, "name": "attackCount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 174, "src": "2654:11:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 230, "nodeType": "ExpressionStatement", "src": "2654:13:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 231, "name": "target", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 172, "src": "2681:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_VulnerableBank_$168", "typeString": "contract VulnerableBank"}}, "id": 233, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2688:8:0", "memberName": "withdraw", "nodeType": "MemberAccess", "referencedDeclaration": 104, "src": "2681:15:0", "typeDescriptions": {"typeIdentifier": "t_function_external_nonpayable$__$returns$__$", "typeString": "function () external"}}, "id": 234, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2681:17:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 235, "nodeType": "ExpressionStatement", "src": "2681:17:0"}]}}]}, "implemented": true, "kind": "receive", "modifiers": [], "name": "", "nameLocation": "-1:-1:-1", "parameters": {"id": 215, "nodeType": "ParameterList", "parameters": [], "src": "2550:2:0"}, "returnParameters": {"id": 216, "nodeType": "ParameterList", "parameters": [], "src": "2570:0:0"}, "scope": 252, "stateMutability": "payable", "virtual": false, "visibility": "external"}, {"id": 251, "nodeType": "FunctionDefinition", "src": "2721:97:0", "nodes": [], "body": {"id": 250, "nodeType": "Block", "src": "2773:45:0", "nodes": [], "statements": [{"expression": {"expression": {"arguments": [{"id": 246, "name": "this", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -28, "src": "2798:4:0", "typeDescriptions": {"typeIdentifier": "t_contract$_ReentrancyAttacker_$252", "typeString": "contract ReentrancyAttacker"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_contract$_ReentrancyAttacker_$252", "typeString": "contract ReentrancyAttacker"}], "id": 245, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "2790:7:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_address_$", "typeString": "type(address)"}, "typeName": {"id": 244, "name": "address", "nodeType": "ElementaryTypeName", "src": "2790:7:0", "typeDescriptions": {}}}, "id": 247, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2790:13:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "id": 248, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2804:7:0", "memberName": "balance", "nodeType": "MemberAccess", "src": "2790:21:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "functionReturnParameters": 243, "id": 249, "nodeType": "Return", "src": "2783:28:0"}]}, "functionSelector": "12065fe0", "implemented": true, "kind": "function", "modifiers": [], "name": "getBalance", "nameLocation": "2730:10:0", "parameters": {"id": 240, "nodeType": "ParameterList", "parameters": [], "src": "2740:2:0"}, "returnParameters": {"id": 243, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 242, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 251, "src": "2764:7:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 241, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2764:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "2763:9:0"}, "scope": 252, "stateMutability": "view", "virtual": false, "visibility": "public"}], "abstract": false, "baseContracts": [], "canonicalName": "ReentrancyAttacker", "contractDependencies": [], "contractKind": "contract", "documentation": {"id": 169, "nodeType": "StructuredDocumentation", "src": "2065:102:0", "text": " @title ReentrancyAttacker\n @notice Attacker contract demonstrating the reentrancy exploit"}, "fullyImplemented": true, "linearizedBaseContracts": [252], "name": "ReentrancyAttacker", "nameLocation": "2177:18:0", "scope": 253, "usedErrors": [], "usedEvents": []}], "license": "MIT"}}}, "sourceList": ["/Users/fboiero/Documents/GitHub/MIESC/contracts/audit/VulnerableBank.sol"], "contracts": {"/Users/fboiero/Documents/GitHub/MIESC/contracts/audit/VulnerableBank.sol:ReentrancyAttacker": {"srcmap": "2168:652:0:-:0;;;2269:87;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;2308:6;:41;;-1:-1:-1;;;;;;2308:41:0;-1:-1:-1;;;;;2308:41:0;;;;;;;;;;2168:652;;14:290:1;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:1;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:1:o;:::-;2168:652:0;;;;;;", "srcmap-runtime": "2168:652:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2592:6;;2611:7;-1:-1:-1;;;;;2592:6:0;;;2584:23;:34;;;;:54;;;2636:2;2622:11;;:16;2584:54;2580:129;;;2654:11;:13;;;:11;:13;;;:::i;:::-;;;;-1:-1:-1;;2681:6:0;;;:17;;;-1:-1:-1;;;2681:17:0;;;;-1:-1:-1;;;;;2681:6:0;;;;:15;;:17;;;;;;;;;;:6;;:17;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2580:129;2168:652;;;;;2721:97;;;;;;;;;;-1:-1:-1;2790:21:0;2721:97;;;397:25:1;;;385:2;370:18;2721:97:0;;;;;;;;2236:26;;;;;;;;;;;;;;;;2362:175;;;:::i;2202:28::-;;;;;;;;;;-1:-1:-1;2202:28:0;;;;-1:-1:-1;;;;;2202:28:0;;;;;;-1:-1:-1;;;;;627:32:1;;;609:51;;597:2;582:18;2202:28:0;433:233:1;2362:175:0;2428:7;2415:9;:20;;2407:52;;;;-1:-1:-1;;;2407:52:0;;873:2:1;2407:52:0;;;855:21:1;912:2;892:18;;;885:30;-1:-1:-1;;;931:18:1;;;924:49;990:18;;2407:52:0;;;;;;;;2469:6;;;;;;;;-1:-1:-1;;;;;2469:6:0;-1:-1:-1;;;;;2469:14:0;;2491:9;2469:34;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;2513:6:0;;;:17;;;-1:-1:-1;;;2513:17:0;;;;-1:-1:-1;;;;;2513:6:0;;;;-1:-1:-1;2513:15:0;;-1:-1:-1;2513:17:0;;;;;-1:-1:-1;2513:17:0;;;;;;:6;;:17;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2362:175::o;14:232:1:-;53:3;74:17;;;71:140;;133:10;128:3;124:20;121:1;114:31;168:4;165:1;158:15;196:4;193:1;186:15;71:140;-1:-1:-1;238:1:1;227:13;;14:232::o", "abi": "[{\"type\": \"constructor\", \"inputs\": [{\"name\": \"_target\", \"type\": \"address\", \"internalType\": \"address\"}], \"stateMutability\": \"nonpayable\"}, {\"type\": \"receive\", \"stateMutability\": \"payable\"}, {\"type\": \"function\", \"name\": \"attack\", \"inputs\": [], \"outputs\": [], \"stateMutability\": \"payable\"}, {\"type\": \"function\", \"name\": \"attackCount\", \"inputs\": [], \"outputs\": [{\"name\": \"\", \"type\": \"uint256\", \"internalType\": \"uint256\"}], \"stateMutability\": \"view\"}, {\"type\": \"function\", \"name\": \"getBalance\", \"inputs\": [], \"outputs\": [{\"name\": \"\", \"type\": \"uint256\", \"internalType\": \"uint256\"}], \"stateMutability\": \"view\"}, {\"type\": \"function\", \"name\": \"target\", \"inputs\": [], \"outputs\": [{\"name\": \"\", \"type\": \"address\", \"internalType\": \"contract VulnerableBank\"}], \"stateMutability\": \"view\"}]", "bin": "608060405234801561000f575f80fd5b5060405161031f38038061031f83398101604081905261002e91610052565b5f80546001600160a01b0319166001600160a01b039290921691909117905561007f565b5f60208284031215610062575f80fd5b81516001600160a01b0381168114610078575f80fd5b9392505050565b6102938061008c5f395ff3fe608060405260043610610041575f3560e01c806312065fe0146100e2578063407c2821146101035780639e5faafc14610118578063d4b8399214610120575f80fd5b366100de575f54670de0b6b3a76400006001600160a01b03909116311080159061006d5750600a600154105b156100dc5760018054905f61008183610262565b90915550505f805460408051633ccfd60b60e01b815290516001600160a01b0390921692633ccfd60b9260048084019382900301818387803b1580156100c5575f80fd5b505af11580156100d7573d5f803e3d5ffd5b505050505b005b5f80fd5b3480156100ed575f80fd5b50475b6040519081526020015b60405180910390f35b34801561010e575f80fd5b506100f060015481565b6100dc610156565b34801561012b575f80fd5b505f5461013e906001600160a01b031681565b6040516001600160a01b0390911681526020016100fa565b670de0b6b3a76400003410156101a85760405162461bcd60e51b815260206004820152601360248201527209ccacac840c2e840d8cac2e6e84062408aa89606b1b604482015260640160405180910390fd5b5f8054906101000a90046001600160a01b03166001600160a01b031663d0e30db0346040518263ffffffff1660e01b81526004015f604051808303818588803b1580156101f3575f80fd5b505af1158015610205573d5f803e3d5ffd5b50505f805460408051633ccfd60b60e01b815290516001600160a01b039092169550633ccfd60b9450600480820194509082900301818387803b15801561024a575f80fd5b505af115801561025c573d5f803e3d5ffd5b50505050565b5f6001820161027f57634e487b7160e01b5f52601160045260245ffd5b506001019056fea164736f6c6343000814000a", "bin-runtime": "608060405260043610610041575f3560e01c806312065fe0146100e2578063407c2821146101035780639e5faafc14610118578063d4b8399214610120575f80fd5b366100de575f54670de0b6b3a76400006001600160a01b03909116311080159061006d5750600a600154105b156100dc5760018054905f61008183610262565b90915550505f805460408051633ccfd60b60e01b815290516001600160a01b0390921692633ccfd60b9260048084019382900301818387803b1580156100c5575f80fd5b505af11580156100d7573d5f803e3d5ffd5b505050505b005b5f80fd5b3480156100ed575f80fd5b50475b6040519081526020015b60405180910390f35b34801561010e575f80fd5b506100f060015481565b6100dc610156565b34801561012b575f80fd5b505f5461013e906001600160a01b031681565b6040516001600160a01b0390911681526020016100fa565b670de0b6b3a76400003410156101a85760405162461bcd60e51b815260206004820152601360248201527209ccacac840c2e840d8cac2e6e84062408aa89606b1b604482015260640160405180910390fd5b5f8054906101000a90046001600160a01b03166001600160a01b031663d0e30db0346040518263ffffffff1660e01b81526004015f604051808303818588803b1580156101f3575f80fd5b505af1158015610205573d5f803e3d5ffd5b50505f805460408051633ccfd60b60e01b815290516001600160a01b039092169550633ccfd60b9450600480820194509082900301818387803b15801561024a575f80fd5b505af115801561025c573d5f803e3d5ffd5b50505050565b5f6001820161027f57634e487b7160e01b5f52601160045260245ffd5b506001019056fea164736f6c6343000814000a", "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}, "libraries": {}}, "/Users/fboiero/Documents/GitHub/MIESC/contracts/audit/VulnerableBank.sol:VulnerableBank": {"srcmap": "248:1815:0:-:0;;;;;;;;;;;;;;;;;;;", "srcmap-runtime": "248:1815:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2045:9;:7;:9::i;:::-;248:1815;;;;;1490:349;;;;;;;;;;-1:-1:-1;1490:349:0;;;;;:::i;:::-;;:::i;278:43::-;;;;;;;;;;-1:-1:-1;278:43:0;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;636:25:1;;;624:2;609:18;278:43:0;;;;;;;913:497;;;;;;;;;;;;;:::i;1897:105::-;;;;;;;;;;-1:-1:-1;1974:21:0;1897:105;;327:28;;;;;;;;;;;;;;;;537:231;;;601:1;589:9;:13;581:56;;;;-1:-1:-1;;;581:56:0;;874:2:1;581:56:0;;;856:21:1;913:2;893:18;;;886:30;952:32;932:18;;;925:60;1002:18;;581:56:0;;;;;;;;;656:10;647:8;:20;;;;;;;;;;:33;;671:9;;647:8;:33;;671:9;;647:33;:::i;:::-;;;;;;;;707:9;690:13;;:26;;;;;;;:::i;:::-;;;;-1:-1:-1;;731:30:0;;751:9;636:25:1;;739:10:0;;731:30;;624:2:1;609:18;731:30:0;;;;;;;537:231::o;1490:349::-;1564:10;1555:8;:20;;;;;;;;;;;:30;-1:-1:-1;1555:30:0;1547:63;;;;-1:-1:-1;;;1547:63:0;;1495:2:1;1547:63:0;;;1477:21:1;1534:2;1514:18;;;1507:30;-1:-1:-1;;;1553:18:1;;;1546:50;1613:18;;1547:63:0;1293:344:1;1547:63:0;1679:34;;1661:12;;1679:10;;1702:6;;1661:12;1679:34;1661:12;1679:34;1702:6;1679:10;:34;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1660:53;;;1731:7;1723:35;;;;-1:-1:-1;;;1723:35:0;;2054:2:1;1723:35:0;;;2036:21:1;2093:2;2073:18;;;2066:30;-1:-1:-1;;;2112:18:1;;;2105:45;2167:18;;1723:35:0;1852:339:1;1723:35:0;1778:10;1769:8;:20;;;;;;;;;;:30;;1793:6;;1769:8;:30;;1793:6;;1769:30;:::i;:::-;;;;;;;;1826:6;1809:13;;:23;;;;;;;:::i;:::-;;;;-1:-1:-1;;;;1490:349:0:o;913:497::-;977:10;950:15;968:20;;;;;;;;;;;1006:11;998:46;;;;-1:-1:-1;;;998:46:0;;2531:2:1;998:46:0;;;2513:21:1;2570:2;2550:18;;;2543:30;-1:-1:-1;;;2589:18:1;;;2582:52;2651:18;;998:46:0;2329:346:1;998:46:0;1134:35;;1116:12;;1134:10;;1157:7;;1116:12;1134:35;1116:12;1134:35;1157:7;1134:10;:35;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1115:54;;;1187:7;1179:35;;;;-1:-1:-1;;;1179:35:0;;2054:2:1;1179:35:0;;;2036:21:1;2093:2;2073:18;;;2066:30;-1:-1:-1;;;2112:18:1;;;2105:45;2167:18;;1179:35:0;1852:339:1;1179:35:0;1307:10;1321:1;1298:20;;;;;;;;;;:24;;;1332:13;:24;;1349:7;;1321:1;1332:24;;1349:7;;1332:24;:::i;:::-;;;;-1:-1:-1;;1372:31:0;;636:25:1;;;1383:10:0;;1372:31;;624:2:1;609:18;1372:31:0;;;;;;;940:470;;913:497::o;14:180:1:-;73:6;126:2;114:9;105:7;101:23;97:32;94:52;;;142:1;139;132:12;94:52;-1:-1:-1;165:23:1;;14:180;-1:-1:-1;14:180:1:o;199:286::-;258:6;311:2;299:9;290:7;286:23;282:32;279:52;;;327:1;324;317:12;279:52;353:23;;-1:-1:-1;;;;;405:31:1;;395:42;;385:70;;451:1;448;441:12;385:70;474:5;199:286;-1:-1:-1;;;199:286:1:o;1031:127::-;1092:10;1087:3;1083:20;1080:1;1073:31;1123:4;1120:1;1113:15;1147:4;1144:1;1137:15;1163:125;1228:9;;;1249:10;;;1246:36;;;1262:18;;:::i;:::-;1163:125;;;;:::o;2196:128::-;2263:9;;;2284:11;;;2281:37;;;2298:18;;:::i", "abi": "[{\"type\": \"receive\", \"stateMutability\": \"payable\"}, {\"type\": \"function\", \"name\": \"balances\", \"inputs\": [{\"name\": \"\", \"type\": \"address\", \"internalType\": \"address\"}], \"outputs\": [{\"name\": \"\", \"type\": \"uint256\", \"internalType\": \"uint256\"}], \"stateMutability\": \"view\"}, {\"type\": \"function\", \"name\": \"deposit\", \"inputs\": [], \"outputs\": [], \"stateMutability\": \"payable\"}, {\"type\": \"function\", \"name\": \"getContractBalance\", \"inputs\": [], \"outputs\": [{\"name\": \"\", \"type\": \"uint256\", \"internalType\": \"uint256\"}], \"stateMutability\": \"view\"}, {\"type\": \"function\", \"name\": \"totalDeposits\", \"inputs\": [], \"outputs\": [{\"name\": \"\", \"type\": \"uint256\", \"internalType\": \"uint256\"}], \"stateMutability\": \"view\"}, {\"type\": \"function\", \"name\": \"withdraw\", \"inputs\": [], \"outputs\": [], \"stateMutability\": \"nonpayable\"}, {\"type\": \"function\", \"name\": \"withdrawAmount\", \"inputs\": [{\"name\": \"amount\", \"type\": \"uint256\", \"internalType\": \"uint256\"}], \"outputs\": [], \"stateMutability\": \"nonpayable\"}, {\"type\": \"event\", \"name\": \"Deposit\", \"inputs\": [{\"name\": \"user\", \"type\": \"address\", \"indexed\": true, \"internalType\": \"address\"}, {\"name\": \"amount\", \"type\": \"uint256\", \"indexed\": false, \"internalType\": \"uint256\"}], \"anonymous\": false}, {\"type\": \"event\", \"name\": \"Withdrawal\", \"inputs\": [{\"name\": \"user\", \"type\": \"address\", \"indexed\": true, \"internalType\": \"address\"}, {\"name\": \"amount\", \"type\": \"uint256\", \"indexed\": false, \"internalType\": \"uint256\"}], \"anonymous\": false}]", "bin": "608060405234801561000f575f80fd5b506104b48061001d5f395ff3fe608060405260043610610057575f3560e01c80630562b9f71461006a57806327e235e3146100895780633ccfd60b146100c65780636f9fb98a146100da5780637d882097146100ec578063d0e30db014610101575f80fd5b3661006657610064610105565b005b5f80fd5b348015610075575f80fd5b50610064610084366004610423565b6101cb565b348015610094575f80fd5b506100b46100a336600461043a565b5f6020819052908152604090205481565b60405190815260200160405180910390f35b3480156100d1575f80fd5b506100646102e6565b3480156100e5575f80fd5b50476100b4565b3480156100f7575f80fd5b506100b460015481565b6100645b5f34116101595760405162461bcd60e51b815260206004820152601e60248201527f4465706f736974206d7573742062652067726561746572207468616e2030000060448201526064015b60405180910390fd5b335f908152602081905260408120805434929061017790849061047b565b925050819055503460015f82825461018f919061047b565b909155505060405134815233907fe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c9060200160405180910390a2565b335f908152602081905260409020548111156102205760405162461bcd60e51b8152602060048201526014602482015273496e73756666696369656e742062616c616e636560601b6044820152606401610150565b6040515f90339083908381818185875af1925050503d805f811461025f576040519150601f19603f3d011682016040523d82523d5f602084013e610264565b606091505b50509050806102a75760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610150565b335f90815260208190526040812080548492906102c5908490610494565b925050819055508160015f8282546102dd9190610494565b90915550505050565b335f908152602081905260409020548061033b5760405162461bcd60e51b81526020600482015260166024820152754e6f2062616c616e636520746f20776974686472617760501b6044820152606401610150565b6040515f90339083908381818185875af1925050503d805f811461037a576040519150601f19603f3d011682016040523d82523d5f602084013e61037f565b606091505b50509050806103c25760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610150565b335f908152602081905260408120819055600180548492906103e5908490610494565b909155505060405182815233907f7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b659060200160405180910390a25050565b5f60208284031215610433575f80fd5b5035919050565b5f6020828403121561044a575f80fd5b81356001600160a01b0381168114610460575f80fd5b9392505050565b634e487b7160e01b5f52601160045260245ffd5b8082018082111561048e5761048e610467565b92915050565b8181038181111561048e5761048e61046756fea164736f6c6343000814000a", "bin-runtime": "608060405260043610610057575f3560e01c80630562b9f71461006a57806327e235e3146100895780633ccfd60b146100c65780636f9fb98a146100da5780637d882097146100ec578063d0e30db014610101575f80fd5b3661006657610064610105565b005b5f80fd5b348015610075575f80fd5b50610064610084366004610423565b6101cb565b348015610094575f80fd5b506100b46100a336600461043a565b5f6020819052908152604090205481565b60405190815260200160405180910390f35b3480156100d1575f80fd5b506100646102e6565b3480156100e5575f80fd5b50476100b4565b3480156100f7575f80fd5b506100b460015481565b6100645b5f34116101595760405162461bcd60e51b815260206004820152601e60248201527f4465706f736974206d7573742062652067726561746572207468616e2030000060448201526064015b60405180910390fd5b335f908152602081905260408120805434929061017790849061047b565b925050819055503460015f82825461018f919061047b565b909155505060405134815233907fe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c9060200160405180910390a2565b335f908152602081905260409020548111156102205760405162461bcd60e51b8152602060048201526014602482015273496e73756666696369656e742062616c616e636560601b6044820152606401610150565b6040515f90339083908381818185875af1925050503d805f811461025f576040519150601f19603f3d011682016040523d82523d5f602084013e610264565b606091505b50509050806102a75760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610150565b335f90815260208190526040812080548492906102c5908490610494565b925050819055508160015f8282546102dd9190610494565b90915550505050565b335f908152602081905260409020548061033b5760405162461bcd60e51b81526020600482015260166024820152754e6f2062616c616e636520746f20776974686472617760501b6044820152606401610150565b6040515f90339083908381818185875af1925050503d805f811461037a576040519150601f19603f3d011682016040523d82523d5f602084013e61037f565b606091505b50509050806103c25760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610150565b335f908152602081905260408120819055600180548492906103e5908490610494565b909155505060405182815233907f7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b659060200160405180910390a25050565b5f60208284031215610433575f80fd5b5035919050565b5f6020828403121561044a575f80fd5b81356001600160a01b0381168114610460575f80fd5b9392505050565b634e487b7160e01b5f52601160045260245ffd5b8082018082111561048e5761048e610467565b92915050565b8181038181111561048e5761048e61046756fea164736f6c6343000814000a", "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}, "libraries": {}}}}