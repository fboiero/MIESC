{
  "name": "miesc",
  "version": "3.3.0",
  "description": "MIESC MCP-compatible audit and formal analysis service for smart contracts",
  "author": "Fernando Boiero",
  "institution": "Universidad de la Defensa Nacional (UNDEF) - IUA CÃ³rdoba",
  "license": "GPL-3.0",
  "endpoints": {
    "analyze": {
      "method": "POST",
      "path": "/analyze",
      "description": "Execute static/dynamic analysis on smart contracts",
      "input_schema": "AnalysisRequest",
      "output_schema": "AnalysisResponse",
      "parameters": {
        "contract_code": {
          "type": "string",
          "required": true,
          "description": "Solidity source code or file path"
        },
        "analysis_type": {
          "type": "string",
          "required": false,
          "default": "slither",
          "enum": ["slither", "mythril", "echidna", "aderyn", "all"],
          "description": "Security tool to use for analysis"
        },
        "timeout": {
          "type": "integer",
          "required": false,
          "default": 300,
          "description": "Maximum execution time in seconds"
        }
      }
    },
    "verify": {
      "method": "POST",
      "path": "/verify",
      "description": "Perform formal verification of smart contract properties",
      "input_schema": "VerifyRequest",
      "output_schema": "VerifyResponse",
      "parameters": {
        "contract_code": {
          "type": "string",
          "required": true,
          "description": "Solidity source code or file path"
        },
        "verification_level": {
          "type": "string",
          "required": false,
          "default": "basic",
          "enum": ["basic", "smt", "certora", "halmos"],
          "description": "Verification method and depth"
        },
        "properties": {
          "type": "array",
          "items": {"type": "string"},
          "required": false,
          "description": "List of properties/invariants to verify"
        },
        "timeout": {
          "type": "integer",
          "required": false,
          "default": 600,
          "description": "Maximum verification time in seconds"
        }
      }
    },
    "classify": {
      "method": "POST",
      "path": "/classify",
      "description": "Classify and score vulnerabilities using AI/ML",
      "input_schema": "ClassifyRequest",
      "output_schema": "ClassifyResponse",
      "parameters": {
        "report": {
          "type": "object",
          "required": true,
          "description": "Analysis report containing findings"
        },
        "enable_ai_triage": {
          "type": "boolean",
          "required": false,
          "default": false,
          "description": "Enable AI-powered false positive reduction"
        },
        "ai_api_key": {
          "type": "string",
          "required": false,
          "description": "OpenAI API key for AI triage"
        }
      }
    }
  },
  "context": {
    "capabilities": [
      "audit",
      "formal_verification",
      "vulnerability_scoring",
      "multi_tool_analysis",
      "ai_triage"
    ],
    "tools_supported": [
      "slither",
      "mythril",
      "echidna",
      "aderyn",
      "solhint",
      "manticore",
      "halmos",
      "certora",
      "smt_checker"
    ],
    "standards_covered": [
      "ISO/IEC 27001:2022",
      "ISO/IEC 42001:2023",
      "NIST SP 800-218",
      "OWASP SC Top 10",
      "OWASP SCSVS",
      "SWC Registry",
      "DASP Top 10"
    ],
    "metrics": {
      "precision": 0.8947,
      "recall": 0.862,
      "f1_score": 0.8781,
      "false_positive_reduction": 0.43,
      "time_savings": 0.90
    }
  },
  "api_version": "1.0",
  "protocol_version": "mcp-1.0",
  "base_url": "http://localhost:8000",
  "health_endpoint": "/health",
  "capabilities_endpoint": "/mcp/capabilities",
  "documentation": {
    "openapi": "/openapi.json",
    "swagger_ui": "/docs",
    "redoc": "/redoc",
    "github": "https://github.com/fboiero/MIESC",
    "thesis": "https://fboiero.github.io/MIESC/thesis"
  }
}
