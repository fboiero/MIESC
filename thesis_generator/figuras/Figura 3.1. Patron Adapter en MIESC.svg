<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 550" font-family="Consolas, Monaco, monospace">
  <!-- Background -->
  <rect width="800" height="550" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#2c3e50">
    Figura 2.3. Patrón Adapter en MIESC
  </text>
  
  <!-- ToolProtocol Interface Box -->
  <rect x="280" y="50" width="240" height="120" fill="white" stroke="#3498db" stroke-width="2" rx="4"/>
  
  <!-- Interface header -->
  <rect x="280" y="50" width="240" height="28" fill="#3498db" rx="4"/>
  <rect x="280" y="70" width="240" height="10" fill="#3498db"/>
  <text x="400" y="70" text-anchor="middle" font-size="13" fill="white" font-weight="bold">«interface»</text>
  
  <!-- Interface name -->
  <text x="400" y="95" text-anchor="middle" font-size="14" font-weight="bold" fill="#2c3e50">ToolProtocol</text>
  
  <!-- Separator line -->
  <line x1="280" y1="105" x2="520" y2="105" stroke="#3498db" stroke-width="1"/>
  
  <!-- Interface methods -->
  <text x="295" y="125" font-size="11" fill="#333">+ analyze()</text>
  <text x="295" y="142" font-size="11" fill="#333">+ is_available()</text>
  <text x="295" y="159" font-size="11" fill="#333">+ get_metadata()</text>
  
  <!-- Inheritance arrow (vertical line from interface) -->
  <line x1="400" y1="170" x2="400" y2="210" stroke="#333" stroke-width="1.5"/>
  
  <!-- Horizontal connector line -->
  <line x1="130" y1="210" x2="670" y2="210" stroke="#333" stroke-width="1.5"/>
  
  <!-- Vertical lines down to each adapter -->
  <line x1="130" y1="210" x2="130" y2="240" stroke="#333" stroke-width="1.5"/>
  <line x1="400" y1="210" x2="400" y2="240" stroke="#333" stroke-width="1.5"/>
  <line x1="670" y1="210" x2="670" y2="240" stroke="#333" stroke-width="1.5"/>
  
  <!-- Inheritance triangles -->
  <polygon points="400,170 393,182 407,182" fill="white" stroke="#333" stroke-width="1.5"/>
  
  <!-- SlitherAdapter Box -->
  <rect x="20" y="240" width="220" height="130" fill="white" stroke="#27ae60" stroke-width="2" rx="4"/>
  <rect x="20" y="240" width="220" height="25" fill="#27ae60" rx="4"/>
  <rect x="20" y="258" width="220" height="8" fill="#27ae60"/>
  <text x="130" y="260" text-anchor="middle" font-size="13" fill="white" font-weight="bold">SlitherAdapter</text>
  
  <!-- Separator -->
  <line x1="20" y1="290" x2="240" y2="290" stroke="#27ae60" stroke-width="1"/>
  
  <!-- Attributes -->
  <text x="35" y="308" font-size="10" fill="#666">- slither_path: str</text>
  
  <!-- Separator -->
  <line x1="20" y1="318" x2="240" y2="318" stroke="#27ae60" stroke-width="1"/>
  
  <!-- Methods -->
  <text x="35" y="336" font-size="10" fill="#333">+ analyze()</text>
  <text x="35" y="352" font-size="10" fill="#333">+ _parse_json()</text>
  
  <!-- MythrilAdapter Box -->
  <rect x="290" y="240" width="220" height="130" fill="white" stroke="#9b59b6" stroke-width="2" rx="4"/>
  <rect x="290" y="240" width="220" height="25" fill="#9b59b6" rx="4"/>
  <rect x="290" y="258" width="220" height="8" fill="#9b59b6"/>
  <text x="400" y="260" text-anchor="middle" font-size="13" fill="white" font-weight="bold">MythrilAdapter</text>
  
  <!-- Separator -->
  <line x1="290" y1="290" x2="510" y2="290" stroke="#9b59b6" stroke-width="1"/>
  
  <!-- Attributes -->
  <text x="305" y="308" font-size="10" fill="#666">- myth_path: str</text>
  
  <!-- Separator -->
  <line x1="290" y1="318" x2="510" y2="318" stroke="#9b59b6" stroke-width="1"/>
  
  <!-- Methods -->
  <text x="305" y="336" font-size="10" fill="#333">+ analyze()</text>
  <text x="305" y="352" font-size="10" fill="#333">+ _run_myth()</text>
  
  <!-- EchidnaAdapter Box -->
  <rect x="560" y="240" width="220" height="130" fill="white" stroke="#e74c3c" stroke-width="2" rx="4"/>
  <rect x="560" y="240" width="220" height="25" fill="#e74c3c" rx="4"/>
  <rect x="560" y="258" width="220" height="8" fill="#e74c3c"/>
  <text x="670" y="260" text-anchor="middle" font-size="13" fill="white" font-weight="bold">EchidnaAdapter</text>
  
  <!-- Separator -->
  <line x1="560" y1="290" x2="780" y2="290" stroke="#e74c3c" stroke-width="1"/>
  
  <!-- Attributes -->
  <text x="575" y="308" font-size="10" fill="#666">- echidna_path: str</text>
  
  <!-- Separator -->
  <line x1="560" y1="318" x2="780" y2="318" stroke="#e74c3c" stroke-width="1"/>
  
  <!-- Methods -->
  <text x="575" y="336" font-size="10" fill="#333">+ analyze()</text>
  <text x="575" y="352" font-size="10" fill="#333">+ _run_fuzz()</text>
  
  <!-- Arrows to CLI tools -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
  
  <!-- Dashed lines to external tools -->
  <line x1="130" y1="370" x2="130" y2="420" stroke="#333" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
  <line x1="400" y1="370" x2="400" y2="420" stroke="#333" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
  <line x1="670" y1="370" x2="670" y2="420" stroke="#333" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
  
  <!-- External CLI boxes -->
  <rect x="40" y="430" width="180" height="45" fill="#2d3436" rx="6"/>
  <text x="130" y="450" text-anchor="middle" font-size="11" fill="#00b894" font-weight="bold">$ slither</text>
  <text x="130" y="466" text-anchor="middle" font-size="9" fill="#b2bec3">[Slither CLI]</text>
  
  <rect x="310" y="430" width="180" height="45" fill="#2d3436" rx="6"/>
  <text x="400" y="450" text-anchor="middle" font-size="11" fill="#a29bfe" font-weight="bold">$ myth</text>
  <text x="400" y="466" text-anchor="middle" font-size="9" fill="#b2bec3">[Mythril CLI]</text>
  
  <rect x="580" y="430" width="180" height="45" fill="#2d3436" rx="6"/>
  <text x="670" y="450" text-anchor="middle" font-size="11" fill="#ff7675" font-weight="bold">$ echidna</text>
  <text x="670" y="466" text-anchor="middle" font-size="9" fill="#b2bec3">[Echidna Binary]</text>
  
  <!-- Legend -->
  <rect x="20" y="495" width="760" height="45" fill="#ecf0f1" rx="4"/>
  <text x="40" y="515" font-size="10" fill="#2c3e50" font-weight="bold">Patrón Adapter:</text>
  <text x="140" y="515" font-size="10" fill="#555">Cada Adapter implementa ToolProtocol y encapsula la lógica específica de cada herramienta externa.</text>
  <text x="40" y="532" font-size="10" fill="#555">Permite intercambiar herramientas sin modificar el código cliente (principio Open/Closed - SOLID).</text>
</svg>
