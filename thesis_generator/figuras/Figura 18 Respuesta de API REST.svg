<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 820" font-family="Arial, Helvetica, sans-serif">
  <!-- Background -->
  <rect width="850" height="820" fill="#ffffff"/>
  
  <!-- Title -->
  <text x="425" y="28" text-anchor="middle" font-size="18" font-weight="bold" fill="#2c3e50">
    Figura 18: Respuesta de API REST
  </text>
  
  <!-- Terminal window -->
  <rect x="40" y="45" width="770" height="710" fill="#1e1e1e" rx="8"/>
  
  <!-- Terminal header -->
  <rect x="40" y="45" width="770" height="28" fill="#3c3c3c" rx="8"/>
  <rect x="40" y="65" width="770" height="8" fill="#3c3c3c"/>
  <circle cx="60" cy="59" r="6" fill="#ff5f56"/>
  <circle cx="80" cy="59" r="6" fill="#ffbd2e"/>
  <circle cx="100" cy="59" r="6" fill="#27c93f"/>
  <text x="425" y="63" text-anchor="middle" font-size="11" fill="#aaa">Terminal - curl API Response</text>
  
  <!-- Curl command -->
  <text x="55" y="92" font-size="11" font-family="Consolas, monospace" fill="#27ae60">$</text>
  <text x="70" y="92" font-size="10" font-family="Consolas, monospace" fill="#fff">curl -X POST http://localhost:8000/api/v1/analyze \</text>
  <text x="70" y="107" font-size="10" font-family="Consolas, monospace" fill="#aaa">-H "Content-Type: application/json" \</text>
  <text x="70" y="122" font-size="10" font-family="Consolas, monospace" fill="#aaa">-d '{"contract_path": "VulnerableBank.sol", "layers": [1,3,7]}'</text>
  
  <!-- JSON Response -->
  <text x="55" y="150" font-size="11" font-family="Consolas, monospace" fill="#aaa">{</text>
  
  <!-- Status and basic info -->
  <text x="70" y="170" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"status"</text>
  <text x="130" y="170" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="145" y="170" font-size="11" font-family="Consolas, monospace" fill="#27ae60">"completed"</text>
  <text x="230" y="170" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  
  <text x="70" y="190" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"analysis_id"</text>
  <text x="165" y="190" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="180" y="190" font-size="11" font-family="Consolas, monospace" fill="#ce9178">"a7f3c2e1-8b4d-4f5a-9c6e-1d2b3a4c5e6f"</text>
  <text x="500" y="190" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  
  <text x="70" y="210" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"contract"</text>
  <text x="150" y="210" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="165" y="210" font-size="11" font-family="Consolas, monospace" fill="#ce9178">"VulnerableBank.sol"</text>
  <text x="320" y="210" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  
  <text x="70" y="230" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"layers_executed"</text>
  <text x="195" y="230" font-size="11" font-family="Consolas, monospace" fill="#aaa">: [</text>
  <text x="215" y="230" font-size="11" font-family="Consolas, monospace" fill="#b5cea8">1, 3, 7</text>
  <text x="265" y="230" font-size="11" font-family="Consolas, monospace" fill="#aaa">],</text>
  
  <text x="70" y="250" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"execution_time_ms"</text>
  <text x="215" y="250" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="230" y="250" font-size="11" font-family="Consolas, monospace" fill="#b5cea8">34521</text>
  <text x="280" y="250" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  
  <!-- Summary block -->
  <rect x="60" y="262" width="740" height="110" fill="#2d2d2d" rx="4"/>
  <text x="70" y="282" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"summary"</text>
  <text x="140" y="282" font-size="11" font-family="Consolas, monospace" fill="#aaa">: {</text>
  
  <text x="90" y="302" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"total_raw_findings"</text>
  <text x="250" y="302" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="265" y="302" font-size="11" font-family="Consolas, monospace" fill="#b5cea8">23</text>
  <text x="285" y="302" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  <text x="305" y="302" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"total_unique_findings"</text>
  <text x="480" y="302" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="495" y="302" font-size="11" font-family="Consolas, monospace" fill="#27ae60">9</text>
  <text x="510" y="302" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  
  <text x="90" y="322" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"deduplication_rate"</text>
  <text x="250" y="322" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="265" y="322" font-size="11" font-family="Consolas, monospace" fill="#3498db">0.609</text>
  <text x="310" y="322" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  
  <text x="90" y="342" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"by_severity"</text>
  <text x="185" y="342" font-size="11" font-family="Consolas, monospace" fill="#aaa">: {</text>
  <text x="205" y="342" font-size="11" font-family="Consolas, monospace" fill="#e74c3c">"critical": 1</text>
  <text x="305" y="342" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  <text x="320" y="342" font-size="11" font-family="Consolas, monospace" fill="#e67e22">"high": 3</text>
  <text x="395" y="342" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  <text x="410" y="342" font-size="11" font-family="Consolas, monospace" fill="#f1c40f">"medium": 4</text>
  <text x="505" y="342" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  <text x="520" y="342" font-size="11" font-family="Consolas, monospace" fill="#3498db">"low": 1</text>
  <text x="580" y="342" font-size="11" font-family="Consolas, monospace" fill="#aaa">}</text>
  
  <text x="70" y="365" font-size="11" font-family="Consolas, monospace" fill="#aaa">},</text>
  
  <!-- Findings array -->
  <text x="70" y="390" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"findings"</text>
  <text x="145" y="390" font-size="11" font-family="Consolas, monospace" fill="#aaa">: [</text>
  <text x="70" y="410" font-size="11" font-family="Consolas, monospace" fill="#aaa">{</text>
  
  <text x="90" y="430" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"id"</text>
  <text x="115" y="430" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="130" y="430" font-size="11" font-family="Consolas, monospace" fill="#ce9178">"MIESC-2024-VB-001"</text>
  <text x="295" y="430" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  
  <text x="90" y="450" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"type"</text>
  <text x="130" y="450" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="145" y="450" font-size="11" font-family="Consolas, monospace" fill="#ce9178">"reentrancy-eth"</text>
  <text x="275" y="450" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  <text x="295" y="450" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"severity"</text>
  <text x="375" y="450" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="390" y="450" font-size="11" font-family="Consolas, monospace" fill="#e74c3c">"HIGH"</text>
  <text x="435" y="450" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  
  <text x="90" y="470" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"swc_id"</text>
  <text x="150" y="470" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="165" y="470" font-size="11" font-family="Consolas, monospace" fill="#ce9178">"SWC-107"</text>
  <text x="245" y="470" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  <text x="265" y="470" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"location"</text>
  <text x="345" y="470" font-size="11" font-family="Consolas, monospace" fill="#aaa">:</text>
  <text x="360" y="470" font-size="11" font-family="Consolas, monospace" fill="#ce9178">"VulnerableBank.sol:35"</text>
  <text x="535" y="470" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  
  <text x="90" y="490" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"detected_by"</text>
  <text x="185" y="490" font-size="11" font-family="Consolas, monospace" fill="#aaa">: [</text>
  <text x="200" y="490" font-size="11" font-family="Consolas, monospace" fill="#27ae60">"slither"</text>
  <text x="270" y="490" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  <text x="285" y="490" font-size="11" font-family="Consolas, monospace" fill="#9b59b6">"mythril"</text>
  <text x="355" y="490" font-size="11" font-family="Consolas, monospace" fill="#aaa">,</text>
  <text x="370" y="490" font-size="11" font-family="Consolas, monospace" fill="#e74c3c">"gptscan"</text>
  <text x="440" y="490" font-size="11" font-family="Consolas, monospace" fill="#aaa">]</text>
  
  <text x="70" y="510" font-size="11" font-family="Consolas, monospace" fill="#aaa">},</text>
  <text x="90" y="530" font-size="11" font-family="Consolas, monospace" fill="#6a9955">// ... más hallazgos</text>
  <text x="70" y="550" font-size="11" font-family="Consolas, monospace" fill="#aaa">],</text>
  
  <!-- Tools status block -->
  <rect x="60" y="562" width="740" height="125" fill="#2d2d2d" rx="4"/>
  <text x="70" y="582" font-size="11" font-family="Consolas, monospace" fill="#9cdcfe">"tools_status"</text>
  <text x="170" y="582" font-size="11" font-family="Consolas, monospace" fill="#aaa">: {</text>
  
  <text x="90" y="605" font-size="11" font-family="Consolas, monospace" fill="#27ae60">"slither"</text>
  <text x="155" y="605" font-size="11" font-family="Consolas, monospace" fill="#aaa">: {</text>
  <text x="175" y="605" font-size="10" font-family="Consolas, monospace" fill="#aaa">"status":</text>
  <text x="235" y="605" font-size="10" font-family="Consolas, monospace" fill="#27ae60">"success"</text>
  <text x="300" y="605" font-size="10" font-family="Consolas, monospace" fill="#aaa">, "time_ms":</text>
  <text x="380" y="605" font-size="10" font-family="Consolas, monospace" fill="#b5cea8">2341</text>
  <text x="420" y="605" font-size="10" font-family="Consolas, monospace" fill="#aaa">, "findings":</text>
  <text x="505" y="605" font-size="10" font-family="Consolas, monospace" fill="#b5cea8">9</text>
  <text x="520" y="605" font-size="11" font-family="Consolas, monospace" fill="#aaa">},</text>
  
  <text x="90" y="628" font-size="11" font-family="Consolas, monospace" fill="#9b59b6">"mythril"</text>
  <text x="160" y="628" font-size="11" font-family="Consolas, monospace" fill="#aaa">: {</text>
  <text x="180" y="628" font-size="10" font-family="Consolas, monospace" fill="#aaa">"status":</text>
  <text x="240" y="628" font-size="10" font-family="Consolas, monospace" fill="#27ae60">"success"</text>
  <text x="305" y="628" font-size="10" font-family="Consolas, monospace" fill="#aaa">, "time_ms":</text>
  <text x="385" y="628" font-size="10" font-family="Consolas, monospace" fill="#b5cea8">28432</text>
  <text x="435" y="628" font-size="10" font-family="Consolas, monospace" fill="#aaa">, "findings":</text>
  <text x="520" y="628" font-size="10" font-family="Consolas, monospace" fill="#b5cea8">4</text>
  <text x="535" y="628" font-size="11" font-family="Consolas, monospace" fill="#aaa">},</text>
  
  <text x="90" y="651" font-size="11" font-family="Consolas, monospace" fill="#e74c3c">"gptscan"</text>
  <text x="165" y="651" font-size="11" font-family="Consolas, monospace" fill="#aaa">: {</text>
  <text x="185" y="651" font-size="10" font-family="Consolas, monospace" fill="#aaa">"status":</text>
  <text x="245" y="651" font-size="10" font-family="Consolas, monospace" fill="#27ae60">"success"</text>
  <text x="310" y="651" font-size="10" font-family="Consolas, monospace" fill="#aaa">, "time_ms":</text>
  <text x="390" y="651" font-size="10" font-family="Consolas, monospace" fill="#b5cea8">3748</text>
  <text x="435" y="651" font-size="10" font-family="Consolas, monospace" fill="#aaa">, "findings":</text>
  <text x="520" y="651" font-size="10" font-family="Consolas, monospace" fill="#b5cea8">3</text>
  <text x="535" y="651" font-size="11" font-family="Consolas, monospace" fill="#aaa">}</text>
  
  <text x="70" y="680" font-size="11" font-family="Consolas, monospace" fill="#aaa">}</text>
  <text x="55" y="700" font-size="11" font-family="Consolas, monospace" fill="#aaa">}</text>
  
  <!-- Annotations -->
  <rect x="620" y="262" width="170" height="20" fill="#3498db" rx="3"/>
  <text x="705" y="276" text-anchor="middle" font-size="9" fill="#fff">Resumen de auditoría</text>
  
  <rect x="620" y="562" width="170" height="20" fill="#27ae60" rx="3"/>
  <text x="705" y="576" text-anchor="middle" font-size="9" fill="#fff">Estado por herramienta</text>
  
  <!-- Observation box -->
  <rect x="40" y="765" width="770" height="45" fill="#e8f8f5" rx="5" stroke="#1abc9c" stroke-width="1"/>
  <text x="55" y="785" font-size="11" fill="#0e6655" font-weight="bold">Observación:</text>
  <text x="140" y="785" font-size="11" fill="#0e6655">La API REST proporciona: tiempo de ejecución por herramienta, estado de cada tool,</text>
  <text x="55" y="802" font-size="11" fill="#0e6655">y hallazgos normalizados. El formato JSON facilita la integración con sistemas CI/CD.</text>
</svg>
