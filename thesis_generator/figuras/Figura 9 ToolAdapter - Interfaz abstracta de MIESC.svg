<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900" font-family="Arial, Helvetica, sans-serif">
  <!-- Background -->
  <rect width="1200" height="900" fill="#ffffff"/>
  
  <!-- Title -->
  <text x="600" y="40" text-anchor="middle" font-size="28" font-weight="bold" fill="#2c3e50">
    ToolAdapter - Interfaz Abstracta MIESC
  </text>
  
  <!-- Main Class Box -->
  <rect x="100" y="70" width="1000" height="720" fill="white" stroke="#3498db" stroke-width="3" rx="8"/>
  
  <!-- Header -->
  <rect x="100" y="70" width="1000" height="70" fill="#3498db" rx="8"/>
  <rect x="100" y="125" width="1000" height="15" fill="#3498db"/>
  <text x="600" y="100" text-anchor="middle" font-size="18" fill="white" font-style="italic">«abstract»</text>
  <text x="600" y="128" text-anchor="middle" font-size="24" font-weight="bold" fill="white">ToolAdapter</text>
  
  <!-- Class docstring -->
  <rect x="120" y="155" width="960" height="95" fill="#f8f9fa" rx="4" stroke="#e0e0e0" stroke-width="1"/>
  <text x="140" y="180" font-size="14" fill="#555" font-style="italic">Interfaz abstracta para adaptadores de herramientas de seguridad.</text>
  <text x="140" y="200" font-size="14" fill="#555" font-style="italic">Diseño basado en patrón Adapter (Gamma et al., 1994) y principios SOLID (Martin, 2017).</text>
  <text x="140" y="220" font-size="14" fill="#555" font-style="italic">Permite que el orquestador trabaje con cualquier herramienta sin conocer sus detalles,</text>
  <text x="140" y="240" font-size="14" fill="#555" font-style="italic">cumpliendo el Principio de Inversión de Dependencias (DIP).</text>
  
  <!-- Separator -->
  <line x1="100" y1="265" x2="1100" y2="265" stroke="#3498db" stroke-width="2"/>
  
  <!-- Method 1: get_metadata -->
  <rect x="120" y="280" width="960" height="100" fill="#eaf2f8" rx="4"/>
  <text x="140" y="308" font-size="18" font-weight="bold" fill="#2980b9">+ get_metadata() → ToolMetadata</text>
  <text x="160" y="335" font-size="14" fill="#444">Retorna metadatos estandarizados de la herramienta.</text>
  <text x="160" y="355" font-size="14" fill="#666">Incluye información sobre licencia, costo y requisitos de instalación.</text>
  <text x="160" y="375" font-size="14" fill="#666" font-style="italic">Cumple estándares DPGA (2023) de transparencia.</text>
  
  <!-- Method 2: is_available -->
  <rect x="120" y="395" width="960" height="100" fill="#e8f6f3" rx="4"/>
  <text x="140" y="423" font-size="18" font-weight="bold" fill="#1e8449">+ is_available() → ToolStatus</text>
  <text x="160" y="450" font-size="14" fill="#444">Verifica la disponibilidad de la herramienta en el sistema.</text>
  <text x="160" y="470" font-size="14" fill="#666">Permite degradación elegante: si una herramienta no está instalada,</text>
  <text x="160" y="490" font-size="14" fill="#666" font-style="italic">MIESC continúa con las demás en lugar de fallar completamente.</text>
  
  <!-- Method 3: analyze -->
  <rect x="120" y="510" width="960" height="130" fill="#fef9e7" rx="4"/>
  <text x="140" y="538" font-size="18" font-weight="bold" fill="#b7950b">+ analyze(contract_path: str, **kwargs) → Dict[str, Any]</text>
  <text x="160" y="565" font-size="14" fill="#444">Ejecuta el análisis de seguridad sobre un contrato.</text>
  <text x="160" y="590" font-size="14" fill="#666">
    <tspan font-weight="bold">Args:</tspan> contract_path (ruta absoluta .sol), **kwargs (timeout, max_depth, etc.)
  </text>
  <text x="160" y="615" font-size="14" fill="#666">
    <tspan font-weight="bold">Returns:</tspan> Diccionario con estructura normalizada MIESC (status, findings, metadata)
  </text>
  
  <!-- Method 4: normalize_findings -->
  <rect x="120" y="655" width="960" height="120" fill="#fdedec" rx="4"/>
  <text x="140" y="683" font-size="18" font-weight="bold" fill="#922b21">+ normalize_findings(raw_output: Any) → List[Dict[str, Any]]</text>
  <text x="160" y="710" font-size="14" fill="#444">Normaliza hallazgos al formato MIESC estándar.</text>
  <text x="160" y="735" font-size="14" fill="#666">Implementa mapeo de clasificaciones nativas a taxonomías estándar (SWC, CWE, OWASP).</text>
  <text x="160" y="760" font-size="14" fill="#666" font-style="italic">La normalización es esencial para la deduplicación posterior.</text>
  
  <!-- Footer: Design Patterns & Principles -->
  <rect x="100" y="810" width="1000" height="70" fill="#2c3e50" rx="8"/>
  <rect x="100" y="810" width="1000" height="15" fill="#2c3e50"/>
  <text x="600" y="845" text-anchor="middle" font-size="16" fill="white" font-weight="bold">Patrones y Principios Aplicados</text>
  <text x="600" y="868" text-anchor="middle" font-size="14" fill="#bdc3c7">
    Adapter Pattern │ SOLID (DIP, OCP) │ Graceful Degradation │ Taxonomía Estándar (SWC/CWE)
  </text>
</svg>
